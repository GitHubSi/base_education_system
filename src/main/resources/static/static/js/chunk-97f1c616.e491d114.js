(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-97f1c616"],{"09bf":function(t,n,e){"use strict";e.d(n,"a",(function(){return r}));var o=e("b775");function r(t){return Object(o["a"])({url:"/declaration-form/teaching-research/"+t,method:"get"})}},"1d7f":function(t,n,e){"use strict";e.d(n,"a",(function(){return r}));var o=e("b775");function r(t){return Object(o["a"])({url:"/declaration-form/principal/"+t,method:"get"})}},"22da":function(t,n){tinymce.addI18n("zh_CN",{Redo:"重做",Undo:"撤销",Cut:"剪切",Copy:"复制",Paste:"粘贴","Select all":"全选","New document":"新文件",Ok:"确定",Cancel:"取消","Visual aids":"网格线",Bold:"粗体",Italic:"斜体",Underline:"下划线",Strikethrough:"删除线",Superscript:"上标",Subscript:"下标","Clear formatting":"清除格式","Align left":"左边对齐","Align center":"中间对齐","Align right":"右边对齐",Justify:"两端对齐","Bullet list":"项目符号","Numbered list":"编号列表","Decrease indent":"减少缩进","Increase indent":"增加缩进",Close:"关闭",Formats:"格式","Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead.":"你的浏览器不支持打开剪贴板，请使用Ctrl+X/C/V等快捷键。",Headers:"标题","Header 1":"标题1","Header 2":"标题2","Header 3":"标题3","Header 4":"标题4","Header 5":"标题5","Header 6":"标题6",Headings:"标题","Heading 1":"标题1","Heading 2":"标题2","Heading 3":"标题3","Heading 4":"标题4","Heading 5":"标题5","Heading 6":"标题6",Preformatted:"预先格式化的",Div:"Div",Pre:"Pre",Code:"代码",Paragraph:"段落",Blockquote:"引文区块",Inline:"文本",Blocks:"基块","Paste is now in plain text mode. Contents will now be pasted as plain text until you toggle this option off.":"当前为纯文本粘贴模式，再次点击可以回到普通粘贴模式。",Fonts:"字体","Font Sizes":"字号",Class:"类型","Browse for an image":"浏览图像",OR:"或","Drop an image here":"拖放一张图像至此",Upload:"上传",Block:"块",Align:"对齐",Default:"默认",Circle:"空心圆",Disc:"实心圆",Square:"方块","Lower Alpha":"小写英文字母","Lower Greek":"小写希腊字母","Lower Roman":"小写罗马字母","Upper Alpha":"大写英文字母","Upper Roman":"大写罗马字母","Anchor...":"锚点...",Name:"名称",Id:"标识符","Id should start with a letter, followed only by letters, numbers, dashes, dots, colons or underscores.":"标识符应该以字母开头，后跟字母、数字、破折号、点、冒号或下划线。","You have unsaved changes are you sure you want to navigate away?":"你还有文档尚未保存，确定要离开？","Restore last draft":"恢复上次的草稿","Special character...":"特殊字符...","Source code":"源代码","Insert/Edit code sample":"插入/编辑代码示例",Language:"语言","Code sample...":"示例代码...","Color Picker":"选色器",R:"R",G:"G",B:"B","Left to right":"从左到右","Right to left":"从右到左","Emoticons...":"表情符号...","Metadata and Document Properties":"元数据和文档属性",Title:"标题",Keywords:"关键词",Description:"描述",Robots:"机器人",Author:"作者",Encoding:"编码",Fullscreen:"全屏",Action:"操作",Shortcut:"快捷键",Help:"帮助",Address:"地址","Focus to menubar":"移动焦点到菜单栏","Focus to toolbar":"移动焦点到工具栏","Focus to element path":"移动焦点到元素路径","Focus to contextual toolbar":"移动焦点到上下文菜单","Insert link (if link plugin activated)":"插入链接 (如果链接插件已激活)","Save (if save plugin activated)":"保存(如果保存插件已激活)","Find (if searchreplace plugin activated)":"查找(如果查找替换插件已激活)","Plugins installed ({0}):":"已安装插件 ({0}):","Premium plugins:":"优秀插件：","Learn more...":"了解更多...","You are using {0}":"你正在使用 {0}",Plugins:"插件","Handy Shortcuts":"快捷键","Horizontal line":"水平分割线","Insert/edit image":"插入/编辑图片","Image description":"图片描述",Source:"地址",Dimensions:"大小","Constrain proportions":"保持纵横比",General:"普通",Advanced:"高级",Style:"样式","Vertical space":"垂直边距","Horizontal space":"水平边距",Border:"边框","Insert image":"插入图片","Image...":"图片...","Image list":"图片列表","Rotate counterclockwise":"逆时针旋转","Rotate clockwise":"顺时针旋转","Flip vertically":"垂直翻转","Flip horizontally":"水平翻转","Edit image":"编辑图片","Image options":"图片选项","Zoom in":"放大","Zoom out":"缩小",Crop:"裁剪",Resize:"调整大小",Orientation:"方向",Brightness:"亮度",Sharpen:"锐化",Contrast:"对比度","Color levels":"颜色层次",Gamma:"伽马值",Invert:"反转",Apply:"应用",Back:"后退","Insert date/time":"插入日期/时间","Date/time":"日期/时间","Insert/Edit Link":"插入/编辑链接","Insert/edit link":"插入/编辑链接","Text to display":"显示文字",Url:"地址","Open link in...":"链接打开位置...","Current window":"当前窗口",None:"无","New window":"在新窗口打开","Remove link":"删除链接",Anchors:"锚点","Link...":"链接...","Paste or type a link":"粘贴或输入链接","The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?":"你所填写的URL地址为邮件地址，需要加上mailto:前缀吗？","The URL you entered seems to be an external link. Do you want to add the required http:// prefix?":"你所填写的URL地址属于外部链接，需要加上http://:前缀吗？","Link list":"链接列表","Insert video":"插入视频","Insert/edit video":"插入/编辑视频","Insert/edit media":"插入/编辑媒体","Alternative source":"镜像","Alternative source URL":"替代来源网址","Media poster (Image URL)":"封面(图片地址)","Paste your embed code below:":"将内嵌代码粘贴在下面:",Embed:"内嵌","Media...":"多媒体...","Nonbreaking space":"不间断空格","Page break":"分页符","Paste as text":"粘贴为文本",Preview:"预览","Print...":"打印...",Save:"保存",Find:"查找","Replace with":"替换为",Replace:"替换","Replace all":"全部替换",Previous:"上一个",Next:"下一个","Find and replace...":"查找并替换...","Could not find the specified string.":"未找到搜索内容.","Match case":"区分大小写","Find whole words only":"全字匹配","Spell check":"拼写检查",Ignore:"忽略","Ignore all":"全部忽略",Finish:"完成","Add to Dictionary":"添加到字典","Insert table":"插入表格","Table properties":"表格属性","Delete table":"删除表格",Cell:"单元格",Row:"行",Column:"列","Cell properties":"单元格属性","Merge cells":"合并单元格","Split cell":"拆分单元格","Insert row before":"在上方插入","Insert row after":"在下方插入","Delete row":"删除行","Row properties":"行属性","Cut row":"剪切行","Copy row":"复制行","Paste row before":"粘贴到上方","Paste row after":"粘贴到下方","Insert column before":"在左侧插入","Insert column after":"在右侧插入","Delete column":"删除列",Cols:"列",Rows:"行",Width:"宽",Height:"高","Cell spacing":"单元格外间距","Cell padding":"单元格内边距","Show caption":"显示标题",Left:"左对齐",Center:"居中",Right:"右对齐","Cell type":"单元格类型",Scope:"范围",Alignment:"对齐方式","H Align":"水平对齐","V Align":"垂直对齐",Top:"顶部对齐",Middle:"垂直居中",Bottom:"底部对齐","Header cell":"表头单元格","Row group":"行组","Column group":"列组","Row type":"行类型",Header:"表头",Body:"表体",Footer:"表尾","Border color":"边框颜色","Insert template...":"插入模板...",Templates:"模板",Template:"模板","Text color":"文字颜色","Background color":"背景色","Custom...":"自定义...","Custom color":"自定义颜色","No color":"无","Remove color":"移除颜色","Table of Contents":"内容列表","Show blocks":"显示区块边框","Show invisible characters":"显示不可见字符","Word count":"字数",Count:"计数",Document:"文档",Selection:"选择",Words:"单词","Words: {0}":"字数：{0}","{0} words":"{0} 字",File:"文件",Edit:"编辑",Insert:"插入",View:"视图",Format:"格式",Table:"表格",Tools:"工具","Powered by {0}":"由{0}驱动","Rich Text Area. Press ALT-F9 for menu. Press ALT-F10 for toolbar. Press ALT-0 for help":"在编辑区按ALT-F9打开菜单，按ALT-F10打开工具栏，按ALT-0查看帮助","Image title":"图片标题","Border width":"边框宽度","Border style":"边框样式",Error:"错误",Warn:"警告",Valid:"有效","To open the popup, press Shift+Enter":"按Shitf+Enter键打开对话框","Rich Text Area. Press ALT-0 for help.":"编辑区。按Alt+0键打开帮助。","System Font":"系统字体","Failed to upload image: {0}":"图片上传失败: {0}","Failed to load plugin: {0} from url {1}":"插件加载失败: {0} 来自链接 {1}","Failed to load plugin url: {0}":"插件加载失败 链接: {0}","Failed to initialize plugin: {0}":"插件初始化失败: {0}",example:"示例",Search:"搜索",All:"全部",Currency:"货币",Text:"文字",Quotations:"引用",Mathematical:"数学","Extended Latin":"拉丁语扩充",Symbols:"符号",Arrows:"箭头","User Defined":"自定义","dollar sign":"美元符号","currency sign":"货币符号","euro-currency sign":"欧元符号","colon sign":"冒号","cruzeiro sign":"克鲁赛罗币符号","french franc sign":"法郎符号","lira sign":"里拉符号","mill sign":"密尔符号","naira sign":"奈拉符号","peseta sign":"比塞塔符号","rupee sign":"卢比符号","won sign":"韩元符号","new sheqel sign":"新谢克尔符号","dong sign":"越南盾符号","kip sign":"老挝基普符号","tugrik sign":"图格里克符号","drachma sign":"德拉克马符号","german penny symbol":"德国便士符号","peso sign":"比索符号","guarani sign":"瓜拉尼符号","austral sign":"澳元符号","hryvnia sign":"格里夫尼亚符号","cedi sign":"塞地符号","livre tournois sign":"里弗弗尔符号","spesmilo sign":"spesmilo符号","tenge sign":"坚戈符号","indian rupee sign":"印度卢比","turkish lira sign":"土耳其里拉","nordic mark sign":"北欧马克","manat sign":"马纳特符号","ruble sign":"卢布符号","yen character":"日元字样","yuan character":"人民币元字样","yuan character, in hong kong and taiwan":"元字样（港台地区）","yen/yuan character variant one":"元字样（大写）","Loading emoticons...":"加载表情符号...","Could not load emoticons":"不能加载表情符号",People:"人类","Animals and Nature":"动物和自然","Food and Drink":"食物和饮品",Activity:"活动","Travel and Places":"旅游和地点",Objects:"物件",Flags:"旗帜",Characters:"字符","Characters (no spaces)":"字符(无空格)","{0} characters":"{0} 个字符","Error: Form submit field collision.":"错误: 表单提交字段冲突。","Error: No form element found.":"错误: 没有表单控件。",Update:"更新","Color swatch":"颜色样本",Turquoise:"青绿色",Green:"绿色",Blue:"蓝色",Purple:"紫色","Navy Blue":"海军蓝","Dark Turquoise":"深蓝绿色","Dark Green":"深绿色","Medium Blue":"中蓝色","Medium Purple":"中紫色","Midnight Blue":"深蓝色",Yellow:"黄色",Orange:"橙色",Red:"红色","Light Gray":"浅灰色",Gray:"灰色","Dark Yellow":"暗黄色","Dark Orange":"深橙色","Dark Red":"深红色","Medium Gray":"中灰色","Dark Gray":"深灰色","Light Green":"浅绿色","Light Yellow":"浅黄色","Light Red":"浅红色","Light Purple":"浅紫色","Light Blue":"浅蓝色","Dark Purple":"深紫色","Dark Blue":"深蓝色",Black:"黑色",White:"白色","Switch to or from fullscreen mode":"切换全屏模式","Open help dialog":"打开帮助对话框",history:"历史",styles:"样式",formatting:"格式化",alignment:"对齐",indentation:"缩进","permanent pen":"记号笔",comments:"备注","Format Painter":"格式刷","Insert/edit iframe":"插入/编辑框架",Capitalization:"大写",lowercase:"小写",UPPERCASE:"大写","Title Case":"首字母大写","Permanent Pen Properties":"永久笔属性","Permanent pen properties...":"永久笔属性...",Font:"字体",Size:"字号","More...":"更多...","Spellcheck Language":"拼写检查语言","Select...":"选择...",Preferences:"首选项",Yes:"是",No:"否","Keyboard Navigation":"键盘指引",Version:"版本",Anchor:"锚点","Special character":"特殊符号","Code sample":"代码示例",Color:"颜色",Emoticons:"表情","Document properties":"文档属性",Image:"图片","Insert link":"插入链接",Target:"打开方式",Link:"链接",Poster:"封面",Media:"媒体",Print:"打印",Prev:"上一个","Find and replace":"查找和替换","Whole words":"全字匹配",Spellcheck:"拼写检查",Caption:"标题","Insert template":"插入模板"})},2411:function(t,n,e){"use strict";e.d(n,"a",(function(){return r}));var o=e("b775");function r(t){return Object(o["a"])({url:"/declaration-form/practical-teaching/"+t,method:"get"})}},"34e7":function(t,n,e){"use strict";e.d(n,"a",(function(){return r}));var o=e("b775");function r(t){return Object(o["a"])({url:"/declaration-form/team-building/"+t,method:"get"})}},"3ec1":function(t,n,e){"use strict";e.d(n,"a",(function(){return r}));var o=e("b775");function r(t){return Object(o["a"])({url:"/declaration-form/talent-cultivation-ability/"+t,method:"get"})}},"537c":function(t,n,e){"use strict";e.d(n,"a",(function(){return r}));var o=e("b775");function r(t){return Object(o["a"])({url:"declaration-form/future-construction-plan/"+t,method:"get"})}},"58bd":function(t,n,e){"use strict";e.d(n,"a",(function(){return r}));var o=e("b775");function r(t){return Object(o["a"])({url:"/declaration-form/teachers/"+t,method:"get"})}},"6b84":function(t,n,e){"use strict";e.d(n,"a",(function(){return r}));var o=e("b775");function r(t){return Object(o["a"])({url:"/declaration-form/specialty-construction/"+t,method:"get"})}},"7c27":function(t,n,e){(function(t){e("a4d3"),e("e01a"),e("99af"),e("a623"),e("4de4"),e("7db0"),e("a630"),e("c975"),e("a15b"),e("baa5"),e("d81d"),e("fb6a"),e("45fc"),e("a434"),e("ace4"),e("b0c0"),e("4ec9"),e("a9e3"),e("b680"),e("dca8"),e("b64b"),e("d3b7"),e("4d63"),e("ac1f"),e("25f0"),e("3ca3"),e("466d"),e("5319"),e("841c"),e("1276"),e("498a"),e("18a5"),e("c7cd"),e("9911"),e("5cc6"),e("9a8c"),e("a975"),e("735e"),e("c1ac"),e("d139"),e("3a7b"),e("d5d6"),e("82f8"),e("e91f"),e("60bd"),e("5f96"),e("3280"),e("3fcc"),e("ca91"),e("25a1"),e("cd26"),e("3c5d"),e("2954"),e("649e"),e("219c"),e("170b"),e("b39a"),e("72f7"),e("ddb0"),e("2b3d");var n=e("7037");!function(){"use strict";var e=function(){},o=function(t,n){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return t(n.apply(null,e))}},r=function(t){return function(){return t}},i=function(t){return t};function u(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var r=n.concat(e);return t.apply(null,r)}}var a=function(t){return function(n){return!t(n)}},c=function(t){return function(){throw new Error(t)}},s=r(!1),l=r(!0),f=tinymce.util.Tools.resolve("tinymce.ThemeManager"),d=function(){return(d=Object.assign||function(t){for(var n,e=1,o=arguments.length;e<o;e++)for(var r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)};function m(t,n){var e={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&n.indexOf(o)<0&&(e[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(t);r<o.length;r++)n.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(e[o[r]]=t[o[r]])}return e}function g(){for(var t=0,n=0,e=arguments.length;n<e;n++)t+=arguments[n].length;var o=Array(t),r=0;for(n=0;n<e;n++)for(var i=arguments[n],u=0,a=i.length;u<a;u++,r++)o[r]=i[u];return o}var p,h,v,b,y,x,w=function(){return S},S=(p=function(t){return t.isNone()},{fold:function(t,n){return t()},is:s,isSome:s,isNone:l,getOr:v=function(t){return t},getOrThunk:h=function(t){return t()},getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:r(null),getOrUndefined:r(void 0),or:v,orThunk:h,map:w,each:e,bind:w,exists:s,forall:l,filter:w,equals:p,equals_:p,toArray:function(){return[]},toString:r("none()")}),k=function t(n){var e=r(n),o=function(){return u},i=function(t){return t(n)},u={fold:function(t,e){return e(n)},is:function(t){return n===t},isSome:l,isNone:s,getOr:e,getOrThunk:e,getOrDie:e,getOrNull:e,getOrUndefined:e,or:o,orThunk:o,map:function(e){return t(e(n))},each:function(t){t(n)},bind:i,exists:i,forall:i,filter:function(t){return t(n)?u:S},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(t){return t.is(n)},equals_:function(t,e){return t.fold(s,(function(t){return e(n,t)}))}};return u},C={some:k,none:w,from:function(t){return null===t||void 0===t?S:k(t)}},O=function(t){return function(e){return r=n(o=e),(null===o?"null":"object"==r&&(Array.prototype.isPrototypeOf(o)||o.constructor&&"Array"===o.constructor.name)?"array":"object"==r&&(String.prototype.isPrototypeOf(o)||o.constructor&&"String"===o.constructor.name)?"string":r)===t;var o,r}},_=function(t){return function(e){return n(e)===t}},T=O("string"),E=O("object"),D=O("array"),B=_("boolean"),A=(b=void 0,function(t){return b===t}),M=function(t){return!(null===(n=t)||void 0===n);var n},F=_("function"),I=_("number"),R=function(t,n){if(D(t)){for(var e=0,o=t.length;e<o;++e)if(!n(t[e]))return!1;return!0}return!1},P=Array.prototype.slice,V=Array.prototype.indexOf,H=Array.prototype.push,L=function(t,n){return V.call(t,n)},z=function(t,n){return-1<L(t,n)},N=function(t,n){for(var e=0,o=t.length;e<o;e++)if(n(t[e],e))return!0;return!1},j=function(t,n){for(var e=[],o=0;o<t;o++)e.push(n(o));return e},U=function(t,n){for(var e=[],o=0;o<t.length;o+=n){var r=P.call(t,o,o+n);e.push(r)}return e},W=function(t,n){for(var e=t.length,o=new Array(e),r=0;r<e;r++){var i=t[r];o[r]=n(i,r)}return o},G=function(t,n){for(var e=0,o=t.length;e<o;e++)n(t[e],e)},X=function(t,n){for(var e=[],o=[],r=0,i=t.length;r<i;r++){var u=t[r];(n(u,r)?e:o).push(u)}return{pass:e,fail:o}},Y=function(t,n){for(var e=[],o=0,r=t.length;o<r;o++){var i=t[o];n(i,o)&&e.push(i)}return e},q=function(t,n,e){return function(t,n){for(var e=t.length-1;0<=e;e--)n(t[e],e)}(t,(function(t){e=n(e,t)})),e},K=function(t,n,e){return G(t,(function(t){e=n(e,t)})),e},J=function(t,n){return function(t,n,e){for(var o=0,r=t.length;o<r;o++){var i=t[o];if(n(i,o))return C.some(i);if(e(i,o))break}return C.none()}(t,n,s)},$=function(t,n){for(var e=0,o=t.length;e<o;e++)if(n(t[e],e))return C.some(e);return C.none()},Q=function(t){for(var n=[],e=0,o=t.length;e<o;++e){if(!D(t[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+t);H.apply(n,t[e])}return n},Z=function(t,n){return Q(W(t,n))},tt=function(t,n){for(var e=0,o=t.length;e<o;++e)if(!0!==n(t[e],e))return!1;return!0},nt=function(t){var n=P.call(t,0);return n.reverse(),n},et=function(t,n){return Y(t,(function(t){return!z(n,t)}))},ot=function(t,n){var e=P.call(t,0);return e.sort(n),e},rt=function(t,n){return 0<=n&&n<t.length?C.some(t[n]):C.none()},it=function(t){return rt(t,0)},ut=function(t){return rt(t,t.length-1)},at=F(Array.from)?Array.from:function(t){return P.call(t)},ct=function(t,n){for(var e=0;e<t.length;e++){var o=n(t[e],e);if(o.isSome())return o}return C.none()},st=function t(n){return{is:function(t){return n===t},isValue:l,isError:s,getOr:r(n),getOrThunk:r(n),getOrDie:r(n),or:function(e){return t(n)},orThunk:function(e){return t(n)},fold:function(t,e){return e(n)},map:function(e){return t(e(n))},mapError:function(e){return t(n)},each:function(t){t(n)},bind:function(t){return t(n)},exists:function(t){return t(n)},forall:function(t){return t(n)},toOptional:function(){return C.some(n)}}},lt=function t(n){return{is:s,isValue:s,isError:l,getOr:i,getOrThunk:function(t){return t()},getOrDie:function(){return c(String(n))()},or:function(t){return t},orThunk:function(t){return t()},fold:function(t,e){return t(n)},map:function(e){return t(n)},mapError:function(e){return t(e(n))},each:e,bind:function(e){return t(n)},exists:s,forall:l,toOptional:C.none}},ft={value:st,error:lt,fromOption:function(t,n){return t.fold((function(){return lt(n)}),st)}};(x=y=y||{})[x.Error=0]="Error",x[x.Value=1]="Value";var dt,mt,gt=function(t,n,e){return t.stype===y.Error?n(t.serror):e(t.svalue)},pt=function(t){return{stype:y.Value,svalue:t}},ht=function(t){return{stype:y.Error,serror:t}},vt=function(t){return t.fold(ht,pt)},bt=function(t){return gt(t,ft.error,ft.value)},yt=pt,xt=function(t){var n=[],e=[];return G(t,(function(t){gt(t,(function(t){return e.push(t)}),(function(t){return n.push(t)}))})),{values:n,errors:e}},wt=ht,St=function(t,n){return t.stype===y.Value?n(t.svalue):t},kt=function(t,n){return t.stype===y.Error?n(t.serror):t},Ct=function(t,n){return t.stype===y.Value?{stype:y.Value,svalue:n(t.svalue)}:t},Ot=function(t,n){return t.stype===y.Error?{stype:y.Error,serror:n(t.serror)}:t},_t=Object.keys,Tt=Object.hasOwnProperty,Et=function(t,n){for(var e=_t(t),o=0,r=e.length;o<r;o++){var i=e[o];n(t[i],i)}},Dt=function(t,n){return Bt(t,(function(t,e){return{k:e,v:n(t,e)}}))},Bt=function(t,n){var e={};return Et(t,(function(t,o){var r=n(t,o);e[r.k]=r.v})),e},At=function(t,n){var o,r,i,u,a={};return o=n,u=a,r=function(t,n){u[n]=t},i=e,Et(t,(function(t,n){(o(t,n)?r:i)(t,n)})),a},Mt=function(t,n){var e=[];return Et(t,(function(t,o){e.push(n(t,o))})),e},Ft=function(t,n){for(var e=_t(t),o=0,r=e.length;o<r;o++){var i=e[o],u=t[i];if(n(u,i,t))return C.some(u)}return C.none()},It=function(t){return Mt(t,(function(t){return t}))},Rt=function(t,n){return Pt(t,n)?C.from(t[n]):C.none()},Pt=function(t,n){return Tt.call(t,n)},Vt=function(t,n){return Pt(t,n)&&void 0!==t[n]&&null!==t[n]},Ht=function(t){if(!D(t))throw new Error("cases must be an array");if(0===t.length)throw new Error("there must be at least one case");var n=[],e={};return G(t,(function(o,r){var i=_t(o);if(1!==i.length)throw new Error("one and only one name per case");var u=i[0],a=o[u];if(void 0!==e[u])throw new Error("duplicate key detected:"+u);if("cata"===u)throw new Error("cannot have a case named cata (sorry)");if(!D(a))throw new Error("case arguments must be an array");n.push(u),e[u]=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var i=e.length;if(i!==a.length)throw new Error("Wrong number of arguments to case "+u+". Expected "+a.length+" ("+a+"), got "+i);return{fold:function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];if(n.length!==t.length)throw new Error("Wrong number of arguments to fold. Expected "+t.length+", got "+n.length);return n[r].apply(null,e)},match:function(t){var o=_t(t);if(n.length!==o.length)throw new Error("Wrong number of arguments to match. Expected: "+n.join(",")+"\nActual: "+o.join(","));if(!tt(n,(function(t){return z(o,t)})))throw new Error("Not all branches were specified when using match. Specified: "+o.join(", ")+"\nRequired: "+n.join(", "));return t[u].apply(null,e)},log:function(t){console.log(t,{constructors:n,constructor:u,params:e})}}}})),e},Lt=Object.prototype.hasOwnProperty,zt=function(t){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];if(0===n.length)throw new Error("Can't merge zero objects");for(var o={},r=0;r<n.length;r++){var i=n[r];for(var u in i)Lt.call(i,u)&&(o[u]=t(o[u],i[u]))}return o}},Nt=zt((function(t,n){return E(t)&&E(n)?Nt(t,n):n})),jt=zt((function(t,n){return n})),Ut=function(t){var n,e=!1;return function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];return e||(e=!0,n=t.apply(null,o)),n}},Wt=Ht([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),Gt=function(t){return Wt.defaultedThunk(r(t))},Xt=Wt.strict,Yt=Wt.asOption,qt=Wt.defaultedThunk,Kt=(Wt.asDefaultedOptionThunk,Wt.mergeWithThunk),Jt=(Ht([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(t,n){var e={};return e[t]=n,e}),$t=function(t,n){return e=n,o={},Et(t,(function(t,n){z(e,n)||(o[n]=t)})),o;var e,o},Qt=Jt,Zt=function(t){return n={},G(t,(function(t){n[t.key]=t.value})),n;var n},tn=function(t,n){var e,o,r,i,u,a=(e=[],o=[],G(t,(function(t){t.fold((function(t){e.push(t)}),(function(t){o.push(t)}))})),{errors:e,values:o});return 0<a.errors.length?(u=a.errors,ft.error(Q(u))):(i=n,0===(r=a.values).length?ft.value(i):ft.value(Nt(i,jt.apply(void 0,r))))},nn=function(t){return o(wt,Q)(t)},en=function(t,n){var e,o,r=xt(t);return 0<r.errors.length?nn(r.errors):(e=r.values,o=n,0<e.length?yt(Nt(o,jt.apply(void 0,e))):yt(o))},on=function(t){var n=xt(t);return 0<n.errors.length?nn(n.errors):yt(n.values)},rn=function(t){return E(t)&&100<_t(t).length?" removed due to size":JSON.stringify(t,null,2)},un=function(t,n){return wt([{path:t,getErrorInfo:n}])},an=Ht([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),cn=function(t,n,e){return Rt(n,e).fold((function(){return o=e,r=n,un(t,(function(){return'Could not find valid *strict* value for "'+o+'" in '+rn(r)}));var o,r}),yt)},sn=function(t,n,e){var o=Rt(t,n).fold((function(){return e(t)}),i);return yt(o)},ln=function(t,n,e,o){return e.fold((function(e,i,u,a){var c=function(n){var r=a.extract(t.concat([e]),o,n);return Ct(r,(function(t){return Jt(i,o(t))}))},s=function(n){return n.fold((function(){var t=Jt(i,o(C.none()));return yt(t)}),(function(n){var r=a.extract(t.concat([e]),o,n);return Ct(r,(function(t){return Jt(i,o(C.some(t)))}))}))};return u.fold((function(){return St(cn(t,n,e),c)}),(function(t){return St(sn(n,e,t),c)}),(function(){return St(yt(Rt(n,e)),s)}),(function(t){return St((r=t,i=Rt(o=n,e).map((function(t){return!0===t?r(o):t})),yt(i)),s);var o,r,i}),(function(t){var o=t(n),i=Ct(sn(n,e,r({})),(function(t){return Nt(o,t)}));return St(i,c)}))}),(function(t,e){var r=e(n);return yt(Jt(t,o(r)))}))},fn=function(t){return{extract:function(n,e,o){return kt(t(o,e),(function(t){return e=t,un(n,(function(){return e}));var e}))},toString:function(){return"val"}}},dn=function(t){var n=mn(t),e=q(t,(function(t,n){return n.fold((function(n){return Nt(t,Qt(n,!0))}),r(t))}),{});return{extract:function(t,o,r){var i,u=B(r)?[]:_t(At(r,(function(t){return void 0!==t&&null!==t}))),a=Y(u,(function(t){return!Vt(e,t)}));return 0===a.length?n.extract(t,o,r):(i=a,un(t,(function(){return"There are unsupported fields: ["+i.join(", ")+"] specified"})))},toString:n.toString}},mn=function(t){return{extract:function(n,e,o){return r=n,i=o,u=e,a=W(t,(function(t){return ln(r,i,t,u)})),en(a,{});var r,i,u,a},toString:function(){return"obj{\n"+W(t,(function(t){return t.fold((function(t,n,e,o){return t+" -> "+o.toString()}),(function(t,n){return"state("+t+")"}))})).join("\n")+"}"}}},gn=function(t){return{extract:function(n,e,o){var r=W(o,(function(o,r){return t.extract(n.concat(["["+r+"]"]),e,o)}));return on(r)},toString:function(){return"array("+t.toString()+")"}}},pn=function(t){return{extract:function(n,e,o){for(var r=[],i=0,u=t;i<u.length;i++){var a=u[i].extract(n,e,o);if(a.stype===y.Value)return a;r.push(a)}return on(r)},toString:function(){return"oneOf("+W(t,(function(t){return t.toString()})).join(", ")+")"}}},hn=function(t,n){return{extract:function(e,o,r){var u,a,c=_t(r),s=(u=e,a=c,gn(fn(t)).extract(u,i,a));return St(s,(function(t){var i=W(t,(function(t){return an.field(t,t,Xt(),n)}));return mn(i).extract(e,o,r)}))},toString:function(){return"setOf("+n.toString()+")"}}},vn=r(fn(yt)),bn=o(gn,mn),yn=an.state,xn=an.field,wn=function(t,n,e,o,r){return Rt(o,r).fold((function(){return n=o,e=r,un(t,(function(){return'The chosen schema: "'+e+'" did not exist in branches: '+rn(n)}));var n,e}),(function(o){return o.extract(t.concat(["branch: "+r]),n,e)}))},Sn=function(t,n){return{extract:function(e,o,r){return Rt(r,t).fold((function(){return n=t,un(e,(function(){return'Choice schema did not contain choice key: "'+n+'"'}));var n}),(function(t){return wn(e,o,r,n,t)}))},toString:function(){return"chooseOn("+t+"). Possible values: "+_t(n)}}},kn=fn(yt),Cn=function(t){return bn(t)},On=function(t){return{extract:function(n,e,o){return t().extract(n,e,o)},toString:function(){return t().toString()}}},_n=function(t){return fn((function(n){return t(n).fold(wt,yt)}))},Tn=function(t,n){return hn((function(n){return vt(t(n))}),n)},En=function(t,n,e){return bt((o=t,r=i,u=e,a=n.extract([o],r,u),Ot(a,(function(t){return{input:u,errors:t}}))));var o,r,u,a},Dn=function(t){return t.fold((function(t){throw new Error(An(t))}),i)},Bn=function(t,n,e){return Dn(En(t,n,e))},An=function(t){return"Errors: \n"+(n=t.errors,e=10<n.length?n.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):n,W(e,(function(t){return"Failed path: ("+t.path.join(" > ")+")\n"+t.getErrorInfo()})).join("\n")+"\n\nInput object: ")+rn(t.input);var n,e},Mn=Sn,Fn=function(t,n){return Sn(t,Dt(n,mn))},In=r(kn),Rn=function(t,e){return fn((function(o){var r=n(o);return t(o)?yt(o):wt("Expected type: "+e+" but got: "+r)}))},Pn=Rn(I,"number"),Vn=Rn(T,"string"),Hn=Rn(B,"boolean"),Ln=Rn(F,"function"),zn=function t(n){var e=function(t,n){for(var e=t.next();!e.done;){if(!n(e.value))return!1;e=t.next()}return!0};if(Object(n)!==n)return!0;switch({}.toString.call(n).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(n).every((function(e){return t(n[e])}));case"Map":return e(n.keys(),t)&&e(n.values(),t);case"Set":return e(n.keys(),t);default:return!1}},Nn=fn((function(t){return zn(t)?yt(t):wt("Expected value to be acceptable for sending via postMessage")})),jn=function(t){return _n((function(n){return z(t,n)?ft.value(n):ft.error('Unsupported value: "'+n+'", choose one of "'+t.join(", ")+'".')}))},Un=function(t){return xn(t,t,Xt(),vn())},Wn=function(t,n){return xn(t,t,Xt(),n)},Gn=function(t){return Wn(t,Vn)},Xn=function(t,n){return xn(t,t,Xt(),jn(n))},Yn=function(t){return Wn(t,Ln)},qn=function(t,n){return xn(t,t,Xt(),mn(n))},Kn=function(t,n){return xn(t,t,Xt(),bn(n))},Jn=function(t,n){return xn(t,t,Xt(),gn(n))},$n=function(t){return xn(t,t,Yt(),vn())},Qn=function(t,n){return xn(t,t,Yt(),n)},Zn=function(t){return Qn(t,Pn)},te=function(t){return Qn(t,Vn)},ne=function(t){return Qn(t,Ln)},ee=function(t,n){return Qn(t,mn(n))},oe=function(t,n){return xn(t,t,Gt(n),vn())},re=function(t,n,e){return xn(t,t,Gt(n),e)},ie=function(t,n){return re(t,n,Pn)},ue=function(t,n){return re(t,n,Vn)},ae=function(t,n,e){return re(t,n,jn(e))},ce=function(t,n){return re(t,n,Hn)},se=function(t,n){return re(t,n,Ln)},le=function(t,n,e){return re(t,n,gn(e))},fe=function(t,n,e){return re(t,n,mn(e))},de=function(t,n){return yn(t,n)},me=function(t){var n=t;return{get:function(){return n},set:function(t){n=t}}},ge=function(t){if(null===t||void 0===t)throw new Error("Node cannot be null or undefined");return{dom:t}},pe={fromHtml:function(t,n){var e=(n||document).createElement("div");if(e.innerHTML=t,!e.hasChildNodes()||1<e.childNodes.length)throw console.error("HTML does not have a single root node",t),new Error("HTML must have a single root node");return ge(e.childNodes[0])},fromTag:function(t,n){var e=(n||document).createElement(t);return ge(e)},fromText:function(t,n){var e=(n||document).createTextNode(t);return ge(e)},fromDom:ge,fromPoint:function(t,n,e){return C.from(t.dom.elementFromPoint(n,e)).map(ge)}},he=function(t,n){var e=function(t,n){for(var e=0;e<t.length;e++){var o=t[e];if(o.test(n))return o}}(t,n);if(!e)return{major:0,minor:0};var o=function(t){return Number(n.replace(e,"$"+t))};return be(o(1),o(2))},ve=function(){return be(0,0)},be=function(t,n){return{major:t,minor:n}},ye={nu:be,detect:function(t,n){var e=String(n).toLowerCase();return 0===t.length?ve():he(t,e)},unknown:ve},xe=function(t,n){var e=String(n).toLowerCase();return J(t,(function(t){return t.search(e)}))},we=function(t,n){return xe(t,n).map((function(t){var e=ye.detect(t.versionRegexes,n);return{current:t.name,version:e}}))},Se=function(t,n){return xe(t,n).map((function(t){var e=ye.detect(t.versionRegexes,n);return{current:t.name,version:e}}))},ke=function(t,n){return-1!==t.indexOf(n)},Ce=function(t,n){return o=n,r=(e=t).length-n.length,""===o||e.length>=o.length&&e.substr(r,r+o.length)===o;var e,o,r},Oe=(dt=/^\s+|\s+$/g,function(t){return t.replace(dt,"")}),_e=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Te=function(t){return function(n){return ke(n,t)}},Ee=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return ke(t,"edge/")&&ke(t,"chrome")&&ke(t,"safari")&&ke(t,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,_e],search:function(t){return ke(t,"chrome")&&!ke(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return ke(t,"msie")||ke(t,"trident")}},{name:"Opera",versionRegexes:[_e,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Te("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Te("firefox")},{name:"Safari",versionRegexes:[_e,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(ke(t,"safari")||ke(t,"mobile/"))&&ke(t,"applewebkit")}}],De=[{name:"Windows",search:Te("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return ke(t,"iphone")||ke(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Te("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Te("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Te("linux"),versionRegexes:[]},{name:"Solaris",search:Te("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Te("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Te("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Be={browsers:r(Ee),oses:r(De)},Ae="Firefox",Me=function(t){var n=t.current,e=t.version,o=function(t){return function(){return n===t}};return{current:n,version:e,isEdge:o("Edge"),isChrome:o("Chrome"),isIE:o("IE"),isOpera:o("Opera"),isFirefox:o(Ae),isSafari:o("Safari")}},Fe={unknown:function(){return Me({current:void 0,version:ye.unknown()})},nu:Me,edge:r("Edge"),chrome:r("Chrome"),ie:r("IE"),opera:r("Opera"),firefox:r(Ae),safari:r("Safari")},Ie="Windows",Re="Android",Pe="Solaris",Ve="FreeBSD",He="ChromeOS",Le=function(t){var n=t.current,e=t.version,o=function(t){return function(){return n===t}};return{current:n,version:e,isWindows:o(Ie),isiOS:o("iOS"),isAndroid:o(Re),isOSX:o("OSX"),isLinux:o("Linux"),isSolaris:o(Pe),isFreeBSD:o(Ve),isChromeOS:o(He)}},ze={unknown:function(){return Le({current:void 0,version:ye.unknown()})},nu:Le,windows:r(Ie),ios:r("iOS"),android:r(Re),linux:r("Linux"),osx:r("OSX"),solaris:r(Pe),freebsd:r(Ve),chromeos:r(He)},Ne=function(t,n){var e,o,i,u,a,c,s,l,f,d,m,g,p=Be.browsers(),h=Be.oses(),v=we(p,t).fold(Fe.unknown,Fe.nu),b=Se(h,t).fold(ze.unknown,ze.nu);return{browser:v,os:b,deviceType:(o=v,i=t,u=n,a=(e=b).isiOS()&&!0===/ipad/i.test(i),c=e.isiOS()&&!a,s=e.isiOS()||e.isAndroid(),l=s||u("(pointer:coarse)"),f=a||!c&&s&&u("(min-device-width:768px)"),d=c||s&&!f,m=o.isSafari()&&e.isiOS()&&!1===/safari/i.test(i),g=!d&&!f&&!m,{isiPad:r(a),isiPhone:r(c),isTablet:r(f),isPhone:r(d),isTouch:r(l),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:r(m),isDesktop:r(g)})}},je=function(t){return window.matchMedia(t).matches},Ue=Ut((function(){return Ne(navigator.userAgent,je)})),We=function(){return Ue()},Ge=function(t,n){var e=t.dom;if(1!==e.nodeType)return!1;var o=e;if(void 0!==o.matches)return o.matches(n);if(void 0!==o.msMatchesSelector)return o.msMatchesSelector(n);if(void 0!==o.webkitMatchesSelector)return o.webkitMatchesSelector(n);if(void 0!==o.mozMatchesSelector)return o.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")},Xe=function(t){return 1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType||0===t.childElementCount},Ye=function(t,n){return t.dom===n.dom},qe=function(t,n){return e=t.dom,o=n.dom,r=e,i=o,u=Node.DOCUMENT_POSITION_CONTAINED_BY,0!=(r.compareDocumentPosition(i)&u);var e,o,r,i,u},Ke=function(t,n){return We().browser.isIE()?qe(t,n):(e=n,o=t.dom,r=e.dom,o!==r&&o.contains(r));var e,o,r},Je=function(t){return F(t)?t:s},$e=function(t,n,e){for(var o=t.dom,r=Je(e);o.parentNode;){o=o.parentNode;var i=pe.fromDom(o),u=n(i);if(u.isSome())return u;if(r(i))break}return C.none()},Qe=function(t,n,e){var o=n(t),r=Je(e);return o.orThunk((function(){return r(t)?C.none():$e(t,n,r)}))},Ze=function(t,n){return Ye(t.element,n.event.target)},to=function(t){if(!Vt(t,"can")&&!Vt(t,"abort")&&!Vt(t,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(t,null,2)+" does not have can, abort, or run!");return Bn("Extracting event.handler",dn([oe("can",l),oe("abort",s),oe("run",e)]),t)},no=function(t){var n,e,o,r,i=(e=function(t){return t.can},function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];return K(n,(function(n,o){return n&&e(o).apply(void 0,t)}),!0)}),u=(o=n=t,r=function(t){return t.abort},function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return K(o,(function(n,e){return n||r(e).apply(void 0,t)}),!1)});return to({can:i,abort:u,run:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];G(t,(function(t){t.run.apply(void 0,n)}))}})},eo=r,oo=eo("touchstart"),ro=eo("touchmove"),io=eo("touchend"),uo=eo("touchcancel"),ao=eo("mousedown"),co=eo("mousemove"),so=eo("mouseout"),lo=eo("mouseup"),fo=eo("mouseover"),mo=eo("focusin"),go=eo("focusout"),po=eo("keydown"),ho=eo("keyup"),vo=eo("input"),bo=eo("change"),yo=eo("click"),xo=eo("transitionend"),wo=eo("selectstart"),So=function(t){return r("alloy."+t)},ko={tap:So("tap")},Co=So("focus"),Oo=So("blur.post"),_o=So("paste.post"),To=So("receive"),Eo=So("execute"),Do=So("focus.item"),Bo=ko.tap,Ao=So("longpress"),Mo=So("sandbox.close"),Fo=So("typeahead.cancel"),Io=So("system.init"),Ro=So("system.touchmove"),Po=So("system.touchend"),Vo=So("system.scroll"),Ho=So("system.resize"),Lo=So("system.attached"),zo=So("system.detached"),No=So("system.dismissRequested"),jo=So("system.repositionRequested"),Uo=So("focusmanager.shifted"),Wo=So("slotcontainer.visibility"),Go=So("change.tab"),Xo=So("dismiss.tab"),Yo=So("highlight"),qo=So("dehighlight"),Ko=function(t,n){Zo(t,t.element,n,{})},Jo=function(t,n,e){Zo(t,t.element,n,e)},$o=function(t){Ko(t,Eo())},Qo=function(t,n,e){Zo(t,n,e,{})},Zo=function(t,n,e,o){var r=d({target:n},o);t.getSystem().triggerEvent(e,n,r)},tr=function(t,n,e,o){t.getSystem().triggerEvent(e,n,o.event)},nr=Zt,er=function(t,n){return{key:t,value:to({abort:n})}},or=function(t){return{key:t,value:to({run:function(t,n){n.event.prevent()}})}},rr=function(t,n){return{key:t,value:to({run:n})}},ir=function(t,n,e){return{key:t,value:to({run:function(t,o){n.apply(void 0,[t,o].concat(e))}})}},ur=function(t){return function(n){return{key:t,value:to({run:function(t,e){Ze(t,e)&&n(t,e)}})}}},ar=function(t,n,e){var o,r,i=n.partUids[e];return r=i,rr(o=t,(function(t,n){t.getSystem().getByUid(r).each((function(t){tr(t,t.element,o,n)}))}))},cr=function(t,n){return rr(t,(function(t,e){var o=e.event,r=t.getSystem().getByDom(o.target).fold((function(){return Qe(o.target,(function(n){return t.getSystem().getByDom(n).toOptional()}),s).getOr(t)}),(function(t){return t}));n(t,r,e)}))},sr=function(t){return rr(t,(function(t,n){n.cut()}))},lr=function(t,n){return ur(t)(n)},fr=ur(Lo()),dr=ur(zo()),mr=ur(Io()),gr=(mt=Eo(),function(t){return rr(mt,t)}),pr=("undefined"!=typeof window||Function("return this;")(),function(t){return t.dom.nodeName.toLowerCase()}),hr=function(t){return function(n){return n.dom.nodeType===t}},vr=hr(1),br=hr(3),yr=hr(9),xr=hr(11),wr=function(t){return pe.fromDom(t.dom.ownerDocument)},Sr=function(t){return yr(t)?t:wr(t)},kr=function(t){return pe.fromDom(Sr(t).dom.documentElement)},Cr=function(t){return pe.fromDom(Sr(t).dom.defaultView)},Or=function(t){return C.from(t.dom.parentNode).map(pe.fromDom)},_r=Or,Tr=function(t){return C.from(t.dom.offsetParent).map(pe.fromDom)},Er=function(t){return W(t.dom.childNodes,pe.fromDom)},Dr=function(t,n){var e=t.dom.childNodes;return C.from(e[n]).map(pe.fromDom)},Br=function(t){return xr(t)&&M(t.dom.host)},Ar=F(Element.prototype.attachShadow)&&F(Node.prototype.getRootNode),Mr=r(Ar),Fr=Ar?function(t){return pe.fromDom(t.dom.getRootNode())}:Sr,Ir=function(t){return Br(t)?t:pe.fromDom(Sr(t).dom.body)},Rr=function(t){var n=Fr(t);return Br(n)?C.some(n):C.none()},Pr=function(t){return pe.fromDom(t.dom.host)},Vr=function(t){return M(t.dom.shadowRoot)},Hr=function(t,n){Or(t).each((function(e){e.dom.insertBefore(n.dom,t.dom)}))},Lr=function(t,n){var e;(e=t,C.from(e.dom.nextSibling).map(pe.fromDom)).fold((function(){Or(t).each((function(t){Nr(t,n)}))}),(function(t){Hr(t,n)}))},zr=function(t,n){Dr(t,0).fold((function(){Nr(t,n)}),(function(e){t.dom.insertBefore(n.dom,e.dom)}))},Nr=function(t,n){t.dom.appendChild(n.dom)},jr=function(t,n){G(n,(function(n){Nr(t,n)}))},Ur=function(t){t.dom.textContent="",G(Er(t),(function(t){Wr(t)}))},Wr=function(t){var n=t.dom;null!==n.parentNode&&n.parentNode.removeChild(n)},Gr=function(t){var n,e=Er(t);0<e.length&&(n=t,G(e,(function(t){Hr(n,t)}))),Wr(t)},Xr=function(t){return t.dom.innerHTML},Yr=function(t,n){var e,o,r=wr(t).dom,i=pe.fromDom(r.createDocumentFragment()),u=(e=n,(o=(r||document).createElement("div")).innerHTML=e,Er(pe.fromDom(o)));jr(i,u),Ur(t),Nr(t,i)},qr=function(t,n,e){if(!(T(e)||B(e)||I(e)))throw console.error("Invalid call to Attribute.set. Key ",n,":: Value ",e,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(n,e+"")},Kr=function(t,n,e){qr(t.dom,n,e)},Jr=function(t,n){var e=t.dom.getAttribute(n);return null===e?void 0:e},$r=function(t,n){return C.from(Jr(t,n))},Qr=function(t,n){var e=t.dom;return!(!e||!e.hasAttribute)&&e.hasAttribute(n)},Zr=function(t,n){t.dom.removeAttribute(n)},ti=function(t){return n=t,e=!1,pe.fromDom(n.dom.cloneNode(e));var n,e},ni=function(t){if(Br(t))return"#shadow-root";var n,e,o,r=ti(t);return n=r,e=pe.fromTag("div"),o=pe.fromDom(n.dom.cloneNode(!0)),Nr(e,o),Xr(e)},ei=nr([{key:Co(),value:to({can:function(t,n){var e,o,r=n.event,i=r.originator,u=r.target;return o=u,!(Ye(e=i,t.element)&&!Ye(e,o))||(console.warn(Co()+" did not get interpreted by the desired target. \nOriginator: "+ni(i)+"\nTarget: "+ni(u)+"\nCheck the "+Co()+" event handlers"),!1)}})}]),oi=Object.freeze({__proto__:null,events:ei}),ri=0,ii=function(t){var n=(new Date).getTime();return t+"_"+Math.floor(1e9*Math.random())+ ++ri+String(n)},ui=r("alloy-id-"),ai=r("data-alloy-id"),ci=ui(),si=ai(),li=function(t,n){Object.defineProperty(t.dom,si,{value:n,writable:!0})},fi=function(t){var n=vr(t)?t.dom[si]:null;return C.from(n)},di=ii,mi=i,gi=function(t){var n=function(n){return function(){throw new Error("The component must be in a context to send: "+n+(t?"\n"+ni(t().element)+" is not in context.":""))}};return{debugInfo:r("fake"),triggerEvent:n("triggerEvent"),triggerFocus:n("triggerFocus"),triggerEscape:n("triggerEscape"),build:n("build"),addToWorld:n("addToWorld"),removeFromWorld:n("removeFromWorld"),addToGui:n("addToGui"),removeFromGui:n("removeFromGui"),getByUid:n("getByUid"),getByDom:n("getByDom"),broadcast:n("broadcast"),broadcastOn:n("broadcastOn"),broadcastEvent:n("broadcastEvent"),isConnected:s}},pi=gi(),hi=function(t){return W(t,(function(t){return Ce(t,"/*")?t.substring(0,t.length-"/*".length):t}))},vi=function(t,n){var e=t.toString(),o=e.indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:n,parameters:hi(i)}},t},bi=ii("alloy-premade"),yi=function(t){return Qt(bi,t)},xi=function(t){return n=function(n){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return t.apply(void 0,g([n.getApis(),n],e))},e=t.toString(),o=e.indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/),n.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:hi(i.slice(1))}},n;var n,e,o,r,i},wi={init:function(){return Si({readState:function(){return"No State required"}})}},Si=function(t){return t},ki=function(t,n){var e={};return Et(t,(function(t,o){Et(t,(function(t,r){var i=Rt(e,r).getOr([]);e[r]=i.concat([n(o,t)])}))})),e},Ci=function(t){return{classes:void 0!==t.classes?t.classes:[],attributes:void 0!==t.attributes?t.attributes:{},styles:void 0!==t.styles?t.styles:{}}},Oi=function(t){return t.cHandler},_i=function(t,n){return{name:t,handler:n}},Ti=function(t,n,e){var o,r,i=d(d({},e),(o=t,r={},G(n,(function(t){r[t.name()]=t.handlers(o)})),r));return ki(i,_i)},Ei=function(t){var n,e=F(n=t)?{can:l,abort:s,run:n}:n;return function(t,n){for(var o=[],r=2;r<arguments.length;r++)o[r-2]=arguments[r];var i=[t,n].concat(o);e.abort.apply(void 0,i)?n.stop():e.can.apply(void 0,i)&&e.run.apply(void 0,i)}},Di=function(t,n,e){var o,r,i=n[e];return i?function(t,n,o,r){try{var i=ot(o,(function(e,o){var i=e[n],u=o[n],a=r.indexOf(i),c=r.indexOf(u);if(-1===a)throw new Error("The ordering for "+t+" does not have an entry for "+i+".\nOrder specified: "+JSON.stringify(r,null,2));if(-1===c)throw new Error("The ordering for "+t+" does not have an entry for "+u+".\nOrder specified: "+JSON.stringify(r,null,2));return a<c?-1:c<a?1:0}));return ft.value(i)}catch(e){return ft.error([e])}}("Event: "+e,"name",t,i).map((function(t){var n=W(t,(function(t){return t.handler}));return no(n)})):(o=e,r=t,ft.error(["The event ("+o+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(W(r,(function(t){return t.name})),null,2)]))},Bi=function(t,n){var e=Mt(t,(function(t,e){return(1===t.length?ft.value(t[0].handler):Di(t,n,e)).map((function(o){var r=Ei(o),i=1<t.length?Y(n[e],(function(n){return N(t,(function(t){return t.name===n}))})).join(" > "):t[0].name;return Qt(e,{handler:r,purpose:i})}))}));return tn(e,{})},Ai="alloy.base.behaviour",Mi=function(t){var n,e;return En("custom.definition",mn([xn("dom","dom",Xt(),mn([Un("tag"),oe("styles",{}),oe("classes",[]),oe("attributes",{}),$n("value"),$n("innerHtml")])),Un("components"),Un("uid"),oe("events",{}),oe("apis",{}),xn("eventOrder","eventOrder",((n={})[Eo()]=["disabling",Ai,"toggling","typeaheadevents"],n[Co()]=[Ai,"focusing","keying"],n[Io()]=[Ai,"disabling","toggling","representing"],n[vo()]=[Ai,"representing","streaming","invalidating"],n[zo()]=[Ai,"representing","item-events","tooltipping"],n[ao()]=["focusing",Ai,"item-type-events"],n[oo()]=["focusing",Ai,"item-type-events"],n[fo()]=["item-type-events","tooltipping"],n[To()]=["receiving","reflecting","tooltipping"],e=n,Wt.mergeWithThunk(r(e))),In()),$n("domModification")]),t)},Fi=function(t,n){var e=Jr(t,n);return void 0===e||""===e?[]:e.split(" ")},Ii=function(t){return void 0!==t.dom.classList},Ri=function(t,n){return r=n,i=Fi(e=t,o="class").concat([r]),Kr(e,o,i.join(" ")),!0;var e,o,r,i},Pi=function(t,n){return r=n,0<(i=Y(Fi(e=t,o="class"),(function(t){return t!==r}))).length?Kr(e,o,i.join(" ")):Zr(e,o),!1;var e,o,r,i},Vi=function(t,n){Ii(t)?t.dom.classList.add(n):Ri(t,n)},Hi=function(t){0===(Ii(t)?t.dom.classList:Fi(t,"class")).length&&Zr(t,"class")},Li=function(t,n){Ii(t)?t.dom.classList.remove(n):Pi(t,n),Hi(t)},zi=function(t,n){return Ii(t)&&t.dom.classList.contains(n)},Ni=function(t,n){G(n,(function(n){Vi(t,n)}))},ji=function(t,n){G(n,(function(n){Li(t,n)}))},Ui=function(t){return void 0!==t.style&&F(t.style.getPropertyValue)},Wi=function t(n){var e=br(n)?n.dom.parentNode:n.dom;if(void 0===e||null===e||null===e.ownerDocument)return!1;var o,r,i=e.ownerDocument;return Rr(pe.fromDom(e)).fold((function(){return i.body.contains(e)}),(o=t,r=Pr,function(t){return o(r(t))}))},Gi=function(){return Xi(pe.fromDom(document))},Xi=function(t){var n=t.dom.body;if(null===n||void 0===n)throw new Error("Body is not available yet");return pe.fromDom(n)},Yi=function(t,n,e){if(!T(e))throw console.error("Invalid call to CSS.set. Property ",n,":: Value ",e,":: Element ",t),new Error("CSS value must be a string: "+e);Ui(t)&&t.style.setProperty(n,e)},qi=function(t,n){Ui(t)&&t.style.removeProperty(n)},Ki=function(t,n,e){var o=t.dom;Yi(o,n,e)},Ji=function(t,n){var e=t.dom;Et(n,(function(t,n){Yi(e,n,t)}))},$i=function(t,n){var e=t.dom;Et(n,(function(t,n){t.fold((function(){qi(e,n)}),(function(t){Yi(e,n,t)}))}))},Qi=function(t,n){var e=t.dom,o=window.getComputedStyle(e).getPropertyValue(n);return""!==o||Wi(t)?o:Zi(e,n)},Zi=function(t,n){return Ui(t)?t.style.getPropertyValue(n):""},tu=function(t,n){var e=t.dom,o=Zi(e,n);return C.from(o).filter((function(t){return 0<t.length}))},nu=function(t,n,e){var o=pe.fromTag(t);return Ki(o,n,e),tu(o,n).isSome()},eu=function(t,n){var e=t.dom;qi(e,n),$r(t,"style").map(Oe).is("")&&Zr(t,"style")},ou=function(t){return t.dom.offsetWidth},ru=function(t){return t.dom.value},iu=function(t,n){if(void 0===n)throw new Error("Value.set was undefined");t.dom.value=n},uu=function(t){var n,e,o,r=pe.fromTag(t.tag);n=r,e=t.attributes,o=n.dom,Et(e,(function(t,n){qr(o,n,t)})),Ni(r,t.classes),Ji(r,t.styles),t.innerHtml.each((function(t){return Yr(r,t)}));var i=t.domChildren;return jr(r,i),t.value.each((function(t){iu(r,t)})),t.uid,li(r,t.uid),r},au=function(t,n){return e=t,r=W(o=n,(function(t){return ee(t.name(),[Un("config"),oe("state",wi)])})),i=En("component.behaviours",mn(r),e.behaviours).fold((function(t){throw new Error(An(t)+"\nComplete spec:\n"+JSON.stringify(e,null,2))}),(function(t){return t})),{list:o,data:Dt(i,(function(t){var n=t.map((function(t){return{config:t.config,state:t.state.init(t.config)}}));return function(){return n}}))};var e,o,r,i},cu=function(t){var n,e,o=(n=Rt(t,"behaviours").getOr({}),e=Y(_t(n),(function(t){return void 0!==n[t]})),W(e,(function(t){return n[t].me})));return au(t,o)},su=function(t,n,e){var o,r,i,u=d(d({},(o=t).dom),{uid:o.uid,domChildren:W(o.components,(function(t){return t.element}))}),a=t.domModification.fold((function(){return Ci({})}),Ci),c={"alloy.base.modification":a},s=0<n.length?function(t,n,e,o){var r=d({},n);G(e,(function(n){r[n.name()]=n.exhibit(t,o)}));var i=ki(r,(function(t,n){return{name:t,modification:n}})),u=function(t){return q(t,(function(t,n){return d(d({},n.modification),t)}),{})},a=q(i.classes,(function(t,n){return n.modification.concat(t)}),[]),c=u(i.attributes),s=u(i.styles);return Ci({classes:a,attributes:c,styles:s})}(e,c,n,u):a;return i=s,d(d({},r=u),{attributes:d(d({},r.attributes),i.attributes),styles:d(d({},r.styles),i.styles),classes:r.classes.concat(i.classes)})},lu=function(t,n,e){var o,r,i,u={"alloy.base.behaviour":t.events};return o=e,r=t.eventOrder,i=Ti(o,n,u),Bi(i,r).getOrDie()},fu=function(t){var n,e,o,r,i,u,a,c,s,l,f,g,p,h=mi(t),v=h.events,b=m(h,["events"]),y=(n=Rt(b,"components").getOr([]),W(n,pu)),x=d(d({},b),{events:d(d({},oi),v),components:y});return ft.value((o=function(){return p},r=me(pi),i=Dn(Mi(e=x)),u=cu(e),a=u.list,c=u.data,s=su(i,a,c),l=uu(s),f=lu(i,a,c),g=me(i.components),p={getSystem:r.get,config:function(t){var n=c;return(F(n[t.name()])?n[t.name()]:function(){throw new Error("Could not find "+t.name()+" in "+JSON.stringify(e,null,2))})()},hasConfigured:function(t){return F(c[t.name()])},spec:e,readState:function(t){return c[t]().map((function(t){return t.state.readState()})).getOr("not enabled")},getApis:function(){return i.apis},connect:function(t){r.set(t)},disconnect:function(){r.set(gi(o))},element:l,syncComponents:function(){var t=Er(l),n=Z(t,(function(t){return r.get().getByDom(t).fold((function(){return[]}),(function(t){return[t]}))}));g.set(n)},components:g.get,events:f}))},du=function(t){var n=pe.fromText(t);return mu({element:n})},mu=function(t){var n=Bn("external.component",dn([Un("element"),$n("uid")]),t),o=me(gi());n.uid.each((function(t){li(n.element,t)}));var i={getSystem:o.get,config:C.none,hasConfigured:s,connect:function(t){o.set(t)},disconnect:function(){o.set(gi((function(){return i})))},getApis:function(){return{}},element:n.element,spec:t,readState:r("No state"),syncComponents:e,components:r([]),events:{}};return yi(i)},gu=di,pu=function(t){return Rt(t,bi).fold((function(){var n=t.hasOwnProperty("uid")?t:d({uid:gu("")},t);return fu(n).getOrDie()}),(function(t){return t}))},hu=yi,vu=function(t,n){var e=function(e){var o=n(e);if(o<=0||null===o){var r=Qi(e,t);return parseFloat(r)||0}return o},o=function(t,n){return K(n,(function(n,e){var o=Qi(t,e),r=void 0===o?0:parseInt(o,10);return isNaN(r)?n:n+r}),0)};return{set:function(n,e){if(!I(e)&&!e.match(/^[0-9]+$/))throw new Error(t+".set accepts only positive integer values. Value was "+e);var o=n.dom;Ui(o)&&(o.style[t]=e+"px")},get:e,getOuter:e,aggregate:o,max:function(t,n,e){var r=o(t,e);return r<n?n-r:0}}},bu=vu("height",(function(t){var n=t.dom;return Wi(t)?n.getBoundingClientRect().height:n.offsetHeight})),yu=function(t){return bu.get(t)},xu=function(t){return bu.getOuter(t)},wu=function t(n,e){return{left:n,top:e,translate:function(o,r){return t(n+o,e+r)}}},Su=wu,ku=function(t,n){return void 0!==t?t:void 0!==n?n:0},Cu=function(t){var n=t.dom.ownerDocument,e=n.body,o=n.defaultView,r=n.documentElement;if(e===t.dom)return Su(e.offsetLeft,e.offsetTop);var i=ku(null==o?void 0:o.pageYOffset,r.scrollTop),u=ku(null==o?void 0:o.pageXOffset,r.scrollLeft),a=ku(r.clientTop,e.clientTop),c=ku(r.clientLeft,e.clientLeft);return Ou(t).translate(u-c,i-a)},Ou=function(t){var n,e=t.dom,o=e.ownerDocument.body;return o===e?Su(o.offsetLeft,o.offsetTop):Wi(t)?(n=e.getBoundingClientRect(),Su(n.left,n.top)):Su(0,0)},_u=vu("width",(function(t){return t.dom.offsetWidth})),Tu=function(t){return _u.get(t)},Eu=function(t){return _u.getOuter(t)},Du=function(t){var n=pe.fromDom(function(t){if(Mr()&&M(t.target)){var n=pe.fromDom(t.target);if(vr(n)&&Vr(n)&&t.composed&&t.composedPath){var e=t.composedPath();if(e)return it(e)}}return C.from(t.target)}(t).getOr(t.target)),e=function(){return t.stopPropagation()},r=function(){return t.preventDefault()},i=o(r,e);return{target:n,x:t.clientX,y:t.clientY,stop:e,prevent:r,kill:i,raw:t}},Bu=function(t,n,e,o,r){var i,a,c=(i=e,a=o,function(t){i(t)&&a(Du(t))});return t.dom.addEventListener(n,c,r),{unbind:u(Au,t,n,c,r)}},Au=function(t,n,e,o){t.dom.removeEventListener(n,e,o)},Mu=function(t){var n=void 0!==t?t.dom:document,e=n.body.scrollLeft||n.documentElement.scrollLeft,o=n.body.scrollTop||n.documentElement.scrollTop;return Su(e,o)},Fu=function(t,n,e){var o=(void 0!==e?e.dom:document).defaultView;o&&o.scrollTo(t,n)},Iu=function(t,n,e,o){return{x:t,y:n,width:e,height:o,right:t+e,bottom:n+o}},Ru=function(t){var n,e,o=void 0===t?window:t,r=o.document,i=Mu(pe.fromDom(r));return e=void 0===(n=o)?window:n,C.from(e.visualViewport).fold((function(){var t=o.document.documentElement,n=t.clientWidth,e=t.clientHeight;return Iu(i.left,i.top,n,e)}),(function(t){return Iu(Math.max(t.pageLeft,i.left),Math.max(t.pageTop,i.top),t.width,t.height)}))},Pu=function t(n,e){return n.view(e).fold(r([]),(function(e){var o=n.owner(e),r=t(n,o);return[e].concat(r)}))},Vu=Object.freeze({__proto__:null,view:function(t){var n;return(t.dom===document?C.none():C.from(null===(n=t.dom.defaultView)||void 0===n?void 0:n.frameElement)).map(pe.fromDom)},owner:wr}),Hu=function(t){var n,e,o,r,i=pe.fromDom(document),a=Mu(i);return(n=t,o=(e=Vu).owner(n),r=Pu(e,o),C.some(r)).fold(u(Cu,t),(function(n){var e=Ou(t),o=q(n,(function(t,n){var e=Ou(n);return{left:t.left+e.left,top:t.top+e.top}}),{left:0,top:0});return Su(o.left+e.left+a.left,o.top+e.top+a.top)}))},Lu=function(t,n,e,o){return{x:t,y:n,width:e,height:o,right:t+e,bottom:n+o}},zu=function(t){var n=Cu(t),e=Eu(t),o=xu(t);return Lu(n.left,n.top,e,o)},Nu=function(t){var n=Hu(t),e=Eu(t),o=xu(t);return Lu(n.left,n.top,e,o)},ju=function(){return Ru(window)};function Uu(t,n,e,o,r){return t(e,o)?C.some(e):F(r)&&r(e)?C.none():n(e,o,r)}var Wu,Gu,Xu=function(t,n,e){for(var o=t.dom,r=F(e)?e:s;o.parentNode;){o=o.parentNode;var i=pe.fromDom(o);if(n(i))return C.some(i);if(r(i))break}return C.none()},Yu=function(t,n,e){return Uu((function(t,n){return n(t)}),Xu,t,n,e)},qu=function(t,n,e){return Yu(t,n,e).isSome()},Ku=function(t,n,e){return Xu(t,(function(t){return Ge(t,n)}),e)},Ju=function(t,n){return e=n,r=void 0===(o=t)?document:o.dom,Xe(r)?C.none():C.from(r.querySelector(e)).map(pe.fromDom);var e,o,r},$u=function(t,n,e){return Uu(Ge,Ku,t,n,e)},Qu=function(){var t=ii("aria-owns");return{id:t,link:function(n){Kr(n,"aria-owns",t)},unlink:function(t){Zr(t,"aria-owns")}}},Zu=function(t,n){return Yu(n,(function(t){if(!vr(t))return!1;var n=Jr(t,"id");return void 0!==n&&-1<n.indexOf("aria-owns")})).bind((function(t){var n=Jr(t,"id"),e=Fr(t);return Ju(e,'[aria-owns="'+n+'"]')})).exists((function(n){return ta(t,n)}))},ta=function(t,n){return qu(n,(function(n){return Ye(n,t.element)}),s)||Zu(t,n)},na="unknown";(Gu=Wu=Wu||{})[Gu.STOP=0]="STOP",Gu[Gu.NORMAL=1]="NORMAL",Gu[Gu.LOGGING=2]="LOGGING";var ea,oa,ra=me({}),ia=["alloy/data/Fields","alloy/debugging/Debugging"],ua=function(t,n,e){var o,r,i,u;switch(Rt(ra.get(),t).orThunk((function(){var n=_t(ra.get());return ct(n,(function(n){return-1<t.indexOf(n)?C.some(ra.get()[n]):C.none()}))})).getOr(Wu.NORMAL)){case Wu.NORMAL:return e(aa());case Wu.LOGGING:var a=(o=t,r=n,i=[],u=(new Date).getTime(),{logEventCut:function(t,n,e){i.push({outcome:"cut",target:n,purpose:e})},logEventStopped:function(t,n,e){i.push({outcome:"stopped",target:n,purpose:e})},logNoParent:function(t,n,e){i.push({outcome:"no-parent",target:n,purpose:e})},logEventNoHandlers:function(t,n){i.push({outcome:"no-handlers-left",target:n})},logEventResponse:function(t,n,e){i.push({outcome:"response",purpose:e,target:n})},write:function(){var t=(new Date).getTime();z(["mousemove","mouseover","mouseout",Io()],o)||console.log(o,{event:o,time:t-u,target:r.dom,sequence:W(i,(function(t){return z(["cut","stopped","response"],t.outcome)?"{"+t.purpose+"} "+t.outcome+" at ("+ni(t.target)+")":t.outcome}))})}}),c=e(a);return a.write(),c;case Wu.STOP:return!0}},aa=r({logEventCut:e,logEventStopped:e,logNoParent:e,logEventNoHandlers:e,logEventResponse:e,write:e}),ca=r([Un("menu"),Un("selectedMenu")]),sa=r([Un("item"),Un("selectedItem")]),la=(r(mn(sa().concat(ca()))),r(mn(sa()))),fa=qn("initSize",[Un("numColumns"),Un("numRows")]),da=function(){return qn("markers",[Un("backgroundMenu")].concat(ca()).concat(sa()))},ma=function(t){return qn("markers",W(t,Un))},ga=function(t,n,e){return function(){var t=new Error;if(void 0!==t.stack){var n=t.stack.split("\n");J(n,(function(t){return 0<t.indexOf("alloy")&&!N(ia,(function(n){return-1<t.indexOf(n)}))})).getOr(na)}}(),xn(n,n,e,_n((function(t){return ft.value((function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t.apply(void 0,n)}))})))},pa=function(t){return ga(0,t,Gt(e))},ha=function(t){return ga(0,t,Gt(C.none))},va=function(t){return ga(0,t,Xt())},ba=function(t){return ga(0,t,Xt())},ya=function(t,n){return de(t,r(n))},xa=function(t){return de(t,i)},wa=r(fa),Sa=function(t,n,e,o,r,i){return{x:t,y:n,bubble:e,direction:o,boundsRestriction:r,label:i}},ka=Ht([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),Ca=ka.southeast,Oa=ka.southwest,_a=ka.northeast,Ta=ka.northwest,Ea=ka.south,Da=ka.north,Ba=ka.east,Aa=ka.west,Ma=function(t,n){return function(t,n){for(var e={},o=0,r=t.length;o<r;o++){var i=t[o];e[String(i)]=n(i,o)}return e}(["left","right","top","bottom"],(function(e){return Rt(n,e).map((function(n){return function(t,n){switch(n){case 1:return t.x;case 0:return t.x+t.width;case 2:return t.y;case 3:return t.y+t.height}}(t,n)}))}))},Fa=function(t){return t.x},Ia=function(t,n){return t.x+t.width/2-n.width/2},Ra=function(t,n){return t.x+t.width-n.width},Pa=function(t,n){return t.y-n.height},Va=function(t){return t.y+t.height},Ha=function(t,n){return t.y+t.height/2-n.height/2},La=function(t,n,e){return Sa(Fa(t),Va(t),e.southeast(),Ca(),Ma(t,{left:1,top:3}),"layout-se")},za=function(t,n,e){return Sa(Ra(t,n),Va(t),e.southwest(),Oa(),Ma(t,{right:0,top:3}),"layout-sw")},Na=function(t,n,e){return Sa(Fa(t),Pa(t,n),e.northeast(),_a(),Ma(t,{left:1,bottom:2}),"layout-ne")},ja=function(t,n,e){return Sa(Ra(t,n),Pa(t,n),e.northwest(),Ta(),Ma(t,{right:0,bottom:2}),"layout-nw")},Ua=function(t,n,e){return Sa(Ia(t,n),Pa(t,n),e.north(),Da(),Ma(t,{bottom:2}),"layout-n")},Wa=function(t,n,e){return Sa(Ia(t,n),Va(t),e.south(),Ea(),Ma(t,{top:3}),"layout-s")},Ga=function(t,n,e){return Sa((o=t).x+o.width,Ha(t,n),e.east(),Ba(),Ma(t,{left:0}),"layout-e");var o},Xa=function(t,n,e){return Sa((o=n,t.x-o.width),Ha(t,n),e.west(),Aa(),Ma(t,{right:1}),"layout-w");var o},Ya=function(){return[La,za,Na,ja,Wa,Ua,Ga,Xa]},qa=function(){return[za,La,ja,Na,Wa,Ua,Ga,Xa]},Ka=function(){return[Na,ja,La,za,Ua,Wa]},Ja=function(){return[ja,Na,za,La,Ua,Wa]},$a=function(){return[La,za,Na,ja,Wa,Ua]},Qa=function(){return[za,La,ja,Na,Wa,Ua]},Za=Object.freeze({__proto__:null,events:function(t){return nr([rr(To(),(function(n,e){var o,r,i=t.channels,u=_t(i),a=e,c=(o=u,(r=a).universal?o:Y(o,(function(t){return z(r.channels,t)})));G(c,(function(t){var e=i[t],o=e.schema,r=Bn("channel["+t+"] data\nReceiver: "+ni(n.element),o,a.data);e.onReceive(n,r)}))}))])}}),tc=[Wn("channels",Tn(ft.value,dn([va("onReceive"),oe("schema",In())])))],nc=function(t,n,e){return mr((function(o,r){e(o,t,n)}))},ec=function(t,n,e,o,r,i){var u=dn(t),a=ee(n,[Qn("config",dn(t))]);return ic(u,a,n,e,o,r,i)},oc=function(t,n,e){var o,i,u,a,c,s;return o=function(o){for(var i=[],u=1;u<arguments.length;u++)i[u-1]=arguments[u];var a=[o].concat(i);return o.config({name:r(t)}).fold((function(){throw new Error("We could not find any behaviour configuration for: "+t+". Using API: "+e)}),(function(t){var e=Array.prototype.slice.call(a,1);return n.apply(void 0,[o,t.config,t.state].concat(e))}))},i=e,u=n.toString(),a=u.indexOf(")")+1,c=u.indexOf("("),s=u.substring(c+1,a-1).split(/,\s*/),o.toFunctionAnnotation=function(){return{name:i,parameters:hi(s.slice(0,1).concat(s.slice(3)))}},o},rc=function(t){return{key:t,value:void 0}},ic=function(t,n,e,o,i,a,c){var s=function(t){return Vt(t,e)?t[e]():C.none()},l=Dt(i,(function(t,n){return oc(e,t,n)})),f=Dt(a,vi),m=d(d(d({},f),l),{revoke:u(rc,e),config:function(n){var o=Bn(e+"-config",t,n);return{key:e,value:{config:o,me:m,configAsRaw:Ut((function(){return Bn(e+"-config",t,n)})),initialConfig:n,state:c}}},schema:r(n),exhibit:function(t,n){return s(t).bind((function(t){return Rt(o,"exhibit").map((function(e){return e(n,t.config,t.state)}))})).getOr(Ci({}))},name:r(e),handlers:function(t){return s(t).map((function(t){return Rt(o,"events").getOr((function(){return{}}))(t.config,t.state)})).getOr({})}});return m},uc=Zt,ac=dn([Un("fields"),Un("name"),oe("active",{}),oe("apis",{}),oe("state",wi),oe("extra",{})]),cc=function(t){var n=Bn("Creating behaviour: "+t.name,ac,t);return ec(n.fields,n.name,n.active,n.apis,n.extra,n.state)},sc=dn([Un("branchKey"),Un("branches"),Un("name"),oe("active",{}),oe("apis",{}),oe("state",wi),oe("extra",{})]),lc=function(t){var n,e,o,r,i,u,a,c,s=Bn("Creating behaviour: "+t.name,sc,t);return n=Fn(s.branchKey,s.branches),e=s.name,o=s.active,r=s.apis,i=s.extra,u=s.state,c=ee(e,[Qn("config",a=n)]),ic(a,c,e,o,r,i,u)},fc=r(void 0),dc=cc({fields:tc,name:"receiving",active:Za}),mc=Object.freeze({__proto__:null,exhibit:function(t,n){return Ci({classes:[],styles:n.useFixed()?{}:{position:"relative"}})}}),gc=function(t){return t.dom.focus()},pc=function(t){return void 0===t&&(t=pe.fromDom(document)),C.from(t.dom.activeElement).map(pe.fromDom)},hc=function(t){return pc(Fr(t)).filter((function(n){return t.dom.contains(n.dom)}))},vc=function(t,n){var o=Fr(n),r=pc(o).bind((function(t){var e,o,r=function(n){return Ye(t,n)};return r(n)?C.some(n):(e=r,(o=function(t){for(var n=0;n<t.childNodes.length;n++){var r=pe.fromDom(t.childNodes[n]);if(e(r))return C.some(r);var i=o(t.childNodes[n]);if(i.isSome())return i}return C.none()})(n.dom))})),i=t(n);return r.each((function(t){pc(o).filter((function(n){return Ye(n,t)})).fold((function(){gc(t)}),e)})),i},bc=function(t,n,e,o,r){return{position:t,left:n,top:e,right:o,bottom:r}},yc=function(t,n){var e=function(t){return t+"px"};$i(t,{position:C.some(n.position),left:n.left.map(e),top:n.top.map(e),right:n.right.map(e),bottom:n.bottom.map(e)})},xc=Ht([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),wc=function(t,n,e,o,r,i){var u,a,c,s,l,f,d,m,g,p=n.x-e,h=n.y-o,v=r-(p+n.width),b=i-(h+n.height),y=C.some(p),x=C.some(h),w=C.some(v),S=C.some(b),k=C.none();return u=n.direction,a=function(){return bc(t,y,x,k,k)},c=function(){return bc(t,k,x,w,k)},s=function(){return bc(t,y,k,k,S)},l=function(){return bc(t,k,k,w,S)},f=function(){return bc(t,y,x,k,k)},d=function(){return bc(t,y,k,k,S)},m=function(){return bc(t,y,x,k,k)},g=function(){return bc(t,k,x,w,k)},u.fold(a,c,s,l,f,d,m,g)},Sc=function(t,n){var e=u(Hu,n),o=t.fold(e,e,(function(){var t=Mu();return Hu(n).translate(-t.left,-t.top)})),r=Eu(n),i=xu(n);return Lu(o.left,o.top,r,i)},kc=function(t,n,e){var o=Su(n,e);return t.fold(r(o),r(o),(function(){var t=Mu();return o.translate(-t.left,-t.top)}))},Cc=(xc.none,xc.relative),Oc=xc.fixed,_c=function(t,n,e,o){var r=t+n;return o<r?e:r<e?o:r},Tc=function(t,n,e){return Math.min(Math.max(t,n),e)},Ec=Ht([{fit:["reposition"]},{nofit:["reposition","deltaW","deltaH"]}]),Dc=function(t,n,e,o){var u,a,c,s,l,f,d,m,g,p,h,v,b,y,x,w,S,k,O,_,T,E,D,B,A,M,F,I,R,P,V,H,L,z=t.x,N=t.y,j=t.bubble.offset,U=j.left,W=j.top,G=(u=o,a=t.boundsRestriction,c=j,l=(s=function(t,n){var e="top"===t||"bottom"===t?c.top:c.left;return Rt(a,t).bind(i).bind((function(e){return"left"===t||"top"===t?n<=e?C.some(e):C.none():e<=n?C.some(e):C.none()})).map((function(t){return t+e})).getOr(n)})("left",u.x),f=s("top",u.y),d=s("right",u.right),m=s("bottom",u.bottom),Lu(l,f,d-l,m-f)),X=G.y,Y=G.bottom,q=G.x,K=G.right,J=N+W,$=(g=z+U,p=J,h=n,v=e,y=(b=G).x,x=b.y,w=b.width,S=b.height,O=x<=p,_=(k=y<=g)&&O,T=g+h<=y+w&&p+v<=x+S,E=Math.abs(Math.min(h,k?y+w-g:y-(g+h))),D=Math.abs(Math.min(v,O?x+S-p:x-(p+v))),B=Math.max(b.x,b.right-h),A=Math.max(b.y,b.bottom-v),{originInBounds:_,sizeInBounds:T,limitX:Tc(g,b.x,B),limitY:Tc(p,b.y,A),deltaW:E,deltaH:D}),Q=$.originInBounds,Z=$.sizeInBounds,tt=$.limitX,nt=$.limitY,et=$.deltaW,ot=$.deltaH,rt=r(nt+ot-X),it=r(Y-nt),ut=(M=t.direction,I=F=it,R=rt,M.fold(F,F,R,R,F,R,I,I)),at=r(tt+et-q),ct=r(K-tt),st={x:tt,y:nt,width:et,height:ot,maxHeight:ut,maxWidth:(P=t.direction,H=V=ct,L=at,P.fold(V,L,V,L,H,H,V,L)),direction:t.direction,classes:{on:t.bubble.classesOn,off:t.bubble.classesOff},label:t.label,candidateYforTest:J};return Q&&Z?Ec.fit(st):Ec.nofit(st,et,ot)},Bc=function(t,n,e,o){eu(n,"max-height"),eu(n,"max-width");var r,a,c,s,l,f,d,m,g,p={width:Eu(r=n),height:xu(r)};return a=o.preference,c=t,s=p,l=e,f=o.bounds,d=s.width,m=s.height,g=function(t,n,e,o){var r=t(c,s,l);return Dc(r,d,m,f).fold(Ec.fit,(function(t,r,i){return o<i||e<r?Ec.nofit(t,r,i):Ec.nofit(n,e,o)}))},K(a,(function(t,n){var e=u(g,n);return t.fold(Ec.fit,e)}),Ec.nofit({x:c.x,y:c.y,width:s.width,height:s.height,maxHeight:s.height,maxWidth:s.width,direction:Ca(),classes:{on:[],off:[]},label:"none",candidateYforTest:c.y},-1,-1)).fold(i,i)},Ac=function(t,n,e){var o,r;yc(t,(o=e.origin,r=n,o.fold((function(){return bc("absolute",C.some(r.x),C.some(r.y),C.none(),C.none())}),(function(t,n,e,o){return wc("absolute",r,t,n,e,o)}),(function(t,n,e,o){return wc("fixed",r,t,n,e,o)}))))},Mc=function(t,n){var e,o,r;e=t,o=Math.floor(n),r=bu.max(e,o,["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"]),Ki(e,"max-height",r+"px")},Fc=r((function(t,n){Mc(t,n),Ji(t,{"overflow-x":"hidden","overflow-y":"auto"})})),Ic=r((function(t,n){Mc(t,n)})),Rc=function(t,n,e){return void 0===t[n]?e:t[n]},Pc=function(t,n,o,r,i,u){var a,c=Rc(u,"maxHeightFunction",Fc()),s=Rc(u,"maxWidthFunction",e),l=t.anchorBox,f=t.origin,d={bounds:(a=f,i.fold((function(){return a.fold(ju,ju,Lu)}),(function(t){return a.fold(t,t,(function(){var n=t(),e=kc(a,n.x,n.y);return Lu(e.left,e.top,n.width,n.height)}))}))),origin:f,preference:r,maxHeightFunction:c,maxWidthFunction:s};Vc(l,n,o,d)},Vc=function(t,n,e,o){var r,i,u,a,c,s,l=Bc(t,n,e,o);Ac(n,l,o),r=n,i=l.classes,ji(r,i.off),Ni(r,i.on),u=n,a=l,(0,o.maxHeightFunction)(u,a.maxHeight),c=n,s=l,(0,o.maxWidthFunction)(c,s.maxWidth)},Hc=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right"],Lc=function(t,n,e){var o=function(t){return Rt(e,t).getOr([])},r=function(t,n,e){var r=et(Hc,e);return{offset:Su(t,n),classesOn:Z(e,o),classesOff:Z(r,o)}};return{southeast:function(){return r(-t,n,["top","alignLeft"])},southwest:function(){return r(t,n,["top","alignRight"])},south:function(){return r(-t/2,n,["top","alignCentre"])},northeast:function(){return r(-t,-n,["bottom","alignLeft"])},northwest:function(){return r(t,-n,["bottom","alignRight"])},north:function(){return r(-t/2,-n,["bottom","alignCentre"])},east:function(){return r(t,-n/2,["valignCentre","left"])},west:function(){return r(-t,-n/2,["valignCentre","right"])},innerNorthwest:function(){return r(-t,n,["top","alignRight"])},innerNortheast:function(){return r(t,n,["top","alignLeft"])},innerNorth:function(){return r(-t/2,n,["top","alignCentre"])},innerSouthwest:function(){return r(-t,-n,["bottom","alignRight"])},innerSoutheast:function(){return r(t,-n,["bottom","alignLeft"])},innerSouth:function(){return r(-t/2,-n,["bottom","alignCentre"])},innerWest:function(){return r(t,-n/2,["valignCentre","right"])},innerEast:function(){return r(-t,-n/2,["valignCentre","left"])}}},zc=function(){return Lc(0,0,{})},Nc=function(t,n){return function(e){return"rtl"===jc(e)?n:t}},jc=function(t){return"rtl"===Qi(t,"direction")?"rtl":"ltr"};(oa=ea=ea||{}).TopToBottom="toptobottom",oa.BottomToTop="bottomtotop";var Uc,Wc,Gc,Xc,Yc,qc="data-alloy-vertical-dir",Kc=function(t){return qu(t,(function(t){return vr(t)&&Jr(t,"data-alloy-vertical-dir")===ea.BottomToTop}))},Jc=function(){return ee("layouts",[Un("onLtr"),Un("onRtl"),$n("onBottomLtr"),$n("onBottomRtl")])},$c=function(t,n,e,o,r,i,u){var a=u.map(Kc).getOr(!1),c=n.layouts.map((function(n){return n.onLtr(t)})),s=n.layouts.map((function(n){return n.onRtl(t)})),l=a?n.layouts.bind((function(n){return n.onBottomLtr.map((function(n){return n(t)}))})).or(c).getOr(r):c.getOr(e),f=a?n.layouts.bind((function(n){return n.onBottomRtl.map((function(n){return n(t)}))})).or(s).getOr(i):s.getOr(o);return Nc(l,f)(t)},Qc=[Un("hotspot"),$n("bubble"),oe("overrides",{}),Jc(),ya("placement",(function(t,n,e){var o=n.hotspot,r=Sc(e,o.element),i=$c(t.element,n,$a(),Qa(),Ka(),Ja(),C.some(n.hotspot.element));return C.some({anchorBox:r,bubble:n.bubble.getOr(zc()),overrides:n.overrides,layouts:i,placer:C.none()})}))],Zc=[Un("x"),Un("y"),oe("height",0),oe("width",0),oe("bubble",zc()),oe("overrides",{}),Jc(),ya("placement",(function(t,n,e){var o=kc(e,n.x,n.y),r=Lu(o.left,o.top,n.width,n.height),i=$c(t.element,n,Ya(),qa(),Ya(),qa(),C.none());return C.some({anchorBox:r,bubble:n.bubble,overrides:n.overrides,layouts:i,placer:C.none()})}))],ts=Ht([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),ns=function(t){return t.fold(i,(function(t,n,e){return t.translate(-n,-e)}))},es=function(t){return t.fold(i,i)},os=function(t){return K(t,(function(t,n){return t.translate(n.left,n.top)}),Su(0,0))},rs=function(t){var n=W(t,es);return os(n)},is=ts.screen,us=ts.absolute,as=function(t,n,e){var o,r,i=wr(t.element),u=Mu(i),a=(o=t,r=Cr(e.root).dom,C.from(r.frameElement).map(pe.fromDom).filter((function(t){var n=wr(t),e=wr(o.element);return Ye(n,e)})).map(Cu).getOr(u));return us(a,u.left,u.top)},cs=function(t,n,e,o){var r=t,i=n,u=e,a=o;t<0&&(r=0,u=e+t),n<0&&(i=0,a=o+n);var c=is(Su(r,i));return C.some({point:c,width:u,height:a})},ss=function(t,n,e,o,r){return t.map((function(t){var i,u,a,c=[n,t.point],s=(i=function(){return rs(c)},u=function(){return rs(c)},a=function(){return t=W(c,ns),os(t);var t},o.fold(i,u,a)),l={x:s.left,y:s.top,width:t.width,height:t.height},f=(e.showAbove?Ka:$a)(),d=(e.showAbove?Ja:Qa)(),m=$c(r,e,f,d,f,d,C.none());return{anchorBox:l,bubble:e.bubble.getOr(zc()),overrides:e.overrides,layouts:m,placer:C.none()}}))},ls=[Un("node"),Un("root"),$n("bubble"),Jc(),oe("overrides",{}),oe("showAbove",!1),ya("placement",(function(t,n,e){var o=as(t,0,n);return n.node.filter(Wi).bind((function(r){var i=r.dom.getBoundingClientRect(),u=cs(i.left,i.top,i.width,i.height),a=n.node.getOr(t.element);return ss(u,o,n,e,a)}))}))],fs=function(t,n,e,o){return{start:t,soffset:n,finish:e,foffset:o}},ds=Ht([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),ms=(ds.before,ds.on,ds.after,function(t){return t.fold(i,i,i)}),gs=Ht([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),ps={domRange:gs.domRange,relative:gs.relative,exact:gs.exact,exactFromRange:function(t){return gs.exact(t.start,t.soffset,t.finish,t.foffset)},getWin:function(t){var n=t.match({domRange:function(t){return pe.fromDom(t.startContainer)},relative:function(t,n){return ms(t)},exact:function(t,n,e,o){return t}});return Cr(n)},range:fs},hs=function(t,n,e){var o,r,i=t.document.createRange();return o=i,n.fold((function(t){o.setStartBefore(t.dom)}),(function(t,n){o.setStart(t.dom,n)}),(function(t){o.setStartAfter(t.dom)})),r=i,e.fold((function(t){r.setEndBefore(t.dom)}),(function(t,n){r.setEnd(t.dom,n)}),(function(t){r.setEndAfter(t.dom)})),i},vs=function(t,n,e,o,r){var i=t.document.createRange();return i.setStart(n.dom,e),i.setEnd(o.dom,r),i},bs=function(t){return{left:t.left,top:t.top,right:t.right,bottom:t.bottom,width:t.width,height:t.height}},ys=Ht([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),xs=function(t,n,e){return n(pe.fromDom(e.startContainer),e.startOffset,pe.fromDom(e.endContainer),e.endOffset)},ws=function(t,n){var e,o,i,u=(e=t,n.match({domRange:function(t){return{ltr:r(t),rtl:C.none}},relative:function(t,n){return{ltr:Ut((function(){return hs(e,t,n)})),rtl:Ut((function(){return C.some(hs(e,n,t))}))}},exact:function(t,n,o,r){return{ltr:Ut((function(){return vs(e,t,n,o,r)})),rtl:Ut((function(){return C.some(vs(e,o,r,t,n))}))}}}));return(i=(o=u).ltr()).collapsed?o.rtl().filter((function(t){return!1===t.collapsed})).map((function(t){return ys.rtl(pe.fromDom(t.endContainer),t.endOffset,pe.fromDom(t.startContainer),t.startOffset)})).getOrThunk((function(){return xs(0,ys.ltr,i)})):xs(0,ys.ltr,i)},Ss=(ys.ltr,ys.rtl,Uc=br,Wc="text",{get:function(t){if(!Uc(t))throw new Error("Can only get "+Wc+" value of a "+Wc+" node");return Gc(t).getOr("")},getOption:Gc=function(t){return Uc(t)?C.from(t.dom.nodeValue):C.none()},set:function(t,n){if(!Uc(t))throw new Error("Can only set raw "+Wc+" value of a "+Wc+" node");t.dom.nodeValue=n}}),ks=function(t){return Ss.getOption(t)},Cs=["img","br"],Os=function(t){return ks(t).filter((function(t){return 0!==t.trim().length||-1<t.indexOf(" ")})).isSome()||z(Cs,pr(t))},_s=function(t,n){var e=function t(e){for(var o=Er(e),r=o.length-1;0<=r;r--){var i=o[r];if(n(i))return C.some(i);var u=t(i);if(u.isSome())return u}return C.none()};return e(t)},Ts=function(t,n){return e=n,r=void 0===(o=t)?document:o.dom,Xe(r)?[]:W(r.querySelectorAll(e),pe.fromDom);var e,o,r},Es=function(t,n,e,o){var r,i,u,a,c,s=(i=n,u=e,a=o,(c=wr(r=t).dom.createRange()).setStart(r.dom,i),c.setEnd(u.dom,a),c),l=Ye(t,e)&&n===o;return s.collapsed&&!l},Ds=function(t){if(0<t.rangeCount){var n=t.getRangeAt(0),e=t.getRangeAt(t.rangeCount-1);return C.some(fs(pe.fromDom(n.startContainer),n.startOffset,pe.fromDom(e.endContainer),e.endOffset))}return C.none()},Bs=function(t){if(null===t.anchorNode||null===t.focusNode)return Ds(t);var n=pe.fromDom(t.anchorNode),e=pe.fromDom(t.focusNode);return Es(n,t.anchorOffset,e,t.focusOffset)?C.some(fs(n,t.anchorOffset,e,t.focusOffset)):Ds(t)},As=function(t){return n=t,C.from(n.getSelection()).filter((function(t){return 0<t.rangeCount})).bind(Bs);var n},Ms=function(t,n){var e,o,r,i,u=ws(e=t,n).match({ltr:function(t,n,o,r){var i=e.document.createRange();return i.setStart(t.dom,n),i.setEnd(o.dom,r),i},rtl:function(t,n,o,r){var i=e.document.createRange();return i.setStart(o.dom,r),i.setEnd(t.dom,n),i}});return r=(o=u).getClientRects(),0<(i=0<r.length?r[0]:o.getBoundingClientRect()).width||0<i.height?C.some(i).map(bs):C.none()},Fs=function(t,n){return{element:t,offset:n}},Is=function(t,n){var e=Er(t);if(0===e.length)return Fs(t,n);if(n<e.length)return Fs(e[n],0);var o,r=e[e.length-1],i=br(r)?(o=r,Ss.get(o).length):Er(r).length;return Fs(r,i)},Rs=function(t,n){return(br(t)?Fs:Is)(t,n)},Ps=function(t,n){return n.getSelection.getOrThunk((function(){return function(){return As(t)}}))().map((function(t){var n=Rs(t.start,t.soffset),e=Rs(t.finish,t.foffset);return ps.range(n.element,n.offset,e.element,e.offset)}))},Vs=[$n("getSelection"),Un("root"),$n("bubble"),Jc(),oe("overrides",{}),oe("showAbove",!1),ya("placement",(function(t,n,e){var o=Cr(n.root).dom,r=as(t,0,n),i=Ps(o,n).bind((function(t){return Ms(o,ps.exactFromRange(t)).orThunk((function(){var n=pe.fromText("\ufeff");return Hr(t.start,n),Ms(o,ps.exact(n,0,n,1)).map((function(t){return Wr(n),t}))})).bind((function(t){return cs(t.left,t.top,t.width,t.height)}))})),u=Ps(o,n).bind((function(t){return vr(t.start)?C.some(t.start):_r(t.start)})).getOr(t.element);return ss(i,r,n,e,u)}))],Hs=function(t){return t.x+t.width},Ls=function(t,n){return t.x-n.width},zs=function(t,n){return t.y-n.height+t.height},Ns=function(t){return t.y},js=function(t,n,e){return Sa(Hs(t),Ns(t),e.southeast(),Ca(),Ma(t,{left:0,top:2}),"link-layout-se")},Us=function(t,n,e){return Sa(Ls(t,n),Ns(t),e.southwest(),Oa(),Ma(t,{right:1,top:2}),"link-layout-sw")},Ws=function(t,n,e){return Sa(Hs(t),zs(t,n),e.northeast(),_a(),Ma(t,{left:0,bottom:3}),"link-layout-ne")},Gs=function(t,n,e){return Sa(Ls(t,n),zs(t,n),e.northwest(),Ta(),Ma(t,{right:1,bottom:3}),"link-layout-nw")},Xs=function(){return[js,Us,Ws,Gs]},Ys=function(){return[Us,js,Gs,Ws]},qs=[Un("item"),Jc(),oe("overrides",{}),ya("placement",(function(t,n,e){var o=Sc(e,n.item.element),r=$c(t.element,n,Xs(),Ys(),Xs(),Ys(),C.none());return C.some({anchorBox:o,bubble:zc(),overrides:n.overrides,layouts:r,placer:C.none()})}))],Ks=Fn("anchor",{selection:Vs,node:ls,hotspot:Qc,submenu:qs,makeshift:Zc}),Js=function(t,n,e,o,r){var i={anchorBox:e.anchorBox,origin:n};Pc(i,r.element,e.bubble,e.layouts,o,e.overrides)},$s=function(t,n,e,o,r,i){var u=i.map(zu);return Qs(t,n,e,o,r,u)},Qs=function(t,n,e,o,i,u){var a=Bn("positioning anchor.info",Ks,o);vc((function(){Ki(i.element,"position","fixed");var e=tu(i.element,"visibility");Ki(i.element,"visibility","hidden");var o,c,s,l,f=n.useFixed()?(l=document.documentElement,Oc(0,0,l.clientWidth,l.clientHeight)):(c=Cu((o=t).element),s=o.element.dom.getBoundingClientRect(),Cc(c.left,c.top,s.width,s.height)),d=a.placement,m=u.map(r).or(n.getBounds);d(t,a,f).each((function(n){n.placer.getOr(Js)(t,f,n,m,i)})),e.fold((function(){eu(i.element,"visibility")}),(function(t){Ki(i.element,"visibility",t)})),tu(i.element,"left").isNone()&&tu(i.element,"top").isNone()&&tu(i.element,"right").isNone()&&tu(i.element,"bottom").isNone()&&tu(i.element,"position").is("fixed")&&eu(i.element,"position")}),i.element)},Zs=Object.freeze({__proto__:null,position:function(t,n,e,o,r){$s(t,n,e,o,r,C.none())},positionWithin:$s,positionWithinBounds:Qs,getMode:function(t,n,e){return n.useFixed()?"fixed":"absolute"}}),tl=[oe("useFixed",s),$n("getBounds")],nl=cc({fields:tl,name:"positioning",active:mc,apis:Zs}),el=function t(n){Ko(n,zo());var e=n.components();G(e,t)},ol=function t(n){var e=n.components();G(e,t),Ko(n,Lo())},rl=function(t,n){Nr(t.element,n.element)},il=function(t,n){var e,o=t.components();G((e=t).components(),(function(t){return Wr(t.element)})),Ur(e.element),e.syncComponents();var r=et(o,n);G(r,(function(n){el(n),t.getSystem().removeFromWorld(n)})),G(n,(function(n){n.getSystem().isConnected()?rl(t,n):(t.getSystem().addToWorld(n),rl(t,n),Wi(t.element)&&ol(n)),t.syncComponents()}))},ul=function(t,n){al(t,n,Nr)},al=function(t,n,e){t.getSystem().addToWorld(n),e(t.element,n.element),Wi(t.element)&&ol(n),t.syncComponents()},cl=function(t){el(t),Wr(t.element),t.getSystem().removeFromWorld(t)},sl=function(t){var n=Or(t.element).bind((function(n){return t.getSystem().getByDom(n).toOptional()}));cl(t),n.each((function(t){t.syncComponents()}))},ll=function(t){var n=t.components();G(n,cl),Ur(t.element),t.syncComponents()},fl=function(t,n){dl(t,n,Nr)},dl=function(t,n,e){e(t,n.element);var o=Er(n.element);G(o,(function(t){n.getByDom(t).each(ol)}))},ml=function(t){var n=Er(t.element);G(n,(function(n){t.getByDom(n).each(el)})),Wr(t.element)},gl=function(t,n,e,o){e.get().each((function(n){ll(t)}));var r=n.getAttachPoint(t);ul(r,t);var i=t.getSystem().build(o);return ul(t,i),e.set(i),i},pl=function(t,n,e,o){var r=gl(t,n,e,o);return n.onOpen(t,r),r},hl=function(t,n,e){e.get().each((function(o){ll(t),sl(t),n.onClose(t,o),e.clear()}))},vl=function(t,n,e){return e.isOpen()},bl=function(t,n,e){var o,r,i,u,a=n.getAttachPoint(t);Ki(t.element,"position",nl.getMode(a)),o=t,r="visibility",i=n.cloakVisibilityAttr,u="hidden",tu(o.element,r).fold((function(){Zr(o.element,i)}),(function(t){Kr(o.element,i,t)})),Ki(o.element,r,u)},yl=function(t,n,e){var o,r,i,u;o=t.element,N(["top","left","right","bottom"],(function(t){return tu(o,t).isSome()}))||eu(t.element,"position"),r=t,i="visibility",u=n.cloakVisibilityAttr,$r(r.element,u).fold((function(){return eu(r.element,i)}),(function(t){return Ki(r.element,i,t)}))},xl=Object.freeze({__proto__:null,cloak:bl,decloak:yl,open:pl,openWhileCloaked:function(t,n,e,o,r){bl(t,n),pl(t,n,e,o),r(),yl(t,n)},close:hl,isOpen:vl,isPartOf:function(t,n,e,o){return vl(0,0,e)&&e.get().exists((function(e){return n.isPartOf(t,e,o)}))},getState:function(t,n,e){return e.get()},setContent:function(t,n,e,o){return e.get().map((function(){return gl(t,n,e,o)}))}}),wl=Object.freeze({__proto__:null,events:function(t,n){return nr([rr(Mo(),(function(e,o){hl(e,t,n)}))])}}),Sl=[pa("onOpen"),pa("onClose"),Un("isPartOf"),Un("getAttachPoint"),oe("cloakVisibilityAttr","data-precloak-visibility")],kl=cc({fields:Sl,name:"sandboxing",active:wl,apis:xl,state:Object.freeze({__proto__:null,init:function(){var t=me(C.none()),n=r("not-implemented");return Si({readState:n,isOpen:function(){return t.get().isSome()},clear:function(){t.set(C.none())},set:function(n){t.set(C.some(n))},get:function(){return t.get()}})}})}),Cl=r("dismiss.popups"),Ol=r("reposition.popups"),_l=r("mouse.released"),Tl=dn([oe("isExtraPart",s),ee("fireEventInstead",[oe("event",No())])]),El=function(t){var n=Bn("Dismissal",Tl,t),e={};return e[Cl()]={schema:dn([Un("target")]),onReceive:function(t,e){kl.isOpen(t)&&(kl.isPartOf(t,e.target)||n.isExtraPart(t,e.target)||n.fireEventInstead.fold((function(){return kl.close(t)}),(function(n){return Ko(t,n.event)})))}},e},Dl=dn([ee("fireEventInstead",[oe("event",jo())]),Yn("doReposition")]),Bl=function(t){var n=Bn("Reposition",Dl,t),e={};return e[Ol()]={onReceive:function(t){kl.isOpen(t)&&n.fireEventInstead.fold((function(){return n.doReposition(t)}),(function(n){return Ko(t,n.event)}))}},e},Al=function(t,n,e){n.store.manager.onLoad(t,n,e)},Ml=function(t,n,e){n.store.manager.onUnload(t,n,e)},Fl=Object.freeze({__proto__:null,onLoad:Al,onUnload:Ml,setValue:function(t,n,e,o){n.store.manager.setValue(t,n,e,o)},getValue:function(t,n,e){return n.store.manager.getValue(t,n,e)},getState:function(t,n,e){return e}}),Il=Object.freeze({__proto__:null,events:function(t,n){var e=t.resetOnDom?[fr((function(e,o){Al(e,t,n)})),dr((function(e,o){Ml(e,t,n)}))]:[nc(t,n,Al)];return nr(e)}}),Rl=function(){var t=me(null);return Si({set:t.set,get:t.get,isNotSet:function(){return null===t.get()},clear:function(){t.set(null)},readState:function(){return{mode:"memory",value:t.get()}}})},Pl=function(){var t=me({}),n=me({});return Si({readState:function(){return{mode:"dataset",dataByValue:t.get(),dataByText:n.get()}},lookup:function(e){return Rt(t.get(),e).orThunk((function(){return Rt(n.get(),e)}))},update:function(e){var o=t.get(),r=n.get(),i={},u={};G(e,(function(t){i[t.value]=t,Rt(t,"meta").each((function(n){Rt(n,"text").each((function(n){u[n]=t}))}))})),t.set(d(d({},o),i)),n.set(d(d({},r),u))},clear:function(){t.set({}),n.set({})}})},Vl=Object.freeze({__proto__:null,memory:Rl,dataset:Pl,manual:function(){return Si({readState:e})},init:function(t){return t.store.manager.state(t)}}),Hl=function(t,n,e,o){var r=n.store;e.update([o]),r.setValue(t,o),n.onSetValue(t,o)},Ll=[$n("initialValue"),Un("getFallbackEntry"),Un("getDataKey"),Un("setValue"),ya("manager",{setValue:Hl,getValue:function(t,n,e){var o=n.store,r=o.getDataKey(t);return e.lookup(r).fold((function(){return o.getFallbackEntry(r)}),(function(t){return t}))},onLoad:function(t,n,e){n.store.initialValue.each((function(o){Hl(t,n,e,o)}))},onUnload:function(t,n,e){e.clear()},state:Pl})],zl=[Un("getValue"),oe("setValue",e),$n("initialValue"),ya("manager",{setValue:function(t,n,e,o){n.store.setValue(t,o),n.onSetValue(t,o)},getValue:function(t,n,e){return n.store.getValue(t)},onLoad:function(t,n,e){n.store.initialValue.each((function(e){n.store.setValue(t,e)}))},onUnload:e,state:wi.init})],Nl=[$n("initialValue"),ya("manager",{setValue:function(t,n,e,o){e.set(o),n.onSetValue(t,o)},getValue:function(t,n,e){return e.get()},onLoad:function(t,n,e){n.store.initialValue.each((function(t){e.isNotSet()&&e.set(t)}))},onUnload:function(t,n,e){e.clear()},state:Rl})],jl=[re("store",{mode:"memory"},Fn("mode",{memory:Nl,manual:zl,dataset:Ll})),pa("onSetValue"),oe("resetOnDom",!1)],Ul=cc({fields:jl,name:"representing",active:Il,apis:Fl,extra:{setValueFrom:function(t,n){var e=Ul.getValue(n);Ul.setValue(t,e)}},state:Vl}),Wl=function(t,n){return fe(t,{},W(n,(function(n){return e=n.name(),o="Cannot configure "+n.name()+" for "+t,xn(e,e,Yt(),fn((function(t){return wt("The field: "+e+" is forbidden. "+o)})));var e,o})).concat([de("dump",i)]))},Gl=function(t){return t.dump},Xl=function(t,n){return d(d({},t.dump),uc(n))},Yl=Wl,ql=Xl,Kl="placeholder",Jl=Ht([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),$l=function(t){return Pt(t,"uiType")},Ql=function(t,n,e,o){return $l(e)&&e.uiType===Kl?(u=e,a=o,(i=t).exists((function(t){return t!==u.owner}))?Jl.single(!0,r(u)):Rt(a,u.name).fold((function(){throw new Error("Unknown placeholder component: "+u.name+"\nKnown: ["+_t(a)+"]\nNamespace: "+i.getOr("none")+"\nSpec: "+JSON.stringify(u,null,2))}),(function(t){return t.replace()}))):Jl.single(!1,r(e));var i,u,a},Zl=function t(n,e,o,r){return Ql(n,0,o,r).fold((function(i,u){var a=$l(o)?u(e,o.config,o.validated):u(e),c=Rt(a,"components").getOr([]),s=Z(c,(function(o){return t(n,e,o,r)}));return[d(d({},a),{components:s})]}),(function(t,n){if($l(o)){var r=n(e,o.config,o.validated);return o.validated.preprocess.getOr(i)(r)}return n(e)}))},tf=function(t,n,e,o){var i,u,a,c=Dt(o,(function(t,n){return o=t,i=!1,{name:r(e=n),required:function(){return o.fold((function(t,n){return t}),(function(t,n){return t}))},used:function(){return i},replace:function(){if(i)throw new Error("Trying to use the same placeholder more than once: "+e);return i=!0,o}};var e,o,i})),s=(i=t,u=n,a=c,Z(e,(function(t){return Zl(i,u,t,a)})));return Et(c,(function(e){if(!1===e.used()&&e.required())throw new Error("Placeholder: "+e.name()+" was not found in components list\nNamespace: "+t.getOr("none")+"\nComponents: "+JSON.stringify(n.components,null,2))})),s},nf=Jl.single,ef=Jl.multiple,of=r(Kl),rf=Ht([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),uf=oe("factory",{sketch:i}),af=oe("schema",[]),cf=Un("name"),sf=xn("pname","pname",qt((function(t){return"<alloy."+ii(t.name)+">"})),In()),lf=de("schema",(function(){return[$n("preprocess")]})),ff=oe("defaults",r({})),df=oe("overrides",r({})),mf=mn([uf,af,cf,sf,ff,df]),gf=mn([uf,af,cf,ff,df]),pf=mn([uf,af,cf,sf,ff,df]),hf=mn([uf,lf,cf,Un("unit"),sf,ff,df]),vf=function(t){return t.fold(C.some,C.none,C.some,C.some)},bf=function(t){var n=function(t){return t.name};return t.fold(n,n,n,n)},yf=function(t,n){return function(e){var o=Bn("Converting part type",n,e);return t(o)}},xf=yf(rf.required,mf),wf=yf(rf.external,gf),Sf=yf(rf.optional,pf),kf=yf(rf.group,hf),Cf=r("entirety"),Of=Object.freeze({__proto__:null,required:xf,external:wf,optional:Sf,group:kf,asNamedPart:vf,name:bf,asCommon:function(t){return t.fold(i,i,i,i)},original:Cf}),_f=function(t,n,e,o){return Nt(n.defaults(t,e,o),e,{uid:t.partUids[n.name]},n.overrides(t,e,o))},Tf=function(t,n){var e={};return G(n,(function(n){vf(n).each((function(n){var o=Ef(t,n.pname);e[n.name]=function(e){var r=Bn("Part: "+n.name+" in "+t,mn(n.schema),e);return d(d({},o),{config:e,validated:r})}}))})),e},Ef=function(t,n){return{uiType:of(),owner:t,name:n}},Df=function(t,n,e){return{uiType:of(),owner:t,name:n,config:e,validated:{}}},Bf=function(t){return Z(t,(function(t){return t.fold(C.none,C.some,C.none,C.none).map((function(t){return qn(t.name,t.schema.concat([xa(Cf())]))})).toArray()}))},Af=function(t){return W(t,bf)},Mf=function(t,n,e){return o=n,i={},u={},G(e,(function(t){t.fold((function(t){i[t.pname]=nf(!0,(function(n,e,o){return t.factory.sketch(_f(n,t,e,o))}))}),(function(t){var n=o.parts[t.name];u[t.name]=r(t.factory.sketch(_f(o,t,n[Cf()]),n))}),(function(t){i[t.pname]=nf(!1,(function(n,e,o){return t.factory.sketch(_f(n,t,e,o))}))}),(function(t){i[t.pname]=ef(!0,(function(n,e,o){var r=n[t.name];return W(r,(function(e){return t.factory.sketch(Nt(t.defaults(n,e,o),e,t.overrides(n,e)))}))}))}))})),{internals:r(i),externals:r(u)};var o,i,u},Ff=function(t,n,e){return tf(C.some(t),n,n.components,e)},If=function(t,n,e){var o=n.partUids[e];return t.getSystem().getByUid(o).toOptional()},Rf=function(t,n,e){return If(t,n,e).getOrDie("Could not find part: "+e)},Pf=function(t,n,e){var o={},i=n.partUids,u=t.getSystem();return G(e,(function(t){o[t]=r(u.getByUid(i[t]))})),o},Vf=function(t,n){var e=t.getSystem();return Dt(n.partUids,(function(t,n){return r(e.getByUid(t))}))},Hf=function(t){return _t(t.partUids)},Lf=function(t,n,e){var o={},i=n.partUids,u=t.getSystem();return G(e,(function(t){o[t]=r(u.getByUid(i[t]).getOrDie())})),o},zf=function(t,n){var e=Af(n);return Zt(W(e,(function(n){return{key:n,value:t+"-"+n}})))},Nf=function(t){return xn("partUids","partUids",Kt((function(n){return zf(n.uid,t)})),In())},jf=Object.freeze({__proto__:null,generate:Tf,generateOne:Df,schemas:Bf,names:Af,substitutes:Mf,components:Ff,defaultUids:zf,defaultUidsSchema:Nf,getAllParts:Vf,getAllPartNames:Hf,getPart:If,getPartOrDie:Rf,getParts:Pf,getPartsOrDie:Lf}),Uf=function(t,n,e,o,r){var i,u,a=(u=r,(0<(i=o).length?[qn("parts",i)]:[]).concat([Un("uid"),oe("dom",{}),oe("components",[]),xa("originalSpec"),oe("debug.sketcher",{})]).concat(u));return Bn(t+" [SpecSchema]",dn(a.concat(n)),e)},Wf=function(t,n,e,o,r){var i=Gf(r),u=Bf(e),a=Nf(e),c=Uf(t,n,i,u,[a]),s=Mf(0,c,e);return o(c,Ff(t,c,s.internals()),i,s.externals())},Gf=function(t){return Pt(t,"uid")?t:d(d({},t),{uid:di("uid")})},Xf=dn([Un("name"),Un("factory"),Un("configFields"),oe("apis",{}),oe("extraApis",{})]),Yf=dn([Un("name"),Un("factory"),Un("configFields"),Un("partFields"),oe("apis",{}),oe("extraApis",{})]),qf=function(t){var n=Bn("Sketcher for "+t.name,Xf,t),e=Dt(n.apis,xi),o=Dt(n.extraApis,vi);return d(d({name:n.name,configFields:n.configFields,sketch:function(t){return e=n.name,o=n.configFields,r=n.factory,i=Gf(t),r(Uf(e,o,i,[],[]),i);var e,o,r,i}},e),o)},Kf=function(t){var n=Bn("Sketcher for "+t.name,Yf,t),e=Tf(n.name,n.partFields),o=Dt(n.apis,xi),r=Dt(n.extraApis,vi);return d(d({name:n.name,partFields:n.partFields,configFields:n.configFields,sketch:function(t){return Wf(n.name,n.configFields,n.partFields,n.factory,t)},parts:e},o),r)},Jf=function(t){for(var n=[],e=function(t){n.push(t)},o=0;o<t.length;o++)t[o].each(e);return n},$f=function(t,n){return t?C.some(n):C.none()},Qf=function(t){return"input"===pr(t)&&"radio"!==Jr(t,"type")||"textarea"===pr(t)},Zf=Object.freeze({__proto__:null,getCurrent:function(t,n,e){return n.find(t)}}),td=[Un("find")],nd=cc({fields:td,name:"composing",apis:Zf}),ed=function(t,n,e,o){var r=Ts(t.element,"."+n.highlightClass);G(r,(function(e){N(o,(function(t){return t.element===e}))||(Li(e,n.highlightClass),t.getSystem().getByDom(e).each((function(e){n.onDehighlight(t,e),Ko(e,qo())})))}))},od=function(t,n,e,o){ed(t,n,0,[o]),rd(t,n,e,o)||(Vi(o.element,n.highlightClass),n.onHighlight(t,o),Ko(o,Yo()))},rd=function(t,n,e,o){return zi(o.element,n.highlightClass)},id=function(t,n,e,o){var r=Ts(t.element,"."+n.itemClass);return C.from(r[o]).fold((function(){return ft.error(new Error("No element found with index "+o))}),t.getSystem().getByDom)},ud=function(t,n,e){return Ju(t.element,"."+n.itemClass).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))},ad=function(t,n,e){var o=Ts(t.element,"."+n.itemClass);return(0<o.length?C.some(o[o.length-1]):C.none()).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))},cd=function(t,n,e,o){var r=Ts(t.element,"."+n.itemClass);return $(r,(function(t){return zi(t,n.highlightClass)})).bind((function(n){var e=_c(n,o,0,r.length-1);return t.getSystem().getByDom(r[e]).toOptional()}))},sd=function(t,n,e){var o=Ts(t.element,"."+n.itemClass);return Jf(W(o,(function(n){return t.getSystem().getByDom(n).toOptional()})))},ld=Object.freeze({__proto__:null,dehighlightAll:function(t,n,e){return ed(t,n,0,[])},dehighlight:function(t,n,e,o){rd(t,n,e,o)&&(Li(o.element,n.highlightClass),n.onDehighlight(t,o),Ko(o,qo()))},highlight:od,highlightFirst:function(t,n,e){ud(t,n).each((function(o){od(t,n,e,o)}))},highlightLast:function(t,n,e){ad(t,n).each((function(o){od(t,n,e,o)}))},highlightAt:function(t,n,e,o){id(t,n,e,o).fold((function(t){throw t}),(function(o){od(t,n,e,o)}))},highlightBy:function(t,n,e,o){var r=sd(t,n);J(r,o).each((function(o){od(t,n,e,o)}))},isHighlighted:rd,getHighlighted:function(t,n,e){return Ju(t.element,"."+n.highlightClass).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))},getFirst:ud,getLast:ad,getPrevious:function(t,n,e){return cd(t,n,0,-1)},getNext:function(t,n,e){return cd(t,n,0,1)},getCandidates:sd}),fd=[Un("highlightClass"),Un("itemClass"),pa("onHighlight"),pa("onDehighlight")],dd=cc({fields:fd,name:"highlighting",apis:ld}),md=[8],gd=[9],pd=[13],hd=[27],vd=[32],bd=[37],yd=[38],xd=[39],wd=[40],Sd=function(t,n,e){var o=nt(t.slice(0,n)),r=nt(t.slice(n+1));return J(o.concat(r),e)},kd=function(t,n,e){var o=nt(t.slice(0,n));return J(o,e)},Cd=function(t,n,e){var o=t.slice(0,n),r=t.slice(n+1);return J(r.concat(o),e)},Od=function(t,n,e){var o=t.slice(n+1);return J(o,e)},_d=function(t){return function(n){var e=n.raw;return z(t,e.which)}},Td=function(t){return function(n){return tt(t,(function(t){return t(n)}))}},Ed=function(t){return!0===t.raw.shiftKey},Dd=function(t){return!0===t.raw.ctrlKey},Bd=a(Ed),Ad=function(t,n){return{matches:t,classification:n}},Md=function(t,n,e){n.exists((function(t){return e.exists((function(n){return Ye(n,t)}))}))||Jo(t,Uo(),{prevFocus:n,newFocus:e})},Fd=function(){var t=function(t){return hc(t.element)};return{get:t,set:function(n,e){var o=t(n);n.getSystem().triggerFocus(e,n.element);var r=t(n);Md(n,o,r)}}},Id=function(){var t=function(t){return dd.getHighlighted(t).map((function(t){return t.element}))};return{get:t,set:function(n,o){var r=t(n);n.getSystem().getByDom(o).fold(e,(function(t){dd.highlight(n,t)}));var i=t(n);Md(n,r,i)}}};(Yc=Xc=Xc||{}).OnFocusMode="onFocus",Yc.OnEnterOrSpaceMode="onEnterOrSpace",Yc.OnApiMode="onApi";var Rd,Pd=function(t,n,e,o,r){var i=function(t,n,e,o,r){var i,u,a=e(t,n,o,r);return i=a,u=n.event,J(i,(function(t){return t.matches(u)})).map((function(t){return t.classification})).bind((function(e){return e(t,n,o,r)}))},u={schema:function(){return t.concat([oe("focusManager",Fd()),re("focusInside","onFocus",_n((function(t){return z(["onFocus","onEnterOrSpace","onApi"],t)?ft.value(t):ft.error("Invalid value for focusInside")}))),ya("handler",u),ya("state",n),ya("sendFocusIn",r)])},processKey:i,toEvents:function(t,n){var u=t.focusInside!==Xc.OnFocusMode?C.none():r(t).map((function(e){return rr(Co(),(function(o,r){e(o,t,n),r.stop()}))})),a=[rr(po(),(function(o,u){i(o,u,e,t,n).fold((function(){var e,i,a;e=o,i=u,a=_d(vd.concat(pd))(i.event),t.focusInside===Xc.OnEnterOrSpaceMode&&a&&Ze(e,i)&&r(t).each((function(o){o(e,t,n),i.stop()}))}),(function(t){u.stop()}))})),rr(ho(),(function(e,r){i(e,r,o,t,n).each((function(t){r.stop()}))}))];return nr(u.toArray().concat(a))}};return u},Vd=function(t){var n=[$n("onEscape"),$n("onEnter"),oe("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),oe("firstTabstop",0),oe("useTabstopAt",l),$n("visibilitySelector")].concat([t]),e=function(t,n){var e=t.visibilitySelector.bind((function(t){return $u(n,t)})).getOr(n);return 0<yu(e)},o=function(t,n,o){var r,i,u;r=n,i=Ts(t.element,r.selector),u=Y(i,(function(t){return e(r,t)})),C.from(u[r.firstTabstop]).each((function(e){n.focusManager.set(t,e)}))},i=function(t,n,o,r,i){return i(n,o,(function(t){return e(n=r,o=t)&&n.useTabstopAt(o);var n,o})).fold((function(){return r.cyclic?C.some(!0):C.none()}),(function(n){return r.focusManager.set(t,n),C.some(!0)}))},a=function(t,n,e,o){var r,a,c=Ts(t.element,e.selector);return r=t,(a=e).focusManager.get(r).bind((function(t){return $u(t,a.selector)})).bind((function(n){return $(c,u(Ye,n)).bind((function(n){return i(t,c,n,e,o)}))}))},c=r([Ad(Td([Ed,_d(gd)]),(function(t,n,e){var o=e.cyclic?Sd:kd;return a(t,0,e,o)})),Ad(_d(gd),(function(t,n,e){var o=e.cyclic?Cd:Od;return a(t,0,e,o)})),Ad(_d(hd),(function(t,n,e){return e.onEscape.bind((function(e){return e(t,n)}))})),Ad(Td([Bd,_d(pd)]),(function(t,n,e){return e.onEnter.bind((function(e){return e(t,n)}))}))]),s=r([]);return Pd(n,wi.init,c,s,(function(){return C.some(o)}))},Hd=Vd(de("cyclic",s)),Ld=Vd(de("cyclic",l)),zd=function(t,n,e){return Qf(e)&&_d(vd)(n.event)?C.none():(Qo(t,e,Eo()),C.some(!0))},Nd=function(t,n){return C.some(!0)},jd=[oe("execute",zd),oe("useSpace",!1),oe("useEnter",!0),oe("useControlEnter",!1),oe("useDown",!1)],Ud=function(t,n,e){return e.execute(t,n,t.element)},Wd=Pd(jd,wi.init,(function(t,n,e,o){var r=e.useSpace&&!Qf(t.element)?vd:[],i=e.useEnter?pd:[],u=e.useDown?wd:[],a=r.concat(i).concat(u);return[Ad(_d(a),Ud)].concat(e.useControlEnter?[Ad(Td([Dd,_d(pd)]),Ud)]:[])}),(function(t,n,e,o){return e.useSpace&&!Qf(t.element)?[Ad(_d(vd),Nd)]:[]}),(function(){return C.none()})),Gd=function(){var t=me(C.none());return Si({readState:function(){return t.get().map((function(t){return{numRows:String(t.numRows),numColumns:String(t.numColumns)}})).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(n,e){t.set(C.some({numRows:n,numColumns:e}))},getNumRows:function(){return t.get().map((function(t){return t.numRows}))},getNumColumns:function(){return t.get().map((function(t){return t.numColumns}))}})},Xd=Object.freeze({__proto__:null,flatgrid:Gd,init:function(t){return t.state(t)}}),Yd=function(t){return function(n,e,o,r){var i=t(n.element);return $d(i,n,e,o,r)}},qd=function(t,n){var e=Nc(t,n);return Yd(e)},Kd=function(t,n){var e=Nc(n,t);return Yd(e)},Jd=function(t){return function(n,e,o,r){return $d(t,n,e,o,r)}},$d=function(t,n,e,o,r){return o.focusManager.get(n).bind((function(e){return t(n.element,e,o,r)})).map((function(t){return o.focusManager.set(n,t),!0}))},Qd=Jd,Zd=Jd,tm=Jd,nm=function(t){return!((n=t.dom).offsetWidth<=0&&n.offsetHeight<=0);var n},em=function(t,n,e){var o,r=Ts(t,e),i=Y(r,nm);return $(o=i,(function(t){return Ye(t,n)})).map((function(t){return{index:t,candidates:o}}))},om=function(t,n){return $(t,(function(t){return Ye(n,t)}))},rm=function(t,n,e,o){return o(Math.floor(n/e),n%e).bind((function(n){var o=n.row*e+n.column;return 0<=o&&o<t.length?C.some(t[o]):C.none()}))},im=function(t,n,e,o,r){return rm(t,n,o,(function(n,i){var u=n===e-1?t.length-n*o:o,a=_c(i,r,0,u-1);return C.some({row:n,column:a})}))},um=function(t,n,e,o,r){return rm(t,n,o,(function(n,i){var u=_c(n,r,0,e-1),a=u===e-1?t.length-u*o:o,c=Tc(i,0,a-1);return C.some({row:u,column:c})}))},am=[Un("selector"),oe("execute",zd),ha("onEscape"),oe("captureTab",!1),wa()],cm=function(t,n,e){Ju(t.element,n.selector).each((function(e){n.focusManager.set(t,e)}))},sm=function(t){return function(n,e,o,r){return em(n,e,o.selector).bind((function(n){return t(n.candidates,n.index,r.getNumRows().getOr(o.initSize.numRows),r.getNumColumns().getOr(o.initSize.numColumns))}))}},lm=function(t,n,e){return e.captureTab?C.some(!0):C.none()},fm=sm((function(t,n,e,o){return im(t,n,e,o,-1)})),dm=sm((function(t,n,e,o){return im(t,n,e,o,1)})),mm=sm((function(t,n,e,o){return um(t,n,e,o,-1)})),gm=sm((function(t,n,e,o){return um(t,n,e,o,1)})),pm=r([Ad(_d(bd),qd(fm,dm)),Ad(_d(xd),Kd(fm,dm)),Ad(_d(yd),Qd(mm)),Ad(_d(wd),Zd(gm)),Ad(Td([Ed,_d(gd)]),lm),Ad(Td([Bd,_d(gd)]),lm),Ad(_d(hd),(function(t,n,e){return e.onEscape(t,n)})),Ad(_d(vd.concat(pd)),(function(t,n,e,o){return r=t,(i=e).focusManager.get(r).bind((function(t){return $u(t,i.selector)})).bind((function(o){return e.execute(t,n,o)}));var r,i}))]),hm=r([Ad(_d(vd),Nd)]),vm=Pd(am,Gd,pm,hm,(function(){return C.some(cm)})),bm=function(t,n,e,o){var r=function t(n,e,r){var i,u=_c(e,o,0,r.length-1);return u===n?C.none():(i=r[u],"button"===pr(i)&&"disabled"===Jr(i,"disabled")?t(n,u,r):C.from(r[u]))};return em(t,e,n).bind((function(t){var n=t.index,e=t.candidates;return r(n,n,e)}))},ym=[Un("selector"),oe("getInitial",C.none),oe("execute",zd),ha("onEscape"),oe("executeOnMove",!1),oe("allowVertical",!0)],xm=function(t,n,e){return o=t,(r=e).focusManager.get(o).bind((function(t){return $u(t,r.selector)})).bind((function(o){return e.execute(t,n,o)}));var o,r},wm=function(t,n,e){n.getInitial(t).orThunk((function(){return Ju(t.element,n.selector)})).each((function(e){n.focusManager.set(t,e)}))},Sm=function(t,n,e){return bm(t,e.selector,n,-1)},km=function(t,n,e){return bm(t,e.selector,n,1)},Cm=function(t){return function(n,e,o,r){return t(n,e,o,r).bind((function(){return o.executeOnMove?xm(n,e,o):C.some(!0)}))}},Om=function(t,n,e){return e.onEscape(t,n)},_m=r([Ad(_d(vd),Nd)]),Tm=Pd(ym,wi.init,(function(t,n,e,o){var r=bd.concat(e.allowVertical?yd:[]),i=xd.concat(e.allowVertical?wd:[]);return[Ad(_d(r),Cm(qd(Sm,km))),Ad(_d(i),Cm(Kd(Sm,km))),Ad(_d(pd),xm),Ad(_d(vd),xm),Ad(_d(hd),Om)]}),_m,(function(){return C.some(wm)})),Em=function(t,n,e){return C.from(t[n]).bind((function(t){return C.from(t[e]).map((function(t){return{rowIndex:n,columnIndex:e,cell:t}}))}))},Dm=function(t,n,e,o){var r=t[n].length,i=_c(e,o,0,r-1);return Em(t,n,i)},Bm=function(t,n,e,o){var r=_c(e,o,0,t.length-1),i=t[r].length,u=Tc(n,0,i-1);return Em(t,r,u)},Am=function(t,n,e,o){var r=t[n].length,i=Tc(e+o,0,r-1);return Em(t,n,i)},Mm=function(t,n,e,o){var r=Tc(e+o,0,t.length-1),i=t[r].length,u=Tc(n,0,i-1);return Em(t,r,u)},Fm=[qn("selectors",[Un("row"),Un("cell")]),oe("cycles",!0),oe("previousSelector",C.none),oe("execute",zd)],Im=function(t,n,e){n.previousSelector(t).orThunk((function(){var e=n.selectors;return Ju(t.element,e.cell)})).each((function(e){n.focusManager.set(t,e)}))},Rm=function(t,n){return function(e,o,r){var i=r.cycles?t:n;return $u(o,r.selectors.row).bind((function(t){var n=Ts(t,r.selectors.cell);return om(n,o).bind((function(n){var o=Ts(e,r.selectors.row);return om(o,t).bind((function(t){var e,u=(e=r,W(o,(function(t){return Ts(t,e.selectors.cell)})));return i(u,t,n).map((function(t){return t.cell}))}))}))}))}},Pm=Rm((function(t,n,e){return Dm(t,n,e,-1)}),(function(t,n,e){return Am(t,n,e,-1)})),Vm=Rm((function(t,n,e){return Dm(t,n,e,1)}),(function(t,n,e){return Am(t,n,e,1)})),Hm=Rm((function(t,n,e){return Bm(t,e,n,-1)}),(function(t,n,e){return Mm(t,e,n,-1)})),Lm=Rm((function(t,n,e){return Bm(t,e,n,1)}),(function(t,n,e){return Mm(t,e,n,1)})),zm=r([Ad(_d(bd),qd(Pm,Vm)),Ad(_d(xd),Kd(Pm,Vm)),Ad(_d(yd),Qd(Hm)),Ad(_d(wd),Zd(Lm)),Ad(_d(vd.concat(pd)),(function(t,n,e){return hc(t.element).bind((function(o){return e.execute(t,n,o)}))}))]),Nm=r([Ad(_d(vd),Nd)]),jm=Pd(Fm,wi.init,zm,Nm,(function(){return C.some(Im)})),Um=[Un("selector"),oe("execute",zd),oe("moveOnTab",!1)],Wm=function(t,n,e){return e.focusManager.get(t).bind((function(o){return e.execute(t,n,o)}))},Gm=function(t,n,e){Ju(t.element,n.selector).each((function(e){n.focusManager.set(t,e)}))},Xm=function(t,n,e){return bm(t,e.selector,n,-1)},Ym=function(t,n,e){return bm(t,e.selector,n,1)},qm=r([Ad(_d(yd),tm(Xm)),Ad(_d(wd),tm(Ym)),Ad(Td([Ed,_d(gd)]),(function(t,n,e,o){return e.moveOnTab?tm(Xm)(t,n,e,o):C.none()})),Ad(Td([Bd,_d(gd)]),(function(t,n,e,o){return e.moveOnTab?tm(Ym)(t,n,e,o):C.none()})),Ad(_d(pd),Wm),Ad(_d(vd),Wm)]),Km=r([Ad(_d(vd),Nd)]),Jm=Pd(Um,wi.init,qm,Km,(function(){return C.some(Gm)})),$m=[ha("onSpace"),ha("onEnter"),ha("onShiftEnter"),ha("onLeft"),ha("onRight"),ha("onTab"),ha("onShiftTab"),ha("onUp"),ha("onDown"),ha("onEscape"),oe("stopSpaceKeyup",!1),$n("focusIn")],Qm=Pd($m,wi.init,(function(t,n,e){return[Ad(_d(vd),e.onSpace),Ad(Td([Bd,_d(pd)]),e.onEnter),Ad(Td([Ed,_d(pd)]),e.onShiftEnter),Ad(Td([Ed,_d(gd)]),e.onShiftTab),Ad(Td([Bd,_d(gd)]),e.onTab),Ad(_d(yd),e.onUp),Ad(_d(wd),e.onDown),Ad(_d(bd),e.onLeft),Ad(_d(xd),e.onRight),Ad(_d(vd),e.onSpace),Ad(_d(hd),e.onEscape)]}),(function(t,n,e){return e.stopSpaceKeyup?[Ad(_d(vd),Nd)]:[]}),(function(t){return t.focusIn})),Zm=Hd.schema(),tg=Ld.schema(),ng=Tm.schema(),eg=vm.schema(),og=jm.schema(),rg=Wd.schema(),ig=Jm.schema(),ug=Qm.schema(),ag=lc({branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:Zm,cyclic:tg,flow:ng,flatgrid:eg,matrix:og,execution:rg,menu:ig,special:ug}),name:"keying",active:{events:function(t,n){return t.handler.toEvents(t,n)}},apis:{focusIn:function(t,n,e){n.sendFocusIn(n).fold((function(){t.getSystem().triggerFocus(t.element,t.element)}),(function(o){o(t,n,e)}))},setGridSize:function(t,n,e,o,r){Vt(e,"setGridSize")?e.setGridSize(o,r):console.error("Layout does not support setGridSize")}},state:Xd}),cg=function(t,n,e,o){var r=t.getSystem().build(o);al(t,r,e)},sg=function(t,n,e,o){var r=lg(t);J(r,(function(t){return Ye(o.element,t.element)})).each(sl)},lg=function(t,n){return t.components()},fg=function(t,n,e,o,r){var i=lg(t);return C.from(i[o]).map((function(n){return sg(t,0,0,n),r.each((function(n){cg(t,0,(function(t,n){var e,r;r=n,Dr(e=t,o).fold((function(){Nr(e,r)}),(function(t){Hr(t,r)}))}),n)})),n}))},dg=cc({fields:[],name:"replacing",apis:Object.freeze({__proto__:null,append:function(t,n,e,o){cg(t,0,Nr,o)},prepend:function(t,n,e,o){cg(t,0,zr,o)},remove:sg,replaceAt:fg,replaceBy:function(t,n,e,o,r){var i=lg(t);return $(i,o).bind((function(n){return fg(t,0,0,n,r)}))},set:function(t,n,e,o){vc((function(){var n=W(o,t.getSystem().build);il(t,n)}),t.element)},contents:lg})}),mg=function(t,n){var e,o;return{key:t,value:{config:{},me:(e=t,o=nr(n),cc({fields:[Un("enabled")],name:e,active:{events:r(o)}})),configAsRaw:r({}),initialConfig:{},state:wi}}},gg=function(t,n){n.ignore||(gc(t.element),n.onFocus(t))},pg=Object.freeze({__proto__:null,focus:gg,blur:function(t,n){n.ignore||t.element.dom.blur()},isFocused:function(t){return n=t.element,e=Fr(n).dom,n.dom===e.activeElement;var n,e}}),hg=Object.freeze({__proto__:null,exhibit:function(t,n){var e=n.ignore?{}:{attributes:{tabindex:"-1"}};return Ci(e)},events:function(t){return nr([rr(Co(),(function(n,e){gg(n,t),e.stop()}))].concat(t.stopMousedown?[rr(ao(),(function(t,n){n.event.prevent()}))]:[]))}}),vg=[pa("onFocus"),oe("stopMousedown",!1),oe("ignore",!1)],bg=cc({fields:vg,name:"focusing",active:hg,apis:pg}),yg=function(t,n,e){var o=n.aria;o.update(t,o,e.get())},xg=function(t,n,e){n.toggleClass.each((function(n){(e.get()?Vi:Li)(t.element,n)}))},wg=function(t,n,e){Cg(t,n,e,!e.get())},Sg=function(t,n,e){e.set(!0),xg(t,n,e),yg(t,n,e)},kg=function(t,n,e){e.set(!1),xg(t,n,e),yg(t,n,e)},Cg=function(t,n,e,o){(o?Sg:kg)(t,n,e)},Og=function(t,n,e){Cg(t,n,e,n.selected)},_g=Object.freeze({__proto__:null,onLoad:Og,toggle:wg,isOn:function(t,n,e){return e.get()},on:Sg,off:kg,set:Cg}),Tg=Object.freeze({__proto__:null,exhibit:function(){return Ci({})},events:function(t,n){var e,o,r,i=(e=t,o=n,r=wg,gr((function(t){r(t,e,o)}))),u=nc(t,n,Og);return nr(Q([t.toggleOnExecute?[i]:[],[u]]))}}),Eg=function(t,n,e){Kr(t.element,"aria-expanded",e)},Dg=[oe("selected",!1),$n("toggleClass"),oe("toggleOnExecute",!0),re("aria",{mode:"none"},Fn("mode",{pressed:[oe("syncWithExpanded",!1),ya("update",(function(t,n,e){Kr(t.element,"aria-pressed",e),n.syncWithExpanded&&Eg(t,n,e)}))],checked:[ya("update",(function(t,n,e){Kr(t.element,"aria-checked",e)}))],expanded:[ya("update",Eg)],selected:[ya("update",(function(t,n,e){Kr(t.element,"aria-selected",e)}))],none:[ya("update",e)]}))],Bg=cc({fields:Dg,name:"toggling",active:Tg,apis:_g,state:(Rd=!1,{init:function(){var t=me(Rd);return{get:function(){return t.get()},set:function(n){return t.set(n)},clear:function(){return t.set(Rd)},readState:function(){return t.get()}}}})}),Ag=function(){var t=function(t,n){n.stop(),$o(t)};return[rr(yo(),t),rr(Bo(),t),sr(oo()),sr(ao())]},Mg=function(t){return nr(Q([t.map((function(t){return gr((function(n,e){t(n),e.stop()}))})).toArray(),Ag()]))},Fg="alloy.item-hover",Ig="alloy.item-focus",Rg=function(t){(hc(t.element).isNone()||bg.isFocused(t))&&(bg.isFocused(t)||bg.focus(t),Jo(t,Fg,{item:t}))},Pg=function(t){Jo(t,Ig,{item:t})},Vg=r(Fg),Hg=r(Ig),Lg=[Un("data"),Un("components"),Un("dom"),oe("hasSubmenu",!1),$n("toggling"),Yl("itemBehaviours",[Bg,bg,ag,Ul]),oe("ignoreFocus",!1),oe("domModification",{}),ya("builder",(function(t){return{dom:t.dom,domModification:d(d({},t.domModification),{attributes:d(d(d({role:t.toggling.isSome()?"menuitemcheckbox":"menuitem"},t.domModification.attributes),{"aria-haspopup":t.hasSubmenu}),t.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:ql(t.itemBehaviours,[t.toggling.fold(Bg.revoke,(function(t){return Bg.config(d({aria:{mode:"checked"}},t))})),bg.config({ignore:t.ignoreFocus,stopMousedown:t.ignoreFocus,onFocus:function(t){Pg(t)}}),ag.config({mode:"execution"}),Ul.config({store:{mode:"memory",initialValue:t.data}}),mg("item-type-events",g(Ag(),[rr(fo(),Rg),rr(Do(),bg.focus)]))]),components:t.components,eventOrder:t.eventOrder}})),oe("eventOrder",{})],zg=[Un("dom"),Un("components"),ya("builder",(function(t){return{dom:t.dom,components:t.components,events:nr([(n=Do(),rr(n,(function(t,n){n.stop()})))])};var n}))],Ng=r("item-widget"),jg=r([xf({name:"widget",overrides:function(t){return{behaviours:uc([Ul.config({store:{mode:"manual",getValue:function(n){return t.data},setValue:e}})])}}})]),Ug=[Un("uid"),Un("data"),Un("components"),Un("dom"),oe("autofocus",!1),oe("ignoreFocus",!1),Yl("widgetBehaviours",[Ul,bg,ag]),oe("domModification",{}),Nf(jg()),ya("builder",(function(t){var n=Mf(Ng(),t,jg()),e=Ff(Ng(),t,n.internals()),o=function(n){return If(n,t,"widget").map((function(t){return ag.focusIn(t),t}))},r=function(n,e){return Qf(e.event.target)||t.autofocus&&e.setSource(n.element),C.none()};return{dom:t.dom,components:e,domModification:t.domModification,events:nr([gr((function(t,n){o(t).each((function(t){n.stop()}))})),rr(fo(),Rg),rr(Do(),(function(n,e){t.autofocus?o(n):bg.focus(n)}))]),behaviours:ql(t.widgetBehaviours,[Ul.config({store:{mode:"memory",initialValue:t.data}}),bg.config({ignore:t.ignoreFocus,onFocus:function(t){Pg(t)}}),ag.config({mode:"special",focusIn:t.autofocus?function(t){o(t)}:fc(),onLeft:r,onRight:r,onEscape:function(n,e){return bg.isFocused(n)||t.autofocus?(t.autofocus&&e.setSource(n.element),C.none()):(bg.focus(n),C.some(!0))}})])}}))],Wg=Fn("type",{widget:Ug,item:Lg,separator:zg}),Gg=r([kf({factory:{sketch:function(t){var n=Bn("menu.spec item",Wg,t);return n.builder(n)}},name:"items",unit:"item",defaults:function(t,n){return n.hasOwnProperty("uid")?n:d(d({},n),{uid:di("item")})},overrides:function(t,n){return{type:n.type,ignoreFocus:t.fakeFocus,domModification:{classes:[t.markers.item]}}}})]),Xg=r([Un("value"),Un("items"),Un("dom"),Un("components"),oe("eventOrder",{}),Wl("menuBehaviours",[dd,Ul,nd,ag]),re("movement",{mode:"menu",moveOnTab:!0},Fn("mode",{grid:[wa(),ya("config",(function(t,n){return{mode:"flatgrid",selector:"."+t.markers.item,initSize:{numColumns:n.initSize.numColumns,numRows:n.initSize.numRows},focusManager:t.focusManager}}))],matrix:[ya("config",(function(t,n){return{mode:"matrix",selectors:{row:n.rowSelector,cell:"."+t.markers.item},focusManager:t.focusManager}})),Un("rowSelector")],menu:[oe("moveOnTab",!0),ya("config",(function(t,n){return{mode:"menu",selector:"."+t.markers.item,moveOnTab:n.moveOnTab,focusManager:t.focusManager}}))]})),Wn("markers",la()),oe("fakeFocus",!1),oe("focusManager",Fd()),pa("onHighlight")]),Yg=r("alloy.menu-focus"),qg=Kf({name:"Menu",configFields:Xg(),partFields:Gg(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:Xl(t.menuBehaviours,[dd.config({highlightClass:t.markers.selectedItem,itemClass:t.markers.item,onHighlight:t.onHighlight}),Ul.config({store:{mode:"memory",initialValue:t.value}}),nd.config({find:C.some}),ag.config(t.movement.config(t,t.movement))]),events:nr([rr(Hg(),(function(t,n){var e=n.event;t.getSystem().getByDom(e.target).each((function(e){dd.highlight(t,e),n.stop(),Jo(t,Yg(),{menu:t,item:e})}))})),rr(Vg(),(function(t,n){var e=n.event.item;dd.highlight(t,e)}))]),components:n,eventOrder:t.eventOrder,domModification:{attributes:{role:"menu"}}}}}),Kg=function t(n,e,o,r){return Rt(o,r).bind((function(r){return Rt(n,r).bind((function(r){var i=t(n,e,o,r);return C.some([r].concat(i))}))})).getOr([])},Jg=function(t,n){var e={};Et(t,(function(t,n){G(t,(function(t){e[t]=n}))}));var o=n,r=Bt(n,(function(t,n){return{k:t,v:n}})),i=Dt(r,(function(t,n){return[n].concat(Kg(e,o,r,n))}));return Dt(e,(function(t){return Rt(i,t).getOr([t])}))},$g=function(t){return"prepared"===t.type?C.some(t.menu):C.none()},Qg={init:function(){var t=me({}),n=me({}),e=me({}),o=me(C.none()),r=me({}),i=function(n,e,o){return u(n).bind((function(r){return i=n,Ft(t.get(),(function(t,n){return t===i})).bind((function(t){return e(t).map((function(t){return{triggeredMenu:r,triggeringItem:t,triggeringPath:o}}))}));var i}))},u=function(t){return a(t).bind($g)},a=function(t){return Rt(n.get(),t)},c=function(n){return Rt(t.get(),n)};return{setMenuBuilt:function(t,e){var o;n.set(d(d({},n.get()),((o={})[t]={type:"prepared",menu:e},o)))},setContents:function(i,u,a,c){o.set(C.some(i)),t.set(a),n.set(u),r.set(c);var s=Jg(c,a);e.set(s)},expand:function(n){return Rt(t.get(),n).map((function(t){var o=Rt(e.get(),n).getOr([]);return[t].concat(o)}))},refresh:function(t){return Rt(e.get(),t)},collapse:function(t){return Rt(e.get(),t).bind((function(t){return 1<t.length?C.some(t.slice(1)):C.none()}))},lookupMenu:a,lookupItem:c,otherMenus:function(t){var n=r.get();return et(_t(n),t)},getPrimary:function(){return o.get().bind(u)},getMenus:function(){return n.get()},clear:function(){t.set({}),n.set({}),e.set({}),o.set(C.none())},isClear:function(){return o.get().isNone()},getTriggeringPath:function(t,n){var r=Y(c(t).toArray(),(function(t){return u(t).isSome()}));return Rt(e.get(),t).bind((function(t){var e=nt(r.concat(t));return function(t){for(var n=[],e=0;e<t.length;e++){var o=t[e];if(!o.isSome())return C.none();n.push(o.getOrDie())}return C.some(n)}(Z(e,(function(t,r){return i(t,n,e.slice(0,r+1)).fold((function(){return o.get().is(t)?[]:[C.none()]}),(function(t){return[C.some(t)]}))})))}))}}},extractPreparedMenu:$g},Zg=r("collapse-item"),tp=qf({name:"TieredMenu",configFields:[ba("onExecute"),ba("onEscape"),va("onOpenMenu"),va("onOpenSubmenu"),pa("onRepositionMenu"),pa("onCollapseMenu"),oe("highlightImmediately",!0),qn("data",[Un("primary"),Un("menus"),Un("expansions")]),oe("fakeFocus",!1),pa("onHighlight"),pa("onHover"),da(),Un("dom"),oe("navigateOnHover",!0),oe("stayInDom",!1),Wl("tmenuBehaviours",[ag,dd,nd,dg]),oe("eventOrder",{})],apis:{collapseMenu:function(t,n){t.collapseMenu(n)},highlightPrimary:function(t,n){t.highlightPrimary(n)},repositionMenus:function(t,n){t.repositionMenus(n)}},factory:function(t,n){var o,r,i=me(C.none()),u=Qg.init(),a=function(n){var e,o,r,i=(e=n,o=t.data.primary,r=t.data.menus,Dt(r,(function(n,r){var i=function(){return qg.sketch(d(d({},n),{value:r,markers:t.markers,fakeFocus:t.fakeFocus,onHighlight:t.onHighlight,focusManager:(t.fakeFocus?Id:Fd)()}))};return r===o?{type:"prepared",menu:e.getSystem().build(i())}:{type:"notbuilt",nbMenu:i}}))),a=s();return u.setContents(t.data.primary,i,t.data.expansions,a),u.getPrimary()},c=function(t){return Ul.getValue(t).value},s=function(n){return Dt(t.data.menus,(function(t,n){return Z(t.items,(function(t){return"separator"===t.type?[]:[t.data.value]}))}))},f=function(t,n){dd.highlight(t,n),dd.getHighlighted(n).orThunk((function(){return dd.getFirst(n)})).each((function(n){Qo(t,n.element,Do())}))},m=function(t,n){return Jf(W(n,(function(n){return t.lookupMenu(n).bind((function(t){return"prepared"===t.type?C.some(t.menu):C.none()}))})))},g=function(n,e,o){var r=m(e,e.otherMenus(o));G(r,(function(e){ji(e.element,[t.markers.backgroundMenu]),t.stayInDom||dg.remove(n,e)}))},p=function(n,e){var o,r=(o=n,i.get().getOrThunk((function(){var n={},e=Ts(o.element,"."+t.markers.item),r=Y(e,(function(t){return"true"===Jr(t,"aria-haspopup")}));return G(r,(function(t){o.getSystem().getByDom(t).each((function(t){var e=c(t);n[e]=t}))})),i.set(C.some(n)),n})));Et(r,(function(t,n){var o=z(e,n);Kr(t.element,"aria-expanded",o)}))},h=function(n,e,o){return C.from(o[0]).bind((function(r){return e.lookupMenu(r).bind((function(r){if("notbuilt"===r.type)return C.none();var i=r.menu,u=m(e,o.slice(1));return G(u,(function(n){Vi(n.element,t.markers.backgroundMenu)})),Wi(i.element)||dg.append(n,hu(i)),ji(i.element,[t.markers.backgroundMenu]),f(n,i),g(n,e,o),C.some(i)}))}))};(r=o=o||{})[r.HighlightSubmenu=0]="HighlightSubmenu",r[r.HighlightParent=1]="HighlightParent";var v=function(n,e,r){void 0===r&&(r=o.HighlightSubmenu);var i=c(e);return u.expand(i).bind((function(i){return p(n,i),C.from(i[0]).bind((function(a){return u.lookupMenu(a).bind((function(c){var s=function(t,n,e){if("notbuilt"!==e.type)return e.menu;var o=t.getSystem().build(e.nbMenu());return u.setMenuBuilt(n,o),o}(n,a,c);return Wi(s.element)||dg.append(n,hu(s)),t.onOpenSubmenu(n,e,s,nt(i)),r===o.HighlightSubmenu?(dd.highlightFirst(s),h(n,u,i)):(dd.dehighlightAll(s),C.some(e))}))}))}))},b=function(n,e){var o=c(e);return u.collapse(o).bind((function(o){return p(n,o),h(n,u,o).map((function(o){return t.onCollapseMenu(n,e,o),o}))}))},y=function(n){return function(e,o){return $u(o.getSource(),"."+t.markers.item).bind((function(t){return e.getSystem().getByDom(t).toOptional().bind((function(t){return n(e,t).map(l)}))}))}},x=nr([rr(Yg(),(function(t,n){var e=n.event.item;u.lookupItem(c(e)).each((function(){var e=n.event.menu;dd.highlight(t,e);var o=c(n.event.item);u.refresh(o).each((function(n){return g(t,u,n)}))}))})),gr((function(n,r){var i=r.event.target;n.getSystem().getByDom(i).each((function(r){0===c(r).indexOf("collapse-item")&&b(n,r),v(n,r,o.HighlightSubmenu).fold((function(){t.onExecute(n,r)}),e)}))})),fr((function(n,e){a(n).each((function(e){dg.append(n,hu(e)),t.onOpenMenu(n,e),t.highlightImmediately&&f(n,e)}))}))].concat(t.navigateOnHover?[rr(Vg(),(function(n,e){var r,i,a=e.event.item;r=n,i=c(a),u.refresh(i).bind((function(t){return p(r,t),h(r,u,t)})),v(n,a,o.HighlightParent),t.onHover(n,a)}))]:[])),w=function(t){return dd.getHighlighted(t).bind(dd.getHighlighted)},S={collapseMenu:function(t){w(t).each((function(n){b(t,n)}))},highlightPrimary:function(t){u.getPrimary().each((function(n){f(t,n)}))},repositionMenus:function(n){u.getPrimary().bind((function(t){return w(n).bind((function(t){var n=c(t),e=It(u.getMenus()),o=Jf(W(e,Qg.extractPreparedMenu));return u.getTriggeringPath(n,(function(t){return n=t,ct(o,(function(t){if(!t.getSystem().isConnected())return C.none();var e=dd.getCandidates(t);return J(e,(function(t){return c(t)===n}))}));var n}))})).map((function(n){return{primary:t,triggeringPath:n}}))})).fold((function(){var e;e=n,C.from(e.components()[0]).filter((function(t){return"menu"===Jr(t.element,"role")})).each((function(e){t.onRepositionMenu(n,e,[])}))}),(function(e){var o=e.primary,r=e.triggeringPath;t.onRepositionMenu(n,o,r)}))}};return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:Xl(t.tmenuBehaviours,[ag.config({mode:"special",onRight:y((function(t,n){return Qf(n.element)?C.none():v(t,n,o.HighlightSubmenu)})),onLeft:y((function(t,n){return Qf(n.element)?C.none():b(t,n)})),onEscape:y((function(n,e){return b(n,e).orThunk((function(){return t.onEscape(n,e).map((function(){return n}))}))})),focusIn:function(t,n){u.getPrimary().each((function(n){Qo(t,n.element,Do())}))}}),dd.config({highlightClass:t.markers.selectedMenu,itemClass:t.markers.menu}),nd.config({find:function(t){return dd.getHighlighted(t)}}),dg.config({})]),eventOrder:t.eventOrder,apis:S,events:x}},extraApis:{tieredData:function(t,n,e){return{primary:t,menus:n,expansions:e}},singleData:function(t,n){return{primary:t,menus:Qt(t,n),expansions:{}}},collapseItem:function(t){return{value:ii(Zg()),meta:{text:t}}}}}),np=qf({name:"InlineView",configFields:[Un("lazySink"),pa("onShow"),pa("onHide"),ne("onEscape"),Wl("inlineBehaviours",[kl,Ul,dc]),ee("fireDismissalEventInstead",[oe("event",No())]),ee("fireRepositionEventInstead",[oe("event",jo())]),oe("getRelated",C.none),oe("isExtraPart",s),oe("eventOrder",C.none)],factory:function(t,n){var e=function(t,n,e,r){o(t,n,e,(function(){return r.map(zu)}))},o=function(n,e,o,r){var i=t.lazySink(n).getOrDie();kl.openWhileCloaked(n,o,(function(){return nl.positionWithinBounds(i,e,n,r())})),Ul.setValue(n,C.some({mode:"position",anchor:e,getBounds:r}))},r=function(n,e,o,r){var i,u,a,c,s,l,f,m,g=(i=t,u=n,a=e,s=r,l=function(){return i.lazySink(u)},f="horizontal"===(c=o).type?{layouts:{onLtr:$a,onRtl:Qa}}:{},m=function(t){return 2===t.length?f:{}},tp.sketch({dom:{tag:"div"},data:c.data,markers:c.menu.markers,highlightImmediately:c.menu.highlightImmediately,onEscape:function(){return kl.close(u),i.onEscape.map((function(t){return t(u)})),C.some(!0)},onExecute:function(){return C.some(!0)},onOpenMenu:function(t,n){nl.positionWithinBounds(l().getOrDie(),a,n,s())},onOpenSubmenu:function(t,n,e,o){var r=l().getOrDie();nl.position(r,d({anchor:"submenu",item:n},m(o)),e)},onRepositionMenu:function(t,n,e){var o=l().getOrDie();nl.positionWithinBounds(o,a,n,s()),G(e,(function(t){var n=m(t.triggeringPath);nl.position(o,d({anchor:"submenu",item:t.triggeringItem},n),t.triggeredMenu)}))}}));kl.open(n,g),Ul.setValue(n,C.some({mode:"menu",menu:g}))},i=function(n){kl.isOpen(n)&&Ul.getValue(n).each((function(e){switch(e.mode){case"menu":kl.getState(n).each((function(t){tp.repositionMenus(t)}));break;case"position":var o=t.lazySink(n).getOrDie();nl.positionWithinBounds(o,e.anchor,n,e.getBounds())}}))},u={setContent:function(t,n){kl.setContent(t,n)},showAt:function(t,n,o){e(t,n,o,C.none())},showWithin:e,showWithinBounds:o,showMenuAt:function(t,n,e){r(t,n,e,(function(){return C.none()}))},showMenuWithinBounds:r,hide:function(t){kl.isOpen(t)&&(Ul.setValue(t,C.none()),kl.close(t))},getContent:function(t){return kl.getState(t)},reposition:i,isOpen:kl.isOpen};return{uid:t.uid,dom:t.dom,behaviours:Xl(t.inlineBehaviours,[kl.config({isPartOf:function(n,e,o){return ta(e,o)||(r=n,i=o,t.getRelated(r).exists((function(t){return ta(t,i)})));var r,i},getAttachPoint:function(n){return t.lazySink(n).getOrDie()},onOpen:function(n){t.onShow(n)},onClose:function(n){t.onHide(n)}}),Ul.config({store:{mode:"memory",initialValue:C.none()}}),dc.config({channels:d(d({},El(d({isExtraPart:n.isExtraPart},t.fireDismissalEventInstead.map((function(t){return{fireEventInstead:{event:t.event}}})).getOr({})))),Bl(d(d({},t.fireRepositionEventInstead.map((function(t){return{fireEventInstead:{event:t.event}}})).getOr({})),{doReposition:i})))})]),eventOrder:t.eventOrder,apis:u}},apis:{showAt:function(t,n,e,o){t.showAt(n,e,o)},showWithin:function(t,n,e,o,r){t.showWithin(n,e,o,r)},showWithinBounds:function(t,n,e,o,r){t.showWithinBounds(n,e,o,r)},showMenuAt:function(t,n,e,o){t.showMenuAt(n,e,o)},showMenuWithinBounds:function(t,n,e,o,r){t.showMenuWithinBounds(n,e,o,r)},hide:function(t,n){t.hide(n)},isOpen:function(t,n){return t.isOpen(n)},getContent:function(t,n){return t.getContent(n)},setContent:function(t,n,e){t.setContent(n,e)},reposition:function(t,n){t.reposition(n)}}}),ep=function(t){return t.x},op=function(t,n){return t.x+t.width/2-n.width/2},rp=function(t,n){return t.x+t.width-n.width},ip=function(t){return t.y},up=function(t,n){return t.y+t.height-n.height},ap=function(t,n,e){return Sa(rp(t,n),up(t,n),e.innerSoutheast(),Ta(),Ma(t,{right:0,bottom:3}),"layout-inner-se")},cp=function(t,n,e){return Sa(ep(t),up(t,n),e.innerSouthwest(),_a(),Ma(t,{left:1,bottom:3}),"layout-inner-sw")},sp=function(t,n,e){return Sa(rp(t,n),ip(t),e.innerNortheast(),Oa(),Ma(t,{right:0,top:2}),"layout-inner-ne")},lp=function(t,n,e){return Sa(ep(t),ip(t),e.innerNorthwest(),Ca(),Ma(t,{left:1,top:2}),"layout-inner-nw")},fp=function(t,n,e){return Sa(op(t,n),ip(t),e.innerNorth(),Ea(),Ma(t,{top:2}),"layout-inner-n")},dp=function(t,n,e){return Sa(op(t,n),up(t,n),e.innerSouth(),Da(),Ma(t,{bottom:3}),"layout-inner-s")},mp=tinymce.util.Tools.resolve("tinymce.util.Delay"),gp=qf({name:"Button",factory:function(t){var n=Mg(t.action),e=t.dom.tag,o=function(n){return Rt(t.dom,"attributes").bind((function(t){return Rt(t,n)}))};return{uid:t.uid,dom:t.dom,components:t.components,events:n,behaviours:ql(t.buttonBehaviours,[bg.config({}),ag.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if("button"!==e)return{role:o("role").getOr("button")};var t=o("type").getOr("button"),n=o("role").map((function(t){return{role:t}})).getOr({});return d({type:t},n)}()},eventOrder:t.eventOrder}},configFields:[oe("uid",void 0),Un("dom"),oe("components",[]),Yl("buttonBehaviours",[bg,ag]),$n("action"),$n("role"),oe("eventOrder",{})]}),pp=function(t){var n=void 0!==t.uid&&Vt(t,"uid")?t.uid:di("memento");return{get:function(t){return t.getSystem().getByUid(n).getOrDie()},getOpt:function(t){return t.getSystem().getByUid(n).toOptional()},asSpec:function(){return d(d({},t),{uid:n})}}},hp=function(t){return C.from(t()["temporary-placeholder"]).getOr("!not found!")},vp=function(t,n){return C.from(n()[t.toLowerCase()]).getOrThunk((function(){return hp(n)}))},bp={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},yp=qf({name:"Notification",factory:function(t){var n,e,o=pp({dom:{tag:"p",innerHtml:t.translationProvider(t.text)},behaviours:uc([dg.config({})])}),r=function(t){return{dom:{tag:"div",classes:["tox-bar"],attributes:{style:"width: "+t+"%"}}}},i=function(t){return{dom:{tag:"div",classes:["tox-text"],innerHtml:t+"%"}}},u=pp({dom:{tag:"div",classes:t.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[r(0)]},i(0)],behaviours:uc([dg.config({})])}),a={updateProgress:function(t,n){t.getSystem().isConnected()&&u.getOpt(t).each((function(t){dg.set(t,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[r(n)]},i(n)])}))},updateText:function(t,n){var e;t.getSystem().isConnected()&&(e=o.get(t),dg.set(e,[du(n)]))}},c=Q([t.icon.toArray(),t.level.toArray(),t.level.bind((function(t){return C.from(bp[t])})).toArray()]),s=pp(gp.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:vp("close",t.iconProvider),attributes:{"aria-label":t.translationProvider("Close")}}}],action:function(n){t.onAction(n)}})),l=[{dom:{tag:"div",classes:["tox-notification__icon"],innerHtml:(n=c,e=t.iconProvider,ct(n,(function(t){return C.from(e()[t.toLowerCase()])})).getOrThunk((function(){return hp(e)})))}},{dom:{tag:"div",classes:["tox-notification__body"]},components:[o.asSpec()],behaviours:uc([dg.config({})])}];return{uid:t.uid,dom:{tag:"div",attributes:{role:"alert"},classes:t.level.map((function(t){return["tox-notification","tox-notification--in","tox-notification--"+t]})).getOr(["tox-notification","tox-notification--in"])},behaviours:uc([bg.config({}),mg("notification-events",[rr(mo(),(function(t){s.getOpt(t).each(bg.focus)}))])]),components:l.concat(t.progress?[u.asSpec()]:[]).concat(t.closeButton?[s.asSpec()]:[]),apis:a}},configFields:[$n("level"),Un("progress"),Un("icon"),Un("onAction"),Un("text"),Un("iconProvider"),Un("translationProvider"),ce("closeButton",!0)],apis:{updateProgress:function(t,n,e){t.updateProgress(n,e)},updateText:function(t,n,e){t.updateText(n,e)}}});function xp(t,n,e){var o=n.backstage;return{open:function(t,r){var i=!t.closeButton&&t.timeout&&(0<t.timeout||t.timeout<0),u=function(){r(),np.hide(c)},a=pu(yp.sketch({text:t.text,level:z(["success","error","warning","warn","info"],t.type)?t.type:void 0,progress:!0===t.progressBar,icon:C.from(t.icon),closeButton:!i,onAction:u,iconProvider:o.shared.providers.icons,translationProvider:o.shared.providers.translate})),c=pu(np.sketch(d({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:n.backstage.shared.getSink,fireDismissalEventInstead:{}},o.shared.header.isPositionedAtTop()?{}:{fireRepositionEventInstead:{}})));return e.add(c),0<t.timeout&&mp.setTimeout((function(){u()}),t.timeout),{close:u,moveTo:function(t,n){np.showAt(c,{anchor:"makeshift",x:t,y:n},hu(a))},moveRel:function(t,e){var o,r;"banner"!==e?(o=function(t){switch(t){case"bc-bc":return dp;case"tc-tc":return fp;case"tc-bc":return Ua;case"bc-tc":default:return Wa}}(e),r={anchor:"node",root:Gi(),node:C.some(pe.fromDom(t)),layouts:{onRtl:function(){return[o]},onLtr:function(){return[o]}}},np.showAt(c,r,hu(a))):np.showAt(c,n.backstage.shared.anchors.banner(),hu(a))},text:function(t){yp.updateText(a,t)},settings:t,getEl:function(){return a.element.dom},progressBar:{value:function(t){yp.updateProgress(a,t)}}}},close:function(t){t.close()},reposition:function(t){var n;G(t,(function(t){return t.moveTo(0,0)})),0<(n=t).length&&(it(n).each((function(t){return t.moveRel(null,"banner")})),G(n,(function(t,e){0<e&&t.moveRel(n[e-1].getEl(),"bc-tc")})))},getArgs:function(t){return t.settings}}}var wp,Sp,kp=function(t,n){var e=null;return{cancel:function(){null!==e&&(clearTimeout(e),e=null)},throttle:function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];null!==e&&clearTimeout(e),e=setTimeout((function(){t.apply(null,o),e=null}),n)}}},Cp=tinymce.util.Tools.resolve("tinymce.dom.TextSeeker"),Op=function(t,n,e,o,r){var i=Cp(t,(function(n){return o=n,(e=t).isBlock(o)||z(["BR","IMG","HR","INPUT"],o.nodeName)||"false"===e.getContentEditable(o);var e,o}));return C.from(i.backwards(n,e,o,r))},_p=function(t,n){return Tp(pe.fromDom(t.selection.getNode())).getOrThunk((function(){var e=pe.fromHtml('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',t.getDoc());return Nr(e,pe.fromDom(n.extractContents())),n.insertNode(e.dom),Or(e).each((function(t){return t.dom.normalize()})),_s(e,Os).map((function(n){var e;t.selection.setCursorLocation(n.dom,"img"===pr(e=n)?1:ks(e).fold((function(){return Er(e).length}),(function(t){return t.length})))})),e}))},Tp=function(t){return $u(t,"[data-mce-autocompleter]")},Ep=function(t){return t.toString().replace(/\u00A0/g," ").replace(/\uFEFF/g,"")},Dp=function(t){return""!==t&&-1!=="  \f\n\r\t\v".indexOf(t)},Bp=function(t,n){return t.substring(n.length)},Ap=function(t,n,e,o){if(void 0===o&&(o=0),!(r=n).collapsed||3!==r.startContainer.nodeType)return C.none();var r,i=t.getParent(n.startContainer,t.isBlock)||t.getRoot();return Op(t,n.startContainer,n.startOffset,(function(t,n,o){return function(t,n,e){for(var o=n-1;0<=o;o--){var r=t.charAt(o);if(Dp(r))return C.none();if(r===e)break}return C.some(o)}(o,n,e).getOr(n)}),i).bind((function(t){var r=n.cloneRange();if(r.setStart(t.container,t.offset),r.setEnd(n.endContainer,n.endOffset),r.collapsed)return C.none();var i=Ep(r);return 0!==i.lastIndexOf(e)||Bp(i,e).length<o?C.none():C.some({text:Bp(i,e),range:r,triggerChar:e})}))},Mp=function(t,n,e,o){return void 0===o&&(o=0),Tp(pe.fromDom(n.startContainer)).fold((function(){return Ap(t,n,e,o)}),(function(n){var o=t.createRng();o.selectNode(n.dom);var r=Ep(o);return C.some({range:o,text:Bp(r,e),triggerChar:e})}))},Fp=function(t,n){n.on("keypress compositionend",t.onKeypress.throttle),n.on("remove",t.onKeypress.cancel);var e=function(t,n){Jo(t,po(),{raw:n})};n.on("keydown",(function(n){var o=function(){return t.getView().bind(dd.getHighlighted)};8===n.which&&t.onKeypress.throttle(n),t.isActive()&&(27===n.which&&t.cancelIfNecessary(),t.isMenuOpen()?13===n.which?(o().each($o),n.preventDefault()):40===n.which?(o().fold((function(){t.getView().each(dd.highlightFirst)}),(function(t){e(t,n)})),n.preventDefault(),n.stopImmediatePropagation()):37!==n.which&&38!==n.which&&39!==n.which||o().each((function(t){e(t,n),n.preventDefault(),n.stopImmediatePropagation()})):13!==n.which&&38!==n.which&&40!==n.which||t.cancelIfNecessary())})),n.on("NodeChange",(function(n){t.isActive()&&!t.isProcessingAction()&&Tp(pe.fromDom(n.element)).isNone()&&t.cancelIfNecessary()}))},Ip=tinymce.util.Tools.resolve("tinymce.util.Promise"),Rp=function(t,n){return{container:t,offset:n}},Pp=function t(n){if(3===n.nodeType)return Rp(n,n.data.length);var e=n.childNodes;return 0<e.length?t(e[e.length-1]):Rp(n,e.length)},Vp=function t(n,e){var o=n.childNodes;return 0<o.length&&e<o.length?t(o[e],0):0<o.length&&1===n.nodeType&&o.length===e?Pp(o[o.length-1]):Rp(n,e)},Hp=function(t){return function(n){var e,o,r=Vp(n.startContainer,n.startOffset);return!Op(e=t,(o=r).container,o.offset,(function(t,n){return 0===n?-1:n}),e.getRoot()).filter((function(t){var n=t.container.data.charAt(t.offset-1);return!Dp(n)})).isSome()}},Lp=function(t,n){var e,o,r=n(),i=t.selection.getRng();return e=t.dom,o=i,ct(r.triggerChars,(function(t){return Mp(e,o,t)})).bind((function(e){return zp(t,n,e)}))},zp=function(t,n,e,o){void 0===o&&(o={});var r=n(),i=t.selection.getRng().startContainer.nodeValue,u=Y(r.lookupByChar(e.triggerChar),(function(n){return e.text.length>=n.minChars&&n.matches.getOrThunk((function(){return Hp(t.dom)}))(e.range,i,e.text)}));if(0===u.length)return C.none();var a=Ip.all(W(u,(function(t){return t.fetch(e.text,t.maxResults,o).then((function(n){return{matchText:e.text,items:n,columns:t.columns,onAction:t.onAction,highlightOn:t.highlightOn}}))})));return C.some({lookupData:a,context:e})},Np=mn([Gn("type"),te("text")]),jp=mn([oe("type","autocompleteitem"),oe("active",!1),oe("disabled",!1),oe("meta",{}),Gn("value"),te("text"),te("icon")]),Up=mn([Gn("type"),Gn("ch"),ie("minChars",1),oe("columns",1),ie("maxResults",10),ne("matches"),Yn("fetch"),Yn("onAction"),le("highlightOn",[],Vn)]),Wp=[ce("disabled",!1),te("tooltip"),te("icon"),te("text"),se("onSetup",(function(){return e}))],Gp=mn([Gn("type"),Yn("onAction")].concat(Wp)),Xp=function(t){return En("toolbarbutton",Gp,t)},Yp=[ce("active",!1)].concat(Wp),qp=mn(Yp.concat([Gn("type"),Yn("onAction")])),Kp=function(t){return En("ToggleButton",qp,t)},Jp=[se("predicate",s),ae("scope","node",["node","editor"]),ae("position","selection",["node","selection","line"])],$p=Wp.concat([oe("type","contextformbutton"),oe("primary",!1),Yn("onAction"),de("original",i)]),Qp=Yp.concat([oe("type","contextformbutton"),oe("primary",!1),Yn("onAction"),de("original",i)]),Zp=Wp.concat([oe("type","contextformbutton")]),th=Yp.concat([oe("type","contextformtogglebutton")]),nh=Fn("type",{contextformbutton:$p,contextformtogglebutton:Qp}),eh=mn([oe("type","contextform"),se("initValue",(function(){return""})),te("label"),Jn("commands",nh),Qn("launch",Fn("type",{contextformbutton:Zp,contextformtogglebutton:th}))].concat(Jp)),oh=mn([oe("type","contexttoolbar"),Gn("items")].concat(Jp)),rh=function(t){var n,e,o=t.ui.registry.getAll().popups,r=Dt(o,(function(t){return En("Autocompleter",Up,t).fold((function(t){throw new Error(An(t))}),(function(t){return t}))})),i=(n=Mt(r,(function(t){return t.ch})),e={},G(n,(function(t){e[t]={}})),_t(e)),u=It(r);return{dataset:r,triggerChars:i,lookupByChar:function(t){return Y(u,(function(n){return n.ch===t}))}}};(Sp=wp=wp||{})[Sp.CLOSE_ON_EXECUTE=0]="CLOSE_ON_EXECUTE",Sp[Sp.BUBBLE_TO_SANDBOX=1]="BUBBLE_TO_SANDBOX";var ih,uh,ah=wp,ch="tox-menu-nav__js",sh="tox-collection__item",lh="tox-swatch",fh={normal:ch,color:lh},dh="tox-collection__item--enabled",mh="tox-collection__item-label",gh="tox-collection__item-caret",ph="tox-collection__item--active",hh="tox-collection__item-container",vh="tox-collection__item-container--row",bh=function(t){return Rt(fh,t).getOr(ch)},yh=function(t){return{backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:"color"===t?"tox-swatches":"tox-menu",tieredMenu:"tox-tiered-menu"}},xh=function(t){var n=yh(t);return{backgroundMenu:n.backgroundMenu,selectedMenu:n.selectedMenu,menu:n.menu,selectedItem:n.selectedItem,item:bh(t)}},wh=[qg.parts.items({})],Sh=function(t,n,e){var o=yh(e);return{dom:{tag:"div",classes:Q([[o.tieredMenu]])},markers:xh(e)}},kh=function(t,n){return function(e){var o=U(e,n);return W(o,(function(n){return{dom:t,components:n}}))}},Ch=function(t,n){var e=[],o=[];return G(t,(function(t,r){n(t,r)?(0<o.length&&e.push(o),o=[],Pt(t.dom,"innerHtml")&&o.push(t)):o.push(t)})),0<o.length&&e.push(o),W(e,(function(t){return{dom:{tag:"div",classes:["tox-collection__group"]},components:t}}))},Oh=function(t,n,e){return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===t?["tox-collection--list"]:["tox-collection--grid"])},components:[qg.parts.items({preprocess:function(e){return"auto"!==t&&1<t?kh({tag:"div",classes:["tox-collection__group"]},t)(e):Ch(e,(function(t,e){return"separator"===n[e].type}))}})]}},_h=function(t){return N(t,(function(t){return"icon"in t&&void 0!==t.icon}))},Th=function(t){return console.error(An(t)),console.log(t),C.none()},Eh=function(t,n,e,o,r){var i,u=(i=e,{dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[qg.parts.items({preprocess:function(t){return Ch(t,(function(t,n){return"separator"===i[n].type}))}})]});return{value:t,dom:u.dom,components:u.components,items:e}},Dh=function(t,n,e,o,r){var u,a,c,s,l,f;return"color"===r?{value:t,dom:(u=o,c={dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[qg.parts.items({preprocess:"auto"!==u?kh({tag:"div",classes:["tox-swatches__row"]},u):i})]}]}).dom,components:c.components,items:e}:"normal"===r&&"auto"===o?{value:t,dom:(c=Oh(o,e)).dom,components:c.components,items:e}:"normal"===r&&1===o?{value:t,dom:(c=Oh(1,e)).dom,components:c.components,items:e}:"normal"===r?{value:t,dom:(c=Oh(o,e)).dom,components:c.components,items:e}:"listpreview"!==r||"auto"===o?{value:t,dom:(s=n,l=o,f=yh(r),{tag:"div",classes:Q([[f.menu,"tox-menu-"+l+"-column"],s?[f.hasIcons]:[]])}),components:wh,items:e}:{value:t,dom:(a=o,c={dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[qg.parts.items({preprocess:kh({tag:"div",classes:["tox-collection__group"]},a)})]}).dom,components:c.components,items:e}},Bh=[Gn("type"),Gn("src"),te("alt"),le("classes",[],Vn)],Ah=mn(Bh),Mh=[Gn("type"),Gn("text"),te("name"),le("classes",["tox-collection__item-label"],Vn)],Fh=mn(Mh),Ih=On((function(){return Mn("type",{cardimage:Ah,cardtext:Fh,cardcontainer:Rh})})),Rh=mn([Gn("type"),ue("direction","horizontal"),ue("align","left"),ue("valign","middle"),Jn("items",Ih)]),Ph=[ce("disabled",!1),te("text"),te("shortcut"),xn("value","value",qt((function(){return ii("menuitem-value")})),In()),oe("meta",{})],Vh=mn([Gn("type"),te("label"),Jn("items",Ih),se("onSetup",(function(){return e})),se("onAction",e)].concat(Ph)),Hh=mn([Gn("type"),ce("active",!1),te("icon")].concat(Ph)),Lh=mn([Gn("type"),Xn("fancytype",["inserttable","colorswatch"]),se("onAction",e)]),zh=mn([Gn("type"),se("onSetup",(function(){return e})),se("onAction",e),te("icon")].concat(Ph)),Nh=mn([Gn("type"),Yn("getSubmenuItems"),se("onSetup",(function(){return e})),te("icon")].concat(Ph)),jh=mn([Gn("type"),te("icon"),ce("active",!1),se("onSetup",(function(){return e})),Yn("onAction")].concat(Ph)),Uh=function(t,n,e){var o=Ts(t.element,"."+e);if(0<o.length){var r=$(o,(function(t){var e=t.dom.getBoundingClientRect().top,r=o[0].dom.getBoundingClientRect().top;return Math.abs(e-r)>n})).getOr(o.length);return C.some({numColumns:r,numRows:Math.ceil(o.length/r)})}return C.none()},Wh=function(t,n){return uc([mg(t,n)])},Gh=function(t){return Wh(ii("unnamed-events"),t)},Xh=ii("tooltip.exclusive"),Yh=ii("tooltip.show"),qh=ii("tooltip.hide"),Kh=function(t,n,e){t.getSystem().broadcastOn([Xh],{})},Jh=Object.freeze({__proto__:null,hideAllExclusive:Kh,setComponents:function(t,n,e,o){e.getTooltip().each((function(t){t.getSystem().isConnected()&&dg.set(t,o)}))}}),$h=Object.freeze({__proto__:null,events:function(t,n){var e=function(e){n.getTooltip().each((function(o){sl(o),t.onHide(e,o),n.clearTooltip()})),n.clearTimer()};return nr(Q([[rr(Yh,(function(e){n.resetTimer((function(){var o,r,i;o=e,n.isShowing()||(Kh(o),r=t.lazySink(o).getOrDie(),i=o.getSystem().build({dom:t.tooltipDom,components:t.tooltipComponents,events:nr("normal"===t.mode?[rr(fo(),(function(t){Ko(o,Yh)})),rr(so(),(function(t){Ko(o,qh)}))]:[]),behaviours:uc([dg.config({})])}),n.setTooltip(i),ul(r,i),t.onShow(o,i),nl.position(r,t.anchor(o),i))}),t.delay)})),rr(qh,(function(o){n.resetTimer((function(){e(o)}),t.delay)})),rr(To(),(function(t,n){n.universal||z(n.channels,Xh)&&e(t)})),dr((function(t){e(t)}))],"normal"===t.mode?[rr(mo(),(function(t){Ko(t,Yh)})),rr(Oo(),(function(t){Ko(t,qh)})),rr(fo(),(function(t){Ko(t,Yh)})),rr(so(),(function(t){Ko(t,qh)}))]:[rr(Yo(),(function(t,n){Ko(t,Yh)})),rr(qo(),(function(t){Ko(t,qh)}))]]))}}),Qh=[Un("lazySink"),Un("tooltipDom"),oe("exclusive",!0),oe("tooltipComponents",[]),oe("delay",300),ae("mode","normal",["normal","follow-highlight"]),oe("anchor",(function(t){return{anchor:"hotspot",hotspot:t,layouts:{onLtr:r([Wa,Ua,La,Na,za,ja]),onRtl:r([Wa,Ua,La,Na,za,ja])}}})),pa("onHide"),pa("onShow")],Zh=cc({fields:Qh,name:"tooltipping",active:$h,state:Object.freeze({__proto__:null,init:function(){var t=me(C.none()),n=me(C.none()),e=function(){t.get().each((function(t){clearTimeout(t)}))},o=r("not-implemented");return Si({getTooltip:function(){return n.get()},isShowing:function(){return n.get().isSome()},setTooltip:function(t){n.set(C.some(t))},clearTooltip:function(){n.set(C.none())},clearTimer:e,resetTimer:function(n,o){e(),t.set(C.some(setTimeout((function(){n()}),o)))},readState:o})}}),apis:Jh}),tv=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),nv=tinymce.util.Tools.resolve("tinymce.util.I18n"),ev=["input","button","textarea","select"],ov=function(t,n,e){(n.disabled()?sv:lv)(t,n)},rv=function(t,n){return!0===n.useNative&&z(ev,pr(t.element))},iv=function(t){Kr(t.element,"disabled","disabled")},uv=function(t){Zr(t.element,"disabled")},av=function(t){Kr(t.element,"aria-disabled","true")},cv=function(t){Kr(t.element,"aria-disabled","false")},sv=function(t,n,e){n.disableClass.each((function(n){Vi(t.element,n)})),(rv(t,n)?iv:av)(t),n.onDisabled(t)},lv=function(t,n,e){n.disableClass.each((function(n){Li(t.element,n)})),(rv(t,n)?uv:cv)(t),n.onEnabled(t)},fv=function(t,n){return rv(t,n)?Qr(t.element,"disabled"):"true"===Jr(t.element,"aria-disabled")},dv=Object.freeze({__proto__:null,enable:lv,disable:sv,isDisabled:fv,onLoad:ov,set:function(t,n,e,o){(o?sv:lv)(t,n)}}),mv=Object.freeze({__proto__:null,exhibit:function(t,n){return Ci({classes:n.disabled()?n.disableClass.toArray():[]})},events:function(t,n){return nr([er(Eo(),(function(n,e){return fv(n,t)})),nc(t,n,ov)])}}),gv=[se("disabled",s),oe("useNative",!0),$n("disableClass"),pa("onDisabled"),pa("onEnabled")],pv=cc({fields:gv,name:"disabling",active:mv,apis:dv}),hv=tinymce.util.Tools.resolve("tinymce.EditorManager"),vv=function(t){return t.getParam("height",Math.max(t.getElement().offsetHeight,200))},bv=function(t){return t.getParam("width",tv.DOM.getStyle(t.getElement(),"width"))},yv=function(t){return C.from(t.getParam("min_width")).filter(I)},xv=function(t){return C.from(t.getParam("min_height")).filter(I)},wv=function(t){return C.from(t.getParam("max_width")).filter(I)},Sv=function(t){return C.from(t.getParam("max_height")).filter(I)},kv=function(t){return!1!==t.getParam("menubar",!0,"boolean")},Cv=function(t){var n=t.getParam("toolbar",!0),e=!0===n,o=T(n),r=D(n)&&0<n.length;return!_v(t)&&(r||o||e)},Ov=function(t){var n=j(9,(function(n){return t.getParam("toolbar"+(n+1),!1,"string")})),e=Y(n,(function(t){return"string"==typeof t}));return 0<e.length?C.some(e):C.none()},_v=function(t){return Ov(t).fold((function(){return 0<t.getParam("toolbar",[],"string[]").length}),l)};(uh=ih=ih||{})["default"]="wrap",uh.floating="floating",uh.sliding="sliding",uh.scrolling="scrolling";var Tv,Ev,Dv=function(t){return t.getParam("toolbar_mode","","string")};(Ev=Tv=Tv||{}).auto="auto",Ev.top="top",Ev.bottom="bottom";var Bv,Av,Mv,Fv=function(t){return t.getParam("toolbar_location",Tv.auto,"string")},Iv=function(t){return Fv(t)===Tv.bottom},Rv=function(t){var n=t.getParam("fixed_toolbar_container","","string");return 0<n.length&&t.inline?Ju(Gi(),n):C.none()},Pv=function(t){return t.inline&&Rv(t).isSome()},Vv=function(t){return Rv(t).getOrThunk((function(){return Ir(Fr(pe.fromDom(t.getElement())))}))},Hv=function(t){return t.inline&&!kv(t)&&!Cv(t)&&!_v(t)},Lv=function(t){return(t.getParam("toolbar_sticky",!1,"boolean")||t.inline)&&!Pv(t)&&!Hv(t)},zv="silver.readonly",Nv=mn([Wn("readonly",Hn)]),jv=function(t,n){var e=t.outerContainer.element;n&&(t.mothership.broadcastOn([Cl()],{target:e}),t.uiMothership.broadcastOn([Cl()],{target:e})),t.mothership.broadcastOn([zv],{readonly:n}),t.uiMothership.broadcastOn([zv],{readonly:n})},Uv=function(t,n){t.on("init",(function(){t.mode.isReadOnly()&&jv(n,!0)})),t.on("SwitchMode",(function(){return jv(n,t.mode.isReadOnly())})),t.getParam("readonly",!1,"boolean")&&t.setMode("readonly")},Wv=function(){var t;return dc.config({channels:((t={})[zv]={schema:Nv,onReceive:function(t,n){pv.set(t,n.readonly)}},t)})},Gv=function(t){return pv.config({disabled:t,disableClass:"tox-collection__item--state-disabled"})},Xv=function(t){return pv.config({disabled:t})},Yv=function(t){return pv.config({disabled:t,disableClass:"tox-tbtn--disabled"})},qv=function(t){return pv.config({disabled:t,disableClass:"tox-tbtn--disabled",useNative:!1})},Kv=function(t,n){var e=t.getApi(n);return function(t){t(e)}},Jv=function(t,n){return fr((function(e){Kv(t,e)((function(e){var o=t.onSetup(e);F(o)&&n.set(o)}))}))},$v=function(t,n){return dr((function(e){return Kv(t,e)(n.get())}))},Qv=((Bv={})[Eo()]=["disabling","alloy.base.behaviour","toggling","item-events"],Bv),Zv=function(t){return Z(t,(function(t){return t.toArray()}))},tb=function(t,n,o,r){var i,u,a=me(e);return{type:"item",dom:n.dom,components:Zv(n.optComponents),data:t.data,eventOrder:Qv,hasSubmenu:t.triggersSubmenu,itemBehaviours:uc([mg("item-events",[(i=t,u=o,gr((function(t,n){Kv(i,t)(i.onAction),i.triggersSubmenu||u!==ah.CLOSE_ON_EXECUTE||(t.getSystem().isConnected()&&Ko(t,Mo()),n.stop())}))),Jv(t,a),$v(t,a)]),Gv((function(){return t.disabled||r.isDisabled()})),Wv(),dg.config({})].concat(t.itemBehaviours))}},nb=function(t){return{value:t.value,meta:d({text:t.text.getOr("")},t.meta)}},eb=tinymce.util.Tools.resolve("tinymce.Env"),ob=function(t){return{dom:{tag:"div",classes:["tox-collection__item-icon"],innerHtml:t}}},rb=function(t){return{dom:{tag:"div",classes:[mh]},components:[du(nv.translate(t))]}},ib=function(t,n){return{dom:{tag:"div",classes:n,innerHtml:t}}},ub=function(t,n){return{dom:{tag:"div",classes:[mh]},components:[{dom:{tag:t.tag,styles:t.styles},components:[du(nv.translate(n))]}]}},ab=function(t){return{dom:{tag:"div",classes:["tox-collection__item-accessory"],innerHtml:(n=t,e=eb.mac?{alt:"&#x2325;",ctrl:"&#x2303;",shift:"&#x21E7;",meta:"&#x2318;",access:"&#x2303;&#x2325;"}:{meta:"Ctrl",access:"Shift+Alt"},o=n.split("+"),r=W(o,(function(t){var n=t.toLowerCase().trim();return Pt(e,n)?e[n]:t})),eb.mac?r.join(""):r.join("+"))}};var n,e,o,r},cb=function(t){return{dom:{tag:"div",classes:["tox-collection__item-checkmark"],innerHtml:vp("checkmark",t)}}},sb=function(t,n){var e=n.map((function(t){return{attributes:{title:nv.translate(t)}}})).getOr({});return d({tag:"div",classes:[ch,sh].concat(t?["tox-collection__item-icon-rtl"]:[])},e)},lb=["list-num-default","list-num-lower-alpha","list-num-lower-greek","list-num-lower-roman","list-num-upper-alpha","list-num-upper-roman"],fb=["list-bull-circle","list-bull-default","list-bull-square"],db=function(t,n,e,o){void 0===o&&(o=C.none());var r,i,a,c,s,l,f,m,p,h,v,b,y=nv.isRtl()&&t.iconContent.exists((function(t){return z(fb,t)})),x=t.iconContent.map((function(t){return nv.isRtl()&&z(lb,t)?t+"-rtl":t})).map((function(t){return e=t,r=n.icons,i=o,C.from(r()[e.toLowerCase()]).or(i).getOrThunk((function(){return hp(r)}));var e,r,i})),w=C.from(t.meta).fold((function(){return rb}),(function(t){return Pt(t,"style")?u(ub,t.style):rb}));return"color"===t.presets?(m=t.ariaLabel,p=t.value,h=n,{dom:(v=x.getOr(""),b={tag:"div",attributes:m.map((function(t){return{title:h.translate(t)}})).getOr({}),classes:["tox-swatch"]},d(d({},b),"custom"===p?{tag:"button",classes:g(b.classes,["tox-swatches__picker-btn"]),innerHtml:v}:"remove"===p?{classes:g(b.classes,["tox-swatch--remove"]),innerHtml:v}:{attributes:d(d({},b.attributes),{"data-mce-color":p}),styles:{"background-color":p}})),optComponents:[]}):(r=t,i=x,a=w,c=y,s=e?i.or(C.some("")).map(ob):C.none(),l=r.checkMark,f=r.htmlContent.fold((function(){return r.textContent.map(a)}),(function(t){return C.some(ib(t,[mh]))})),{dom:sb(c,r.ariaLabel),optComponents:[s,f,r.shortcutContent.map(ab),l,r.caret]})},mb=function(t,n){return Rt(t,"tooltipWorker").map((function(t){return[Zh.config({lazySink:n.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:function(t){return{anchor:"submenu",item:t,overrides:{maxHeightFunction:Ic}}},mode:"follow-highlight",onShow:function(n,e){t((function(t){Zh.setComponents(n,[mu({element:pe.fromDom(t)})])}))}})]})).getOr([])},gb=function(t,n){var e,o=nv.translate(t),r=(e=o,tv.DOM.encode(e));if(0<n.length){var i=new RegExp(n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi");return r.replace(i,(function(t){return'<span class="tox-autocompleter-highlight">'+t+"</span>"}))}return r},pb=function t(n,e){return W(n,(function(n){switch(n.type){case"cardcontainer":return c=t((a=n).items,e),s="vertical"===a.direction?"tox-collection__item-container--column":vh,l="left"===a.align?"tox-collection__item-container--align-left":"tox-collection__item-container--align-right",{dom:{tag:"div",classes:[hh,s,l,function(){switch(a.valign){case"top":return"tox-collection__item-container--valign-top";case"middle":return"tox-collection__item-container--valign-middle";case"bottom":return"tox-collection__item-container--valign-bottom"}}()]},components:c};case"cardimage":return r=n.src,i=n.classes,u=n.alt,{dom:{tag:"img",classes:i,attributes:{src:r,alt:u.getOr("")}}};case"cardtext":var o=n.name.exists((function(t){return z(e.cardText.highlightOn,t)}))?C.from(e.cardText.matchText).getOr(""):"";return ib(gb(n.text,o),n.classes)}var r,i,u,a,c,s,l}))},hb=Tf(Ng(),jg()),vb=function(t){return{value:t}},bb=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,yb=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,xb=function(t){return bb.test(t)||yb.test(t)},wb=function(t){var n={value:t.value.replace(bb,(function(t,n,e,o){return n+n+e+e+o+o}))},e=yb.exec(n.value);return null===e?["FFFFFF","FF","FF","FF"]:e},Sb=function(t){var n=t.toString(16);return 1===n.length?"0"+n:n},kb=function(t){var n=Sb(t.red)+Sb(t.green)+Sb(t.blue);return vb(n)},Cb=Math.min,Ob=Math.max,_b=Math.round,Tb=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,Eb=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,Db=function(t,n,e,o){return{red:t,green:n,blue:e,alpha:o}},Bb=function(t){var n=parseInt(t,10);return n.toString()===t&&0<=n&&n<=255},Ab=function(t){var n,e,o,r=(t.hue||0)%360,i=t.saturation/100,u=t.value/100;i=Ob(0,Cb(i,1)),u=Ob(0,Cb(u,1));if(0===i)return n=e=o=_b(255*u),Db(n,e,o,1);var a=r/60,c=u*i,s=c*(1-Math.abs(a%2-1)),l=u-c;switch(Math.floor(a)){case 0:n=c,e=s,o=0;break;case 1:n=s,e=c,o=0;break;case 2:n=0,e=c,o=s;break;case 3:n=0,e=s,o=c;break;case 4:n=s,e=0,o=c;break;case 5:n=c,e=0,o=s;break;default:n=e=o=0}return n=_b(255*(n+l)),e=_b(255*(e+l)),o=_b(255*(o+l)),Db(n,e,o,1)},Mb=function(t){var n=wb(t),e=parseInt(n[1],16),o=parseInt(n[2],16),r=parseInt(n[3],16);return Db(e,o,r,1)},Fb=function(t,n,e,o){var r=parseInt(t,10),i=parseInt(n,10),u=parseInt(e,10),a=parseFloat(o);return Db(r,i,u,a)},Ib=function(t){return"rgba("+t.red+","+t.green+","+t.blue+","+t.alpha+")"},Rb=Db(255,0,0,1),Pb=function(t,n){return t.fire("ResizeContent",n)},Vb=tinymce.util.Tools.resolve("tinymce.util.LocalStorage"),Hb="tinymce-custom-colors",Lb="choiceitem",zb=[{type:Lb,text:"Light Green",value:"#BFEDD2"},{type:Lb,text:"Light Yellow",value:"#FBEEB8"},{type:Lb,text:"Light Red",value:"#F8CAC6"},{type:Lb,text:"Light Purple",value:"#ECCAFA"},{type:Lb,text:"Light Blue",value:"#C2E0F4"},{type:Lb,text:"Green",value:"#2DC26B"},{type:Lb,text:"Yellow",value:"#F1C40F"},{type:Lb,text:"Red",value:"#E03E2D"},{type:Lb,text:"Purple",value:"#B96AD9"},{type:Lb,text:"Blue",value:"#3598DB"},{type:Lb,text:"Dark Turquoise",value:"#169179"},{type:Lb,text:"Orange",value:"#E67E23"},{type:Lb,text:"Dark Red",value:"#BA372A"},{type:Lb,text:"Dark Purple",value:"#843FA1"},{type:Lb,text:"Dark Blue",value:"#236FA1"},{type:Lb,text:"Light Gray",value:"#ECF0F1"},{type:Lb,text:"Medium Gray",value:"#CED4D9"},{type:Lb,text:"Gray",value:"#95A5A6"},{type:Lb,text:"Dark Gray",value:"#7E8C8D"},{type:Lb,text:"Navy Blue",value:"#34495E"},{type:Lb,text:"Black",value:"#000000"},{type:Lb,text:"White",value:"#ffffff"}],Nb=function(t){void 0===t&&(t=10);var n,e=Vb.getItem(Hb),o=T(e)?JSON.parse(e):[],r=t-(n=o).length<0?n.slice(0,t):n,i=function(t){r.splice(t,1)};return{add:function(n){var e;(-1===(e=L(r,n))?C.none():C.some(e)).each(i),r.unshift(n),r.length>t&&r.pop(),Vb.setItem(Hb,JSON.stringify(r))},state:function(){return r.slice(0)}}}(10),jb=function(t){return!1!==t.getParam("custom_colors")},Ub=function(t){var n=t.getParam("color_map");return void 0!==n?function(t){var n=[],e=document.createElement("canvas");e.height=1,e.width=1;for(var o=e.getContext("2d"),r=function(t,n){var e=n/255;return("0"+Math.round(t*e+255*(1-e)).toString(16)).slice(-2).toUpperCase()},i=0;i<t.length;i+=2)n.push({text:t[i+1],value:function(t){if(/^[0-9A-Fa-f]{6}$/.test(t))return"#"+t.toUpperCase();o.clearRect(0,0,e.width,e.height),o.fillStyle="#FFFFFF",o.fillStyle=t,o.fillRect(0,0,1,1);var n=o.getImageData(0,0,1,1).data,i=n[0],u=n[1],a=n[2],c=n[3];return"#"+r(i,c)+r(u,c)+r(a,c)}(t[i]),type:"choiceitem"});return n}(n):zb},Wb=function(t){Nb.add(t)},Gb=function(t){t.addCommand("mceApplyTextcolor",(function(n,e){var o,r,i;r=n,i=e,(o=t).undoManager.transact((function(){o.focus(),o.formatter.apply(r,{value:i}),o.nodeChanged()}))})),t.addCommand("mceRemoveTextcolor",(function(n){var e,o;o=n,(e=t).undoManager.transact((function(){e.focus(),e.formatter.remove(o,{value:null},null,!0),e.nodeChanged()}))}))},Xb=function(t){var n,e,o=Ub(t),r=(n=o.length,Math.max(5,Math.ceil(Math.sqrt(n))));return e=r,t.getParam("color_cols",e,"number")},Yb=function(t,n,e,o){"custom"===e?Zb(t)((function(e){e.each((function(e){Wb(e),t.execCommand("mceApplyTextcolor",n,e),o(e)}))}),"#000000"):"remove"===e?(o(""),t.execCommand("mceRemoveTextcolor",n)):(o(e),t.execCommand("mceApplyTextcolor",n,e))},qb=function(t,n){return t.concat(W(Nb.state(),(function(t){return{type:Lb,text:t,value:t}})).concat((o={type:e="choiceitem",text:"Remove color",icon:"color-swatch-remove-color",value:"remove"},n?[o,{type:e,text:"Custom color",icon:"color-picker",value:"custom"}]:[o])));var e,o},Kb=function(t,n){return function(e){e(qb(t,n))}},Jb=function(t,n,e){var o,r;o="forecolor"===n?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color",r=e,t.setIconFill(o,r),t.setIconStroke(o,r)},$b=function(t,n,o,r,i){t.ui.registry.addSplitButton(n,{tooltip:r,presets:"color",icon:"forecolor"===n?"text-color":"highlight-bg-color",select:function(n){var e,r,i;return C.from((r=o,(e=t).dom.getParents(e.selection.getStart(),(function(t){var n;(n=t.style["forecolor"===r?"color":"background-color"])&&(i=i||n)})),i)).bind((function(t){return function(t){if("transparent"===t)return C.some(Db(0,0,0,0));var n=Tb.exec(t);if(null!==n)return C.some(Fb(n[1],n[2],n[3],"1"));var e=Eb.exec(t);return null!==e?C.some(Fb(e[1],e[2],e[3],e[4])):C.none()}(t).map((function(t){var e=kb(t).value;return ke(n.toLowerCase(),e)}))})).getOr(!1)},columns:Xb(t),fetch:Kb(Ub(t),jb(t)),onAction:function(n){null!==i.get()&&Yb(t,o,i.get(),e)},onItemAction:function(e,r){Yb(t,o,r,(function(e){var o;i.set(e),o={name:n,color:e},t.fire("TextColorChange",o)}))},onSetup:function(e){null!==i.get()&&Jb(e,n,i.get());var o=function(t){t.name===n&&Jb(e,t.name,t.color)};return t.on("TextColorChange",o),function(){t.off("TextColorChange",o)}}})},Qb=function(t,n,o,r){t.ui.registry.addNestedMenuItem(n,{text:r,icon:"forecolor"===n?"text-color":"highlight-bg-color",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"colorswatch",onAction:function(n){Yb(t,o,n.value,e)}}]}})},Zb=function(t){return function(n,o){var r,i={colorpicker:o},u=(r=n,function(t){var n=t.getData();r(C.from(n.colorpicker)),t.close()});t.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:i,onAction:function(t,n){"hex-valid"===n.name&&(n.value?t.enable("ok"):t.disable("ok"))},onSubmit:u,onClose:e,onCancel:function(){n(C.none())}})}},ty=function(t,n,e,o,r,i,u,a){var c=_h(n),s=ny(n,e,o,"color"!==r?"normal":"color",i,u,a);return Dh(t,c,s,o,r)},ny=function(t,n,o,r,i,u,a){return Jf(W(t,(function(c){return"choiceitem"===c.type?En("choicemenuitem",Hh,c).fold(Th,(function(s){return C.some(function(t,n,o,r,i,u,a,c){void 0===c&&(c=!0);var s=db({presets:o,textContent:n?t.text:C.none(),htmlContent:C.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:n?t.shortcut:C.none(),checkMark:n?C.some(cb(a.icons)):C.none(),caret:C.none(),value:t.value},a,c);return Nt(tb({data:nb(t),disabled:t.disabled,getApi:function(t){return{setActive:function(n){Bg.set(t,n)},isActive:function(){return Bg.isOn(t)},isDisabled:function(){return pv.isDisabled(t)},setDisabled:function(n){return pv.set(t,n)}}},onAction:function(n){return r(t.value)},onSetup:function(t){return t.setActive(i),e},triggersSubmenu:!1,itemBehaviours:[]},s,u,a),{toggling:{toggleClass:dh,toggleOnExecute:!1,selected:t.active}})}(s,1===o,r,n,u(c.value),i,a,_h(t)))})):C.none()})))},ey=function(t,n){var e=xh(n);return 1===t?{mode:"menu",moveOnTab:!0}:"auto"===t?{mode:"grid",selector:"."+e.item,initSize:{numColumns:1,numRows:1}}:{mode:"matrix",rowSelector:"."+("color"===n?"tox-swatches__row":"tox-collection__group")}},oy=ii("cell-over"),ry=ii("cell-execute"),iy=function(t,n,e){for(var o=[],r=0;r<n;r++){for(var i=[],u=0;u<e;u++)i.push(function(t,n,e){var o,r=function(e){return Jo(e,ry,{row:t,col:n})},i=function(t,n){n.stop(),r(t)};return pu({dom:{tag:"div",attributes:((o={role:"button"})["aria-labelledby"]=e,o)},behaviours:uc([mg("insert-table-picker-cell",[rr(fo(),bg.focus),rr(Eo(),r),rr(yo(),i),rr(Bo(),i)]),Bg.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),bg.config({onFocus:function(e){return Jo(e,oy,{row:t,col:n})}})])})}(r,u,t));o.push(i)}return o},uy={inserttable:function(t){var n=ii("size-label"),e=iy(n,10,10),o=pp({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:n}},components:[du("0x0")],behaviours:uc([dg.config({})])});return{type:"widget",data:{value:ii("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[hb.widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:Z(e,(function(t){return W(t,hu)})).concat(o.asSpec()),behaviours:uc([mg("insert-table-picker",[cr(oy,(function(t,n,r){var i=r.event.row,u=r.event.col;!function(t,n,e,o,r){for(var i=0;i<o;i++)for(var u=0;u<r;u++)Bg.set(t[i][u],i<=n&&u<=e)}(e,i,u,10,10),dg.set(o.get(t),[du(u+1+"x"+(i+1))])})),cr(ry,(function(n,e,o){t.onAction({numRows:o.event.row+1,numColumns:o.event.col+1}),Ko(n,Mo())}))]),ag.config({initSize:{numRows:10,numColumns:10},mode:"flatgrid",selector:'[role="button"]'})])})]}},colorswatch:function(t,n){var e=qb(n.colorinput.getColors(),n.colorinput.hasCustomColors()),o=n.colorinput.getColorCols(),r=ty(ii("menu-value"),e,(function(n){t.onAction({value:n})}),o,"color",ah.CLOSE_ON_EXECUTE,s,n.shared.providers),i=d(d({},r),{markers:xh("color"),movement:ey(o,"color")});return{type:"widget",data:{value:ii("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[hb.widget(qg.sketch(i))]}}},ay=function(t,n,o,i,u,a,c,s){void 0===s&&(s=!0);var l=db({presets:i,textContent:C.none(),htmlContent:o?t.text.map((function(t){return gb(t,n)})):C.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:C.none(),checkMark:C.none(),caret:C.none(),value:t.value},c.providers,s,t.icon);return tb({data:nb(t),disabled:t.disabled,getApi:r({}),onAction:function(n){return u(t.value,t.meta)},onSetup:r(e),triggersSubmenu:!1,itemBehaviours:mb(t.meta,c)},l,a,c.providers)},cy=function(t){var n=t.text.fold((function(){return{}}),(function(t){return{innerHtml:t}}));return{type:"separator",dom:d({tag:"div",classes:[sh,"tox-collection__group-heading"]},n),components:[]}},sy=function(t,n,e,o){void 0===o&&(o=!0);var r=db({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:C.none(),ariaLabel:t.text,caret:C.none(),checkMark:C.none(),shortcutContent:t.shortcut},e,o);return tb({data:nb(t),getApi:function(t){return{isDisabled:function(){return pv.isDisabled(t)},setDisabled:function(n){return pv.set(t,n)}}},disabled:t.disabled,onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},r,n,e)},ly=function(t,n,o,r,i){void 0===r&&(r=!0),void 0===i&&(i=!1);var u,a,c=i?(a=o.icons,{dom:{tag:"div",classes:[gh],innerHtml:vp("chevron-down",a)}}):(u=o.icons,{dom:{tag:"div",classes:[gh],innerHtml:vp("chevron-right",u)}}),s=db({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:C.none(),ariaLabel:t.text,caret:C.some(c),checkMark:C.none(),shortcutContent:t.shortcut},o,r);return tb({data:nb(t),getApi:function(t){return{isDisabled:function(){return pv.isDisabled(t)},setDisabled:function(n){return pv.set(t,n)}}},disabled:t.disabled,onAction:e,onSetup:t.onSetup,triggersSubmenu:!0,itemBehaviours:[]},s,n,o)},fy=function(t,n,e,o){void 0===o&&(o=!0);var r=db({iconContent:t.icon,textContent:t.text,htmlContent:C.none(),ariaLabel:t.text,checkMark:C.some(cb(e.icons)),caret:C.none(),shortcutContent:t.shortcut,presets:"normal",meta:t.meta},e,o);return Nt(tb({data:nb(t),disabled:t.disabled,getApi:function(t){return{setActive:function(n){Bg.set(t,n)},isActive:function(){return Bg.isOn(t)},isDisabled:function(){return pv.isDisabled(t)},setDisabled:function(n){return pv.set(t,n)}}},onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},r,n,e),{toggling:{toggleClass:dh,toggleOnExecute:!1,selected:t.active}})},dy=function(t,n){return e=uy,o=t.fancytype,(Object.prototype.hasOwnProperty.call(e,o)?C.some(e[o]):C.none()).map((function(e){return e(t,n)}));var e,o},my=function(t,n,e,o){var r={dom:sb(!1,t.label),optComponents:[C.some({dom:{tag:"div",classes:[hh,vh]},components:pb(t.items,o)})]};return tb({data:nb(d({text:C.none()},t)),disabled:t.disabled,getApi:function(t){return{isDisabled:function(){return pv.isDisabled(t)},setDisabled:function(n){pv.set(t,n),G(Ts(t.element,"*"),(function(e){t.getSystem().getByDom(e).each((function(t){t.hasConfigured(pv)&&pv.set(t,n)}))}))}}},onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:C.from(o.itemBehaviours).getOr([])},r,n,e.providers)};(Mv=Av=Av||{})[Mv.ContentFocus=0]="ContentFocus",Mv[Mv.UiFocus=1]="UiFocus";var gy,py,hy,vy,by=function(t,n,e,o,r){var i=e.shared.providers,u=function(t){return r?d(d({},t),{shortcut:C.none(),icon:t.text.isSome()?C.none():t.icon}):t};switch(t.type){case"menuitem":return En("menuitem",zh,t).fold(Th,(function(t){return C.some(sy(u(t),n,i,o))}));case"nestedmenuitem":return En("nestedmenuitem",Nh,t).fold(Th,(function(t){return C.some(ly(u(t),n,i,o,r))}));case"togglemenuitem":return En("togglemenuitem",jh,t).fold(Th,(function(t){return C.some(fy(u(t),n,i,o))}));case"separator":return En("separatormenuitem",Np,t).fold(Th,(function(t){return C.some(cy(t))}));case"fancymenuitem":return En("fancymenuitem",Lh,t).fold(Th,(function(t){return dy(u(t),e)}));default:return console.error("Unknown item in general menu",t),C.none()}},yy=function(t,n,e,o,r,i,u){var a=1===o,c=!a||_h(t);return Jf(W(t,(function(t){switch(t.type){case"separator":return En("Autocompleter.Separator",Np,t).fold(Th,(function(t){return C.some(cy(t))}));case"cardmenuitem":return En("cardmenuitem",Vh,t).fold(Th,(function(t){return C.some(my(d(d({},t),{onAction:function(n){t.onAction(n),e(t.value,t.meta)}}),r,i,{itemBehaviours:mb(t.meta,i),cardText:{matchText:n,highlightOn:u}}))}));case"autocompleteitem":default:return En("Autocompleter.Item",jp,t).fold(Th,(function(t){return C.some(ay(t,n,a,"normal",e,r,i,c))}))}})))},xy=function(t,n,e,o,r){var i=_h(n),u=Jf(W(n,(function(t){var n=function(t){return by(t,e,o,(n=t,r?!n.hasOwnProperty("text"):i),r);var n};return"nestedmenuitem"===t.type&&t.getSubmenuItems().length<=0?n(d(d({},t),{disabled:!0})):n(t)})));return(r?Eh:Dh)(t,i,u,1,"normal")},wy=function(t){return tp.singleData(t.value,t)},Sy=function(t,n){var e=me(C.none()),o=me(!1),r=pu(np.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:uc([mg("dismissAutocompleter",[rr(No(),(function(){return a()}))])]),lazySink:n.getSink})),i=function(){return e.get().isSome()},u=function(){i()&&np.hide(r)},a=function(){var n;i()&&(n=e.get().map((function(t){return t.element})),Tp(n.getOr(pe.fromDom(t.selection.getNode()))).each(Gr),u(),e.set(C.none()),o.set(!1))},c=Ut((function(){return rh(t)})),s=function(n,e,o,i){n.matchLength=e.text.length;var u,a,c,s,l,f,d,m=ct(o,(function(t){return C.from(t.columns)})).getOr(1);np.showAt(r,{anchor:"node",root:pe.fromDom(t.getBody()),node:C.from(n.element)},qg.sketch((u=Dh("autocompleter-value",!0,i,m,"normal"),a=m,c=Av.ContentFocus,s="normal",l=(c===Av.ContentFocus?Id:Fd)(),f=ey(a,s),d=xh(s),{dom:u.dom,components:u.components,items:u.items,value:u.value,markers:{selectedItem:d.selectedItem,item:d.item},movement:f,fakeFocus:c===Av.ContentFocus,focusManager:l,menuBehaviours:Gh("auto"!==a?[]:[fr((function(t,n){Uh(t,4,d.item).each((function(n){var e=n.numColumns,o=n.numRows;ag.setGridSize(t,o,e)}))}))])}))),np.getContent(r).each(dd.highlightFirst)},l=function r(l){var f;f=l,e.get().map((function(n){return Mp(t.dom,t.selection.getRng(),n.triggerChar).bind((function(n){return zp(t,c,n,f)}))})).getOrThunk((function(){return Lp(t,c)})).fold(a,(function(c){var l,f;l=c.context,i()||(f=_p(t,l.range),e.set(C.some({triggerChar:l.triggerChar,element:f,matchLength:l.text.length})),o.set(!1)),c.lookupData.then((function(i){e.get().map((function(e){var l,f,d,m,g=c.context;e.triggerChar===g.triggerChar&&(f=g.triggerChar,m=ct(d=i,(function(t){return C.from(t.columns)})).getOr(1),0<(l=Z(d,(function(e){var i=e.items;return yy(i,e.matchText,(function(n,i){var c=t.selection.getRng();Mp(t.dom,c,f).fold((function(){return console.error("Lost context. Cursor probably moved")}),(function(t){var c=t.range,s={hide:function(){a()},reload:function(t){u(),r(t)}};o.set(!0),e.onAction(s,c,n,i),o.set(!1)}))}),m,ah.BUBBLE_TO_SANDBOX,n,e.highlightOn)}))).length?s(e,g,i,l):(10<=g.text.length-e.matchLength?a:u)())}))}))}))},f={onKeypress:kp((function(t){27!==t.which&&l()}),50),cancelIfNecessary:a,isMenuOpen:function(){return np.isOpen(r)},isActive:i,isProcessingAction:o.get,getView:function(){return np.getContent(r)}};!1===t.hasPlugin("rtc")&&Fp(f,t)},ky=l,Cy=function(t,n,e){return Bu(t,n,ky,e,!1)},Oy=function(t,n,e){return Bu(t,n,ky,e,!0)},_y=Du,Ty=function(t,n,e){return $u(t,n,e).isSome()},Ey=function(t,n){var e=null;return{cancel:function(){null!==e&&(clearTimeout(e),e=null)},schedule:function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];e=setTimeout((function(){t.apply(null,o),e=null}),n)}}},Dy=function(t){var n=t.raw;return void 0===n.touches||1!==n.touches.length?C.none():C.some(n.touches[0])},By=function(t){var n=me(C.none()),e=me(!1),o=Ey((function(n){t.triggerEvent(Ao(),n),e.set(!0)}),400),r=Zt([{key:oo(),value:function(t){return Dy(t).each((function(r){o.cancel();var i={x:r.clientX,y:r.clientY,target:t.target};o.schedule(t),e.set(!1),n.set(C.some(i))})),C.none()}},{key:ro(),value:function(t){return o.cancel(),Dy(t).each((function(t){n.get().each((function(e){var o,r,i,u;o=t,r=e,i=Math.abs(o.clientX-r.x),u=Math.abs(o.clientY-r.y),(5<i||5<u)&&n.set(C.none())}))})),C.none()}},{key:io(),value:function(r){return o.cancel(),n.get().filter((function(t){return Ye(t.target,r.target)})).map((function(n){return e.get()?(r.prevent(),!1):t.triggerEvent(Bo(),r)}))}}]);return{fireIfReady:function(t,n){return Rt(r,n).bind((function(n){return n(t)}))}}},Ay=function(){return We().browser.isFirefox()},My=dn([Yn("triggerEvent"),oe("stopBackspace",!0)]),Fy=function(t,n){var e,o,r,i,u=Bn("Getting GUI events settings",My,n),a=By(u),c=W(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),(function(n){return Cy(t,n,(function(t){a.fireIfReady(t,n).each((function(n){n&&t.kill()})),u.triggerEvent(n,t)&&t.kill()}))})),s=me(C.none()),l=Cy(t,"paste",(function(t){a.fireIfReady(t,"paste").each((function(n){n&&t.kill()})),u.triggerEvent("paste",t)&&t.kill(),s.set(C.some(setTimeout((function(){u.triggerEvent(_o(),t)}),0)))})),f=Cy(t,"keydown",(function(t){var n;u.triggerEvent("keydown",t)?t.kill():!0!==u.stopBackspace||(n=t).raw.which!==md[0]||z(["input","textarea"],pr(n.target))||Ty(n.target,'[contenteditable="true"]')||t.prevent()})),d=(e=t,o=function(t){u.triggerEvent("focusin",t)&&t.kill()},Ay()?Oy(e,"focus",o):Cy(e,"focusin",o)),m=me(C.none()),g=(r=t,i=function(t){u.triggerEvent("focusout",t)&&t.kill(),m.set(C.some(setTimeout((function(){u.triggerEvent(Oo(),t)}),0)))},Ay()?Oy(r,"blur",i):Cy(r,"focusout",i));return{unbind:function(){G(c,(function(t){t.unbind()})),f.unbind(),d.unbind(),g.unbind(),l.unbind(),s.get().each(clearTimeout),m.get().each(clearTimeout)}}},Iy=function(t,n){var e=Rt(t,"target").getOr(n);return me(e)},Ry=Ht([{stopped:[]},{resume:["element"]},{complete:[]}]),Py=function(t,n,e,o,r,i){var u,a,c,s,l=t(n,o),f=(u=e,a=r,c=me(!1),s=me(!1),{stop:function(){c.set(!0)},cut:function(){s.set(!0)},isStopped:c.get,isCut:s.get,event:u,setSource:a.set,getSource:a.get});return l.fold((function(){return i.logEventNoHandlers(n,o),Ry.complete()}),(function(t){var e=t.descHandler;return Oi(e)(f),f.isStopped()?(i.logEventStopped(n,t.element,e.purpose),Ry.stopped()):f.isCut()?(i.logEventCut(n,t.element,e.purpose),Ry.complete()):Or(t.element).fold((function(){return i.logNoParent(n,t.element,e.purpose),Ry.complete()}),(function(o){return i.logEventResponse(n,t.element,e.purpose),Ry.resume(o)}))}))},Vy=function t(n,e,o,r,i,u){return Py(n,e,o,r,i,u).fold(l,(function(r){return t(n,e,o,r,i,u)}),s)},Hy=function(t,n,o){var r,i,u=(r=n,i=me(!1),{stop:function(){i.set(!0)},cut:e,isStopped:i.get,isCut:s,event:r,setSource:c("Cannot set source of a broadcasted event"),getSource:c("Cannot get source of a broadcasted event")});return G(t,(function(t){var n=t.descHandler;Oi(n)(u)})),u.isStopped()},Ly=function(t,n,e,o,r){var i=Iy(e,o);return Vy(t,n,e,o,i,r)},zy=function(){var t={};return{registerId:function(n,e,o){Et(o,(function(o,r){var i,a,c=void 0!==t[r]?t[r]:{};c[e]=(i=o,a=n,{cHandler:u.apply(void 0,[i.handler].concat(a)),purpose:i.purpose}),t[r]=c}))},unregisterId:function(n){Et(t,(function(t,e){t.hasOwnProperty(n)&&delete t[n]}))},filterByType:function(n){return Rt(t,n).map((function(t){return Mt(t,(function(t,n){return{id:n,descHandler:t}}))})).getOr([])},find:function(n,e,o){var r=Rt(t,e);return Qe(o,(function(t){return n=r,fi(e=t).fold((function(){return C.none()}),(function(t){return n.bind((function(n){return Rt(n,t)})).map((function(t){return{element:e,descHandler:t}}))}));var n,e}),n)}}},Ny=function(){var t=zy(),n={},e=function(t){var n=t.element;return fi(n).fold((function(){return n="uid-",e=t.element,o=ii(ci+n),li(e,o),o;var n,e,o}),(function(t){return t}))},o=function(e){fi(e.element).each((function(e){delete n[e],t.unregisterId(e)}))};return{find:function(n,e,o){return t.find(n,e,o)},filter:function(n){return t.filterByType(n)},register:function(r){var i=e(r);Vt(n,i)&&function(t,e){var r=n[e];if(r!==t)throw new Error('The tagId "'+e+'" is already used by: '+ni(r.element)+"\nCannot use it for: "+ni(t.element)+"\nThe conflicting element is"+(Wi(r.element)?" ":" not ")+"already in the DOM");o(t)}(r,i);var u=[r];t.registerId(u,i,r.events),n[i]=r},unregister:o,getById:function(t){return Rt(n,t)}}},jy=qf({name:"Container",factory:function(t){var n=t.dom,e=n.attributes,o=m(n,["attributes"]);return{uid:t.uid,dom:d({tag:"div",attributes:d({role:"presentation"},e)},o),components:t.components,behaviours:Gl(t.containerBehaviours),events:t.events,domModification:t.domModification,eventOrder:t.eventOrder}},configFields:[oe("components",[]),Wl("containerBehaviours",[]),oe("events",{}),oe("domModification",{}),oe("eventOrder",{})]}),Uy=function(t){var n=function(n){return Or(t.element).fold(l,(function(t){return Ye(n,t)}))},o=Ny(),i=function(t,e){return o.find(n,t,e)},u=Fy(t.element,{triggerEvent:function(t,n){return ua(t,n.target,(function(e){return r=e,Ly(i,t,o=n,o.target,r);var o,r}))}}),a={debugInfo:r("real"),triggerEvent:function(t,n,e){ua(t,n,(function(o){return Ly(i,t,e,n,o)}))},triggerFocus:function(t,n){fi(t).fold((function(){gc(t)}),(function(o){ua(Co(),t,(function(o){var r,u,a,c,s,l;return r=i,u=Co(),s=o,l=Iy(a={originator:n,kill:e,prevent:e,target:t},c=t),Py(r,u,a,c,l,s),!1}))}))},triggerEscape:function(t,n){a.triggerEvent("keydown",t.element,n.event)},getByUid:function(t){return v(t)},getByDom:function(t){return b(t)},build:pu,addToGui:function(t){f(t)},removeFromGui:function(t){d(t)},addToWorld:function(t){c(t)},removeFromWorld:function(t){s(t)},broadcast:function(t){g(t)},broadcastOn:function(t,n){p(t,n)},broadcastEvent:function(t,n){h(t,n)},isConnected:l},c=function t(n){n.connect(a),br(n.element)||(o.register(n),G(n.components(),t),a.triggerEvent(Io(),n.element,{target:n.element}))},s=function t(n){br(n.element)||(G(n.components(),t),o.unregister(n)),n.disconnect()},f=function(n){ul(t,n)},d=function(t){sl(t)},m=function(t){var n=o.filter(To());G(n,(function(n){var e=n.descHandler;Oi(e)(t)}))},g=function(t){m({universal:!0,data:t})},p=function(t,n){m({universal:!1,channels:t,data:n})},h=function(t,n){var e=o.filter(t);return Hy(e,n)},v=function(t){return o.getById(t).fold((function(){return ft.error(new Error('Could not find component with uid: "'+t+'" in system.'))}),ft.value)},b=function(t){var n=fi(t).getOr("not found");return v(n)};return c(t),{root:t,element:t.element,destroy:function(){u.unbind(),Wr(t.element)},add:f,remove:d,getByUid:v,getByDom:b,addToWorld:c,removeFromWorld:s,broadcast:g,broadcastOn:p,broadcastEvent:h}},Wy=r([oe("prefix","form-field"),Wl("fieldBehaviours",[nd,Ul])]),Gy=r([Sf({schema:[Un("dom")],name:"label"}),Sf({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[Un("text")],name:"aria-descriptor"}),xf({factory:{sketch:function(t){var n=$t(t,["factory"]);return t.factory.sketch(n)}},schema:[Un("factory")],name:"field"})]),Xy=Kf({name:"FormField",configFields:Wy(),partFields:Gy(),factory:function(t,n,e,o){var r=Xl(t.fieldBehaviours,[nd.config({find:function(n){return If(n,t,"field")}}),Ul.config({store:{mode:"manual",getValue:function(t){return nd.getCurrent(t).bind(Ul.getValue)},setValue:function(t,n){nd.getCurrent(t).each((function(t){Ul.setValue(t,n)}))}}})]),i=nr([fr((function(n,e){var o=Pf(n,t,["label","field","aria-descriptor"]);o.field().each((function(n){var e=ii(t.prefix);o.label().each((function(t){Kr(t.element,"for",e),Kr(n.element,"id",e)})),o["aria-descriptor"]().each((function(e){var o=ii(t.prefix);Kr(e.element,"id",o),Kr(n.element,"aria-describedby",o)}))}))}))]),u={getField:function(n){return If(n,t,"field")},getLabel:function(n){return If(n,t,"label")}};return{uid:t.uid,dom:t.dom,components:n,behaviours:r,events:i,apis:u}},apis:{getField:function(t,n){return t.getField(n)},getLabel:function(t,n){return t.getLabel(n)}}}),Yy=Object.freeze({__proto__:null,exhibit:function(t,n){return Ci({attributes:Zt([{key:n.tabAttr,value:"true"}])})}}),qy=[oe("tabAttr","data-alloy-tabstop")],Ky=cc({fields:qy,name:"tabstopping",active:Yy}),Jy=tinymce.util.Tools.resolve("tinymce.html.Entities"),$y=function(t,n,e,o){var r=Qy(t,n,e,o);return Xy.sketch(r)},Qy=function(t,n,e,o){return{dom:Zy(e),components:t.toArray().concat([n]),fieldBehaviours:uc(o)}},Zy=function(t){return{tag:"div",classes:["tox-form__group"].concat(t)}},tx=function(t,n){return Xy.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}})},nx=ii("form-component-change"),ex=ii("form-close"),ox=ii("form-cancel"),rx=ii("form-action"),ix=ii("form-submit"),ux=ii("form-block"),ax=ii("form-unblock"),cx=ii("form-tabchange"),sx=ii("form-resize"),lx=function(t,n){var e,o,r,u=t.label.map((function(t){return tx(t,n)})),a=function(t){return function(n,e){$u(e.event.target,"[data-collection-item-value]").each((function(o){t(n,e,o,Jr(o,"data-collection-item-value"))}))}},c=a((function(e,o,r,i){o.stop(),n.isDisabled()||Jo(e,rx,{name:t.name,value:i})})),s=[rr(fo(),a((function(t,n,e){gc(e)}))),rr(yo(),c),rr(Bo(),c),rr(mo(),a((function(t,n,e){Ju(t.element,"."+ph).each((function(t){Li(t,ph)})),Vi(e,ph)}))),rr(go(),a((function(t){Ju(t.element,"."+ph).each((function(t){Li(t,ph)}))}))),gr(a((function(n,e,o,r){Jo(n,rx,{name:t.name,value:r})})))],l=function(t,n){return W(Ts(t.element,".tox-collection__item"),n)},f=Xy.parts.field({dom:{tag:"div",classes:["tox-collection"].concat(1!==t.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:i},behaviours:uc([pv.config({disabled:n.isDisabled,onDisabled:function(t){l(t,(function(t){Vi(t,"tox-collection__item--state-disabled"),Kr(t,"aria-disabled",!0)}))},onEnabled:function(t){l(t,(function(t){Li(t,"tox-collection__item--state-disabled"),Zr(t,"aria-disabled")}))}}),Wv(),dg.config({}),Ul.config({store:{mode:"memory",initialValue:[]},onSetValue:function(e,o){var r,i,u,a;r=e,i=W(o,(function(e){var o=nv.translate(e.text),r=1===t.columns?'<div class="tox-collection__item-label">'+o+"</div>":"",i='<div class="tox-collection__item-icon">'+e.icon+"</div>",u={_:" "," - ":" ","-":" "},a=o.replace(/\_| \- |\-/g,(function(t){return u[t]}));return'<div class="tox-collection__item'+(n.isDisabled()?" tox-collection__item--state-disabled":"")+'" tabindex="-1" data-collection-item-value="'+Jy.encodeAllRaw(e.value)+'" title="'+a+'" aria-label="'+a+'">'+i+r+"</div>"})),u="auto"!==t.columns&&1<t.columns?U(i,t.columns):[i],a=W(u,(function(t){return'<div class="tox-collection__group">'+t.join("")+"</div>"})),Yr(r.element,a.join("")),"auto"===t.columns&&Uh(e,5,"tox-collection__item").each((function(t){var n=t.numRows,o=t.numColumns;ag.setGridSize(e,n,o)})),Ko(e,sx)}}),Ky.config({}),ag.config((o=t.columns,r="normal",1===o?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===o?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:"color"===r?".tox-swatches__row":".tox-collection__group",cell:"color"===r?"."+lh:"."+sh}})),mg("collection-events",s)]),eventOrder:((e={})[Eo()]=["disabling","alloy.base.behaviour","collection-events"],e)});return $y(u,f,["tox-form__group--collection"],[])},fx=r([$n("data"),oe("inputAttributes",{}),oe("inputStyles",{}),oe("tag","input"),oe("inputClasses",[]),pa("onSetValue"),oe("styles",{}),oe("eventOrder",{}),Wl("inputBehaviours",[Ul,bg]),oe("selectOnFocus",!0)]),dx=function(t){return uc([bg.config({onFocus:t.selectOnFocus?function(t){var n=t.element,e=ru(n);n.dom.setSelectionRange(0,e.length)}:e})])},mx=function(t){return{tag:t.tag,attributes:d({type:"text"},t.inputAttributes),styles:t.inputStyles,classes:t.inputClasses}},gx=qf({name:"Input",configFields:fx(),factory:function(t,n){return{uid:t.uid,dom:mx(t),components:[],behaviours:d(d({},dx(e=t)),Xl(e.inputBehaviours,[Ul.config({store:d(d({mode:"manual"},e.data.map((function(t){return{initialValue:t}})).getOr({})),{getValue:function(t){return ru(t.element)},setValue:function(t,n){ru(t.element)!==n&&iu(t.element,n)}}),onSetValue:e.onSetValue})])),eventOrder:t.eventOrder};var e}}),px={},hx={exports:px};gy=void 0,py=px,hy=hx,vy=void 0,function(e){"object"==n(py)&&void 0!==hy?hy.exports=e():"function"==typeof gy&&gy.amd?gy([],e):("undefined"!=typeof window?window:"undefined"!=typeof t?t:"undefined"!=typeof self?self:this).EphoxContactWrapper=e()}((function(){return function t(n,e,o){function r(u,a){if(!e[u]){if(!n[u]){var c="function"==typeof vy&&vy;if(!a&&c)return c(u,!0);if(i)return i(u,!0);var s=new Error("Cannot find module '"+u+"'");throw s.code="MODULE_NOT_FOUND",s}var l=e[u]={exports:{}};n[u][0].call(l.exports,(function(t){return r(n[u][1][t]||t)}),l,l.exports,t,n,e,o)}return e[u].exports}for(var i="function"==typeof vy&&vy,u=0;u<o.length;u++)r(o[u]);return r}({1:[function(t,n,e){var o,r,i=n.exports={};function u(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function c(t){if(o===setTimeout)return setTimeout(t,0);if((o===u||!o)&&setTimeout)return o=setTimeout,setTimeout(t,0);try{return o(t,0)}catch(n){try{return o.call(null,t,0)}catch(n){return o.call(this,t,0)}}}!function(){try{o="function"==typeof setTimeout?setTimeout:u}catch(t){o=u}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var s,l=[],f=!1,d=-1;function m(){f&&s&&(f=!1,s.length?l=s.concat(l):d=-1,l.length&&g())}function g(){if(!f){var t=c(m);f=!0;for(var n=l.length;n;){for(s=l,l=[];++d<n;)s&&s[d].run();d=-1,n=l.length}s=null,f=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(n){try{return r.call(null,t)}catch(n){return r.call(this,t)}}}(t)}}function p(t,n){this.fun=t,this.array=n}function h(){}i.nextTick=function(t){var n=new Array(arguments.length-1);if(1<arguments.length)for(var e=1;e<arguments.length;e++)n[e-1]=arguments[e];l.push(new p(t,n)),1!==l.length||f||c(g)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=h,i.addListener=h,i.once=h,i.off=h,i.removeListener=h,i.removeAllListeners=h,i.emit=h,i.prependListener=h,i.prependOnceListener=h,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(t,e,o){(function(t){function o(){}function r(t){if("object"!=n(this))throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(t,this)}function i(t,n){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,r._immediateFn((function(){var e,o=1===t._state?n.onFulfilled:n.onRejected;if(null!==o){try{e=o(t._value)}catch(d){return void a(n.promise,d)}u(n.promise,e)}else(1===t._state?u:a)(n.promise,t._value)}))):t._deferreds.push(n)}function u(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==n(e)||"function"==typeof e)){var o=e.then;if(e instanceof r)return t._state=3,t._value=e,void c(t);if("function"==typeof o)return void l((i=o,s=e,function(){i.apply(s,arguments)}),t)}t._state=1,t._value=e,c(t)}catch(u){a(t,u)}var i,s}function a(t,n){t._state=2,t._value=n,c(t)}function c(t){2===t._state&&0===t._deferreds.length&&r._immediateFn((function(){t._handled||r._unhandledRejectionFn(t._value)}));for(var n=0,e=t._deferreds.length;n<e;n++)i(t,t._deferreds[n]);t._deferreds=null}function s(t,n,e){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof n?n:null,this.promise=e}function l(t,n){var e=!1;try{t((function(t){e||(e=!0,u(n,t))}),(function(t){e||(e=!0,a(n,t))}))}catch(o){if(e)return;e=!0,a(n,o)}}var f,d;f=this,d=setTimeout,r.prototype["catch"]=function(t){return this.then(null,t)},r.prototype.then=function(t,n){var e=new this.constructor(o);return i(this,new s(t,n,e)),e},r.all=function(t){var e=Array.prototype.slice.call(t);return new r((function(t,r){if(0===e.length)return t([]);for(var i=e.length,u=0;u<e.length;u++)!function u(a,c){try{if(c&&("object"==n(c)||"function"==typeof c)){var s=c.then;if("function"==typeof s)return void s.call(c,(function(t){u(a,t)}),r)}e[a]=c,0==--i&&t(e)}catch(o){r(o)}}(u,e[u])}))},r.resolve=function(t){return t&&"object"==n(t)&&t.constructor===r?t:new r((function(n){n(t)}))},r.reject=function(t){return new r((function(n,e){e(t)}))},r.race=function(t){return new r((function(n,e){for(var o=0,r=t.length;o<r;o++)t[o].then(n,e)}))},r._immediateFn="function"==typeof t?function(n){t(n)}:function(t){d(t,0)},r._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},r._setImmediateFn=function(t){r._immediateFn=t},r._setUnhandledRejectionFn=function(t){r._unhandledRejectionFn=t},void 0!==e&&e.exports?e.exports=r:f.Promise||(f.Promise=r)}).call(this,t("timers").setImmediate)},{timers:3}],3:[function(t,n,e){(function(n,o){var r=t("process/browser.js").nextTick,i=Function.prototype.apply,u=Array.prototype.slice,a={},c=0;function s(t,n){this._id=t,this._clearFn=n}e.setTimeout=function(){return new s(i.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new s(i.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t.close()},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(t,n){clearTimeout(t._idleTimeoutId),t._idleTimeout=n},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var n=t._idleTimeout;0<=n&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),n))},e.setImmediate="function"==typeof n?n:function(t){var n=c++,o=!(arguments.length<2)&&u.call(arguments,1);return a[n]=!0,r((function(){a[n]&&(o?t.apply(null,o):t.call(null),e.clearImmediate(n))})),n},e.clearImmediate="function"==typeof o?o:function(t){delete a[t]}}).call(this,t("timers").setImmediate,t("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(t,n,e){var o=t("promise-polyfill"),r="undefined"!=typeof window?window:Function("return this;")();n.exports={boltExport:r.Promise||o}},{"promise-polyfill":2}]},{},[4])(4)}));var vx,bx,yx=hx.exports.boltExport,xx=function t(n){var e=C.none(),o=[],r=function(t){i()?a(t):o.push(t)},i=function(){return e.isSome()},u=function(t){G(t,a)},a=function(t){e.each((function(n){setTimeout((function(){t(n)}),0)}))};return n((function(t){i()||(e=C.some(t),u(o),o=[])})),{get:r,map:function(n){return t((function(t){r((function(e){t(n(e))}))}))},isReady:i}},wx={nu:xx,pure:function(t){return xx((function(n){n(t)}))}},Sx=function(t){setTimeout((function(){throw t}),0)},kx=function t(n){var e=function(t){n().then(t,Sx)};return{map:function(e){return t((function(){return n().then(e)}))},bind:function(e){return t((function(){return n().then((function(t){return e(t).toPromise()}))}))},anonBind:function(e){return t((function(){return n().then((function(){return e.toPromise()}))}))},toLazy:function(){return wx.nu(e)},toCached:function(){var e=null;return t((function(){return null===e&&(e=n()),e}))},toPromise:n,get:e}},Cx=function(t){return kx((function(){return new yx(t)}))},Ox=function(t){return kx((function(){return yx.resolve(t)}))},_x=["input","textarea"],Tx=function(t){var n=pr(t);return z(_x,n)},Ex=function(t,n){var e=n.getRoot(t).getOr(t.element);Li(e,n.invalidClass),n.notify.each((function(n){Tx(t.element)&&Kr(t.element,"aria-invalid",!1),n.getContainer(t).each((function(t){Yr(t,n.validHtml)})),n.onValid(t)}))},Dx=function(t,n,e,o){var r=n.getRoot(t).getOr(t.element);Vi(r,n.invalidClass),n.notify.each((function(n){Tx(t.element)&&Kr(t.element,"aria-invalid",!0),n.getContainer(t).each((function(t){Yr(t,o)})),n.onInvalid(t,o)}))},Bx=function(t,n,e){return n.validator.fold((function(){return Ox(ft.value(!0))}),(function(n){return n.validate(t)}))},Ax=function(t,n,e){return n.notify.each((function(n){n.onValidate(t)})),Bx(t,n).map((function(e){return t.getSystem().isConnected()?e.fold((function(e){return Dx(t,n,0,e),ft.error(e)}),(function(e){return Ex(t,n),ft.value(e)})):ft.error("No longer in system")}))},Mx=Object.freeze({__proto__:null,markValid:Ex,markInvalid:Dx,query:Bx,run:Ax,isInvalid:function(t,n){var e=n.getRoot(t).getOr(t.element);return zi(e,n.invalidClass)}}),Fx=Object.freeze({__proto__:null,events:function(t,n){return t.validator.map((function(n){return nr([rr(n.onEvent,(function(n){Ax(n,t).get(i)}))].concat(n.validateOnLoad?[fr((function(n){Ax(n,t).get(e)}))]:[]))})).getOr({})}}),Ix=[Un("invalidClass"),oe("getRoot",C.none),ee("notify",[oe("aria","alert"),oe("getContainer",C.none),oe("validHtml",""),pa("onValid"),pa("onInvalid"),pa("onValidate")]),ee("validator",[Un("validate"),oe("onEvent","input"),oe("validateOnLoad",!0)])],Rx=cc({fields:Ix,name:"invalidating",active:Fx,apis:Mx,extra:{validation:function(t){return function(n){var e=Ul.getValue(n);return Ox(t(e))}}}}),Px=Object.freeze({__proto__:null,getCoupled:function(t,n,e,o){return e.getOrCreate(t,n,o)}}),Vx=[Wn("others",Tn(ft.value,In()))],Hx=cc({fields:Vx,name:"coupling",apis:Px,state:Object.freeze({__proto__:null,init:function(){var t={},n=r({});return Si({readState:n,getOrCreate:function(n,e,o){var r=_t(e.others);if(r)return Rt(t,o).getOrThunk((function(){var r=Rt(e.others,o).getOrDie("No information found for coupled component: "+o)(n),i=n.getSystem().build(r);return t[o]=i}));throw new Error("Cannot find coupled component: "+o+". Known coupled components: "+JSON.stringify(r,null,2))}})}})}),Lx=r("sink"),zx=r(Sf({name:Lx(),overrides:r({dom:{tag:"div"},behaviours:uc([nl.config({useFixed:l})]),events:nr([sr(po()),sr(ao()),sr(yo())])})}));(bx=vx=vx||{})[bx.HighlightFirst=0]="HighlightFirst",bx[bx.HighlightNone=1]="HighlightNone";var Nx,jx,Ux,Wx,Gx,Xx,Yx=function(t,n){var e=t.getHotspot(n).getOr(n),o=t.getAnchorOverrides();return t.layouts.fold((function(){return{anchor:"hotspot",hotspot:e,overrides:o}}),(function(t){return{anchor:"hotspot",hotspot:e,overrides:o,layouts:t}}))},qx=function(t,n,e,o,r,i,u){var a,c,s,l,f,m,g,p,h,v,b=Yx(t,e);return(c=b,l=o,f=r,m=u,g=n,p=s=e,h=(0,(a=t).fetch)(p).map(g),v=Qx(s,a),h.map((function(t){return t.bind((function(t){return C.from(tp.sketch(d(d({},f.menu()),{uid:di(""),data:t,highlightImmediately:m===vx.HighlightFirst,onOpenMenu:function(t,n){var e=v().getOrDie();nl.position(e,c,n),kl.decloak(l)},onOpenSubmenu:function(t,n,e){var o=v().getOrDie();nl.position(o,{anchor:"submenu",item:n},e),kl.decloak(l)},onRepositionMenu:function(t,n,e){var o=v().getOrDie();nl.position(o,c,n),G(e,(function(t){nl.position(o,{anchor:"submenu",item:t.triggeringItem},t.triggeredMenu)}))},onEscape:function(){return bg.focus(s),kl.close(l),C.some(!0)}})))}))}))).map((function(t){return t.fold((function(){kl.isOpen(o)&&kl.close(o)}),(function(t){kl.cloak(o),kl.open(o,t),i(o)})),o}))},Kx=function(t,n,e,o,r,i,u){return kl.close(o),Ox(o)},Jx=function(t,n,e,o,r,i){var u=Hx.getCoupled(e,"sandbox");return(kl.isOpen(u)?Kx:qx)(t,n,e,u,o,r,i)},$x=function(t,n,e){var o,r,i=nd.getCurrent(n).getOr(n),u=Tu(t.element);e?Ki(i.element,"min-width",u+"px"):(o=i.element,r=u,_u.set(o,r))},Qx=function(t,n){return t.getSystem().getByUid(n.uid+"-"+Lx()).map((function(t){return function(){return ft.value(t)}})).getOrThunk((function(){return n.lazySink.fold((function(){return function(){return ft.error(new Error("No internal sink is specified, nor could an external sink be found"))}}),(function(n){return function(){return n(t)}}))}))},Zx=function(t){kl.getState(t).each((function(t){tp.repositionMenus(t)}))},tw=function(t,n,e){var o=Qu(),r=Qx(n,t);return{dom:{tag:"div",classes:t.sandboxClasses,attributes:{id:o.id,role:"listbox"}},behaviours:ql(t.sandboxBehaviours,[Ul.config({store:{mode:"memory",initialValue:n}}),kl.config({onOpen:function(r,i){var u=Yx(t,n);o.link(n.element),t.matchWidth&&$x(u.hotspot,i,t.useMinWidth),t.onOpen(u,r,i),void 0!==e&&void 0!==e.onOpen&&e.onOpen(r,i)},onClose:function(t,r){o.unlink(n.element),void 0!==e&&void 0!==e.onClose&&e.onClose(t,r)},isPartOf:function(t,e,o){return ta(e,o)||ta(n,o)},getAttachPoint:function(){return r().getOrDie()}}),nd.config({find:function(t){return kl.getState(t).bind((function(t){return nd.getCurrent(t)}))}}),dc.config({channels:d(d({},El({isExtraPart:s})),Bl({doReposition:Zx}))})])}},nw=function(t){var n=Hx.getCoupled(t,"sandbox");Zx(n)},ew=function(){return[oe("sandboxClasses",[]),Yl("sandboxBehaviours",[nd,dc,kl,Ul])]},ow=r([Un("dom"),Un("fetch"),pa("onOpen"),ha("onExecute"),oe("getHotspot",C.some),oe("getAnchorOverrides",r({})),Jc(),Wl("dropdownBehaviours",[Bg,Hx,ag,bg]),Un("toggleClass"),oe("eventOrder",{}),$n("lazySink"),oe("matchWidth",!1),oe("useMinWidth",!1),$n("role")].concat(ew())),rw=r([wf({schema:[da()],name:"menu",defaults:function(t){return{onExecute:t.onExecute}}}),zx()]),iw=Kf({name:"Dropdown",configFields:ow(),partFields:rw(),factory:function(t,n,o,r){var i,u,a=function(t){kl.getState(t).each((function(t){tp.highlightPrimary(t)}))},c={expand:function(n){Bg.isOn(n)||Jx(t,(function(t){return t}),n,r,e,vx.HighlightNone).get(e)},open:function(n){Bg.isOn(n)||Jx(t,(function(t){return t}),n,r,e,vx.HighlightFirst).get(e)},isOpen:Bg.isOn,close:function(n){Bg.isOn(n)&&Jx(t,(function(t){return t}),n,r,e,vx.HighlightFirst).get(e)},repositionMenus:function(t){Bg.isOn(t)&&nw(t)}},s=function(t,n){return $o(t),C.some(!0)};return{uid:t.uid,dom:t.dom,components:n,behaviours:Xl(t.dropdownBehaviours,[Bg.config({toggleClass:t.toggleClass,aria:{mode:"expanded"}}),Hx.config({others:{sandbox:function(n){return tw(t,n,{onOpen:function(){return Bg.on(n)},onClose:function(){return Bg.off(n)}})}}}),ag.config({mode:"special",onSpace:s,onEnter:s,onDown:function(t,n){var e;return iw.isOpen(t)?(e=Hx.getCoupled(t,"sandbox"),a(e)):iw.open(t),C.some(!0)},onEscape:function(t,n){return iw.isOpen(t)?(iw.close(t),C.some(!0)):C.none()}}),bg.config({})]),events:Mg(C.some((function(n){Jx(t,(function(t){return t}),n,r,a,vx.HighlightFirst).get(e)}))),eventOrder:d(d({},t.eventOrder),((i={})[Eo()]=["disabling","toggling","alloy.base.behaviour"],i)),apis:c,domModification:{attributes:d(d({"aria-haspopup":"true"},t.role.fold((function(){return{}}),(function(t){return{role:t}}))),"button"===t.dom.tag?{type:(u="type",Rt(t.dom,"attributes").bind((function(t){return Rt(t,u)})).getOr("button"))}:{})}}},apis:{open:function(t,n){return t.open(n)},expand:function(t,n){return t.expand(n)},close:function(t,n){return t.close(n)},isOpen:function(t,n){return t.isOpen(n)},repositionMenus:function(t,n){return t.repositionMenus(n)}}}),uw=cc({fields:[],name:"unselecting",active:Object.freeze({__proto__:null,events:function(){return nr([er(wo(),l)])},exhibit:function(){return Ci({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}})}),aw=ii("color-input-change"),cw=ii("color-swatch-change"),sw=ii("color-picker-cancel"),lw=function(t,n,o){var r,i,u=Xy.parts.field({factory:gx,inputClasses:["tox-textfield"],onSetValue:function(t){return Rx.run(t).get(e)},inputBehaviours:uc([pv.config({disabled:n.providers.isDisabled}),Wv(),Ky.config({}),Rx.config({invalidClass:"tox-textbox-field-invalid",getRoot:function(t){return Or(t.element)},notify:{onValid:function(t){var n=Ul.getValue(t);Jo(t,aw,{color:n})}},validator:{validateOnLoad:!1,validate:function(t){var n=Ul.getValue(t);if(0===n.length)return Ox(ft.value(!0));var e=pe.fromTag("span");Ki(e,"background-color",n);var o=tu(e,"background-color").fold((function(){return ft.error("blah")}),(function(t){return ft.value(n)}));return Ox(o)}}})]),selectOnFocus:!1}),a=t.label.map((function(t){return tx(t,n.providers)})),c=function(t,n){Jo(t,cw,{value:n})},l=pp((r={dom:{tag:"span",attributes:{"aria-label":n.providers.translate("Color swatch")}},layouts:{onRtl:function(){return[za,La,Wa]},onLtr:function(){return[La,za,Wa]}},components:[],fetch:Kb(o.getColors(),o.hasCustomColors()),columns:o.getColorCols(),presets:"color",onItemAction:function(t,n){l.getOpt(t).each((function(t){"custom"===n?o.colorPicker((function(n){n.fold((function(){return Ko(t,sw)}),(function(n){c(t,n),Wb(n)}))}),"#ffffff"):c(t,"remove"===n?"":n)}))}},i=n,iw.sketch({dom:r.dom,components:r.components,toggleClass:"mce-active",dropdownBehaviours:uc([Xv(i.providers.isDisabled),Wv(),uw.config({}),Ky.config({})]),layouts:r.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:i.getSink,fetch:function(t){return Cx((function(t){return r.fetch(t)})).map((function(n){return C.from(wy(Nt(ty(ii("menu-value"),n,(function(n){r.onItemAction(t,n)}),r.columns,r.presets,ah.CLOSE_ON_EXECUTE,s,i.providers),{movement:ey(r.columns,r.presets)})))}))},parts:{menu:Sh(0,0,r.presets)}})));return Xy.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:a.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[u,l.asSpec()]}]),fieldBehaviours:uc([mg("form-field-events",[rr(aw,(function(n,e){l.getOpt(n).each((function(t){Ki(t.element,"background-color",e.event.color)})),Jo(n,nx,{name:t.name})})),rr(cw,(function(t,n){Xy.getField(t).each((function(e){Ul.setValue(e,n.event.value),nd.getCurrent(t).each(bg.focus)}))})),rr(sw,(function(t,n){Xy.getField(t).each((function(n){nd.getCurrent(t).each(bg.focus)}))}))])])})},fw=function(t,n,e){return{hue:t,saturation:n,value:e}},dw=ii("rgb-hex-update"),mw=ii("slider-update"),gw=ii("palette-update"),pw=Sf({schema:[Un("dom")],name:"label"}),hw=function(t){return Sf({name:t+"-edge",overrides:function(n){return n.model.manager.edgeActions[t].fold((function(){return{}}),(function(t){return{events:nr([ir(oo(),(function(n,e,o){return t(n,o)}),[n]),ir(ao(),(function(n,e,o){return t(n,o)}),[n]),ir(co(),(function(n,e,o){o.mouseIsDown.get()&&t(n,o)}),[n])])}}))}})},vw=hw("top-left"),bw=hw("top"),yw=hw("top-right"),xw=hw("right"),ww=hw("bottom-right"),Sw=hw("bottom"),kw=hw("bottom-left"),Cw=[pw,hw("left"),xw,bw,Sw,vw,yw,kw,ww,xf({name:"thumb",defaults:r({dom:{styles:{position:"absolute"}}}),overrides:function(t){return{events:nr([ar(oo(),t,"spectrum"),ar(ro(),t,"spectrum"),ar(io(),t,"spectrum"),ar(ao(),t,"spectrum"),ar(co(),t,"spectrum"),ar(lo(),t,"spectrum")])}}}),xf({schema:[de("mouseIsDown",(function(){return me(!1)}))],name:"spectrum",overrides:function(t){var n=t.model.manager,e=function(e,o){return n.getValueFromEvent(o).map((function(o){return n.setValueFrom(e,t,o)}))};return{behaviours:uc([ag.config({mode:"special",onLeft:function(e){return n.onLeft(e,t)},onRight:function(e){return n.onRight(e,t)},onUp:function(e){return n.onUp(e,t)},onDown:function(e){return n.onDown(e,t)}}),bg.config({})]),events:nr([rr(oo(),e),rr(ro(),e),rr(ao(),e),rr(co(),(function(n,o){t.mouseIsDown.get()&&e(n,o)}))])}}})],Ow=r("slider.change.value"),_w=function(t){var n=t.event.raw;return-1===n.type.indexOf("touch")?void 0!==n.clientX?C.some(n).map((function(t){return Su(t.clientX,t.clientY)})):C.none():void 0!==n.touches&&1===n.touches.length?C.some(n.touches[0]).map((function(t){return Su(t.clientX,t.clientY)})):C.none()},Tw=function(t){return t.model.minX},Ew=function(t){return t.model.minY},Dw=function(t){return t.model.minX-1},Bw=function(t){return t.model.minY-1},Aw=function(t){return t.model.maxX},Mw=function(t){return t.model.maxY},Fw=function(t){return t.model.maxX+1},Iw=function(t){return t.model.maxY+1},Rw=function(t,n,e){return n(t)-e(t)},Pw=function(t){return Rw(t,Aw,Tw)},Vw=function(t){return Rw(t,Mw,Ew)},Hw=function(t){return Pw(t)/2},Lw=function(t){return Vw(t)/2},zw=function(t){return t.stepSize},Nw=function(t){return t.snapToGrid},jw=function(t){return t.snapStart},Uw=function(t){return t.rounded},Ww=function(t,n){return void 0!==t[n+"-edge"]},Gw=function(t){return Ww(t,"left")},Xw=function(t){return Ww(t,"right")},Yw=function(t){return Ww(t,"top")},qw=function(t){return Ww(t,"bottom")},Kw=function(t){return t.model.value.get()},Jw=function(t){return{x:t}},$w=function(t){return{y:t}},Qw=function(t,n){return{x:t,y:n}},Zw=function(t,n){Jo(t,Ow(),{value:n})},tS=function(t,n,e,o){return t<n?t:e<t?e:t===n?n-1:Math.max(n,t-o)},nS=function(t,n,e,o){return e<t?t:t<n?n:t===e?e+1:Math.min(e,t+o)},eS=function(t,n,e){return Math.max(n,Math.min(e,t))},oS=function(t){var n=t.min,e=t.max,o=t.range,r=t.value,i=t.step,u=t.snap,a=t.snapStart,c=t.rounded,s=t.hasMinEdge,l=t.hasMaxEdge,f=t.minBound,d=t.maxBound,m=t.screenRange,g=s?n-1:n,p=l?e+1:e;if(r<f)return g;if(d<r)return p;var h,v,b,y,x,w,S,k=(x=r,w=f,S=d,Math.min(S,Math.max(x,w))-w),C=eS(k/m*o+n,g,p);return u&&n<=C&&C<=e?(h=C,v=n,b=e,y=i,a.fold((function(){var t=h-v,n=Math.round(t/y)*y;return eS(v+n,v-1,b+1)}),(function(t){var n=(h-t)%y,e=Math.round(n/y),o=Math.floor((h-t)/y),r=Math.floor((b-t)/y),i=t+Math.min(r,o+e)*y;return Math.max(t,i)}))):c?Math.round(C):C},rS=function(t){var n=t.min,e=t.max,o=t.range,r=t.value,i=t.hasMinEdge,u=t.hasMaxEdge,a=t.maxBound,c=t.maxOffset,s=t.centerMinEdge,l=t.centerMaxEdge;return r<n?i?0:s:e<r?u?a:l:(r-n)/o*c},iS="left",uS=function(t){return t.element.dom.getBoundingClientRect()},aS=function(t,n){return t[n]},cS=function(t){var n=uS(t);return aS(n,iS)},sS=function(t){var n=uS(t);return aS(n,"right")},lS=function(t){var n=uS(t);return aS(n,"top")},fS=function(t){var n=uS(t);return aS(n,"bottom")},dS=function(t){var n=uS(t);return aS(n,"width")},mS=function(t){var n=uS(t);return aS(n,"height")},gS=function(t,n,e){return(t+n)/2-e},pS=function(t,n){var e=uS(t),o=uS(n),r=aS(e,iS),i=aS(e,"right"),u=aS(o,iS);return gS(r,i,u)},hS=function(t,n){var e=uS(t),o=uS(n),r=aS(e,"top"),i=aS(e,"bottom"),u=aS(o,"top");return gS(r,i,u)},vS=function(t,n){Jo(t,Ow(),{value:n})},bS=function(t){return{x:t}},yS=function(t,n,e){var o={min:Tw(n),max:Aw(n),range:Pw(n),value:e,step:zw(n),snap:Nw(n),snapStart:jw(n),rounded:Uw(n),hasMinEdge:Gw(n),hasMaxEdge:Xw(n),minBound:cS(t),maxBound:sS(t),screenRange:dS(t)};return oS(o)},xS=function(t){return function(n,e){return o=n,i=(0<t?nS:tS)(Kw(r=e).x,Tw(r),Aw(r),zw(r)),vS(o,bS(i)),C.some(i).map(l);var o,r,i}},wS=function(t,n,e,o,r,i){var u,a,c,s,l,f,d,m,g,p=(a=i,c=e,s=o,l=r,f=dS(u=n),d=s.bind((function(t){return C.some(pS(t,u))})).getOr(0),m=l.bind((function(t){return C.some(pS(t,u))})).getOr(f),g={min:Tw(a),max:Aw(a),range:Pw(a),value:c,hasMinEdge:Gw(a),hasMaxEdge:Xw(a),minBound:cS(u),minOffset:0,maxBound:sS(u),maxOffset:f,centerMinEdge:d,centerMaxEdge:m},rS(g));return cS(n)-cS(t)+p},SS=xS(-1),kS=xS(1),CS=C.none,OS=C.none,_S={"top-left":C.none(),top:C.none(),"top-right":C.none(),right:C.some((function(t,n){Zw(t,Jw(Fw(n)))})),"bottom-right":C.none(),bottom:C.none(),"bottom-left":C.none(),left:C.some((function(t,n){Zw(t,Jw(Dw(n)))}))},TS=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){var o=yS(t,n,e),r=bS(o);return vS(t,r),o},setToMin:function(t,n){var e=Tw(n);vS(t,bS(e))},setToMax:function(t,n){var e=Aw(n);vS(t,bS(e))},findValueOfOffset:yS,getValueFromEvent:function(t){return _w(t).map((function(t){return t.left}))},findPositionOfValue:wS,setPositionFromValue:function(t,n,e,o){var r=Kw(e),i=wS(t,o.getSpectrum(t),r.x,o.getLeftEdge(t),o.getRightEdge(t),e),u=Tu(n.element)/2;Ki(n.element,"left",i-u+"px")},onLeft:SS,onRight:kS,onUp:CS,onDown:OS,edgeActions:_S}),ES=function(t,n){Jo(t,Ow(),{value:n})},DS=function(t){return{y:t}},BS=function(t,n,e){var o={min:Ew(n),max:Mw(n),range:Vw(n),value:e,step:zw(n),snap:Nw(n),snapStart:jw(n),rounded:Uw(n),hasMinEdge:Yw(n),hasMaxEdge:qw(n),minBound:lS(t),maxBound:fS(t),screenRange:mS(t)};return oS(o)},AS=function(t){return function(n,e){return o=n,i=(0<t?nS:tS)(Kw(r=e).y,Ew(r),Mw(r),zw(r)),ES(o,DS(i)),C.some(i).map(l);var o,r,i}},MS=function(t,n,e,o,r,i){var u,a,c,s,l,f,d,m,g,p=(a=i,c=e,s=o,l=r,f=mS(u=n),d=s.bind((function(t){return C.some(hS(t,u))})).getOr(0),m=l.bind((function(t){return C.some(hS(t,u))})).getOr(f),g={min:Ew(a),max:Mw(a),range:Vw(a),value:c,hasMinEdge:Yw(a),hasMaxEdge:qw(a),minBound:lS(u),minOffset:0,maxBound:fS(u),maxOffset:f,centerMinEdge:d,centerMaxEdge:m},rS(g));return lS(n)-lS(t)+p},FS=C.none,IS=C.none,RS=AS(-1),PS=AS(1),VS={"top-left":C.none(),top:C.some((function(t,n){Zw(t,$w(Bw(n)))})),"top-right":C.none(),right:C.none(),"bottom-right":C.none(),bottom:C.some((function(t,n){Zw(t,$w(Iw(n)))})),"bottom-left":C.none(),left:C.none()},HS=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){var o=BS(t,n,e),r=DS(o);return ES(t,r),o},setToMin:function(t,n){var e=Ew(n);ES(t,DS(e))},setToMax:function(t,n){var e=Mw(n);ES(t,DS(e))},findValueOfOffset:BS,getValueFromEvent:function(t){return _w(t).map((function(t){return t.top}))},findPositionOfValue:MS,setPositionFromValue:function(t,n,e,o){var r=Kw(e),i=MS(t,o.getSpectrum(t),r.y,o.getTopEdge(t),o.getBottomEdge(t),e),u=yu(n.element)/2;Ki(n.element,"top",i-u+"px")},onLeft:FS,onRight:IS,onUp:RS,onDown:PS,edgeActions:VS}),LS=function(t,n){Jo(t,Ow(),{value:n})},zS=function(t,n){return{x:t,y:n}},NS=function(t,n){return function(e,o){return i=e,u=o,a=0<t?nS:tS,c=(r=n)?Kw(u).x:a(Kw(u).x,Tw(u),Aw(u),zw(u)),s=r?a(Kw(u).y,Ew(u),Mw(u),zw(u)):Kw(u).y,LS(i,zS(c,s)),C.some(c).map(l);var r,i,u,a,c,s}},jS=_w,US=NS(-1,!1),WS=NS(1,!1),GS=NS(-1,!0),XS=NS(1,!0),YS={"top-left":C.some((function(t,n){Zw(t,Qw(Dw(n),Bw(n)))})),top:C.some((function(t,n){Zw(t,Qw(Hw(n),Bw(n)))})),"top-right":C.some((function(t,n){Zw(t,Qw(Fw(n),Bw(n)))})),right:C.some((function(t,n){Zw(t,Qw(Fw(n),Lw(n)))})),"bottom-right":C.some((function(t,n){Zw(t,Qw(Fw(n),Iw(n)))})),bottom:C.some((function(t,n){Zw(t,Qw(Hw(n),Iw(n)))})),"bottom-left":C.some((function(t,n){Zw(t,Qw(Dw(n),Iw(n)))})),left:C.some((function(t,n){Zw(t,Qw(Dw(n),Lw(n)))}))},qS=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){var o=yS(t,n,e.left),r=BS(t,n,e.top),i=zS(o,r);return LS(t,i),i},setToMin:function(t,n){var e=Tw(n),o=Ew(n);LS(t,zS(e,o))},setToMax:function(t,n){var e=Aw(n),o=Mw(n);LS(t,zS(e,o))},getValueFromEvent:jS,setPositionFromValue:function(t,n,e,o){var r=Kw(e),i=wS(t,o.getSpectrum(t),r.x,o.getLeftEdge(t),o.getRightEdge(t),e),u=MS(t,o.getSpectrum(t),r.y,o.getTopEdge(t),o.getBottomEdge(t),e),a=Tu(n.element)/2,c=yu(n.element)/2;Ki(n.element,"left",i-a+"px"),Ki(n.element,"top",u-c+"px")},onLeft:US,onRight:WS,onUp:GS,onDown:XS,edgeActions:YS}),KS=Kf({name:"Slider",configFields:[oe("stepSize",1),oe("onChange",e),oe("onChoose",e),oe("onInit",e),oe("onDragStart",e),oe("onDragEnd",e),oe("snapToGrid",!1),oe("rounded",!0),$n("snapStart"),Wn("model",Fn("mode",{x:[oe("minX",0),oe("maxX",100),de("value",(function(t){return me(t.mode.minX)})),Un("getInitialValue"),ya("manager",TS)],y:[oe("minY",0),oe("maxY",100),de("value",(function(t){return me(t.mode.minY)})),Un("getInitialValue"),ya("manager",HS)],xy:[oe("minX",0),oe("maxX",100),oe("minY",0),oe("maxY",100),de("value",(function(t){return me({x:t.mode.minX,y:t.mode.minY})})),Un("getInitialValue"),ya("manager",qS)]})),Wl("sliderBehaviours",[ag,Ul]),de("mouseIsDown",(function(){return me(!1)}))],partFields:Cw,factory:function(t,n,e,o){var r,i=function(n){return Rf(n,t,"thumb")},u=function(n){return Rf(n,t,"spectrum")},a=function(n){return If(n,t,"left-edge")},c=function(n){return If(n,t,"right-edge")},s=function(n){return If(n,t,"top-edge")},f=function(n){return If(n,t,"bottom-edge")},d=t.model,m=d.manager,g=function(n,e){m.setPositionFromValue(n,e,t,{getLeftEdge:a,getRightEdge:c,getTopEdge:s,getBottomEdge:f,getSpectrum:u})},p=function(n,e){d.value.set(e);var o=i(n);return g(n,o),t.onChange(n,o,e),C.some(!0)},h=function(n){var e=t.mouseIsDown.get();t.mouseIsDown.set(!1),e&&If(n,t,"thumb").each((function(e){var o=d.value.get();t.onChoose(n,e,o)}))},v=function(n,e){e.stop(),t.mouseIsDown.set(!0),t.onDragStart(n,i(n))},b=function(n,e){e.stop(),t.onDragEnd(n,i(n)),h(n)};return{uid:t.uid,dom:t.dom,components:n,behaviours:Xl(t.sliderBehaviours,[ag.config({mode:"special",focusIn:function(n){return If(n,t,"spectrum").map(ag.focusIn).map(l)}}),Ul.config({store:{mode:"manual",getValue:function(t){return d.value.get()}}}),dc.config({channels:((r={})[_l()]={onReceive:h},r)})]),events:nr([rr(Ow(),(function(t,n){p(t,n.event.value)})),fr((function(n,e){var o=d.getInitialValue();d.value.set(o);var r=i(n);g(n,r);var a=u(n);t.onInit(n,r,a,d.value.get())})),rr(oo(),v),rr(io(),b),rr(ao(),v),rr(lo(),b)]),apis:{resetToMin:function(n){m.setToMin(n,t)},resetToMax:function(n){m.setToMax(n,t)},changeValue:p,refresh:g},domModification:{styles:{position:"relative"}}}},apis:{resetToMin:function(t,n){t.resetToMin(n)},resetToMax:function(t,n){t.resetToMax(n)},refresh:function(t,n){t.refresh(n)}}}),JS=[Wl("formBehaviours",[Ul])],$S=function(t){return"<alloy.field."+t+">"},QS=function(t,n){return{uid:t.uid,dom:t.dom,components:n,behaviours:Xl(t.formBehaviours,[Ul.config({store:{mode:"manual",getValue:function(n){var e=Vf(n,t);return Dt(e,(function(t,n){return t().bind((function(t){var e,o,r=nd.getCurrent(t);return e=r,o=new Error("Cannot find a current component to extract the value from for form part '"+n+"': "+ni(t.element)),e.fold((function(){return ft.error(o)}),ft.value)})).map(Ul.getValue)}))},setValue:function(n,e){Et(e,(function(e,o){If(n,t,o).each((function(t){nd.getCurrent(t).each((function(t){Ul.setValue(t,e)}))}))}))}}})]),apis:{getField:function(n,e){return If(n,t,e).bind(nd.getCurrent)}}}},ZS={getField:xi((function(t,n,e){return t.getField(n,e)})),sketch:function(t){var n,e=(n=[],{field:function(t,e){return n.push(t),Df("form",$S(t),e)},record:function(){return n}}),o=t(e),r=e.record(),i=W(r,(function(t){return xf({name:t,pname:$S(t)})}));return Wf("form",JS,i,QS,o)}},tk=ii("valid-input"),nk=ii("invalid-input"),ek=ii("validating-input"),ok="colorcustom.rgb.",rk=function(t,n,o,r){var i=function(o,r,i,u,a){var c,s,l=t(ok+"range"),f=[Xy.parts.label({dom:{tag:"label",innerHtml:i,attributes:{"aria-label":u}}}),Xy.parts.field({data:a,factory:gx,inputAttributes:d({type:"text"},"hex"===r?{"aria-live":"polite"}:{}),inputClasses:[n("textfield")],inputBehaviours:uc([(c=r,s=o,Rx.config({invalidClass:n("invalid"),notify:{onValidate:function(t){Jo(t,ek,{type:c})},onValid:function(t){Jo(t,tk,{type:c,value:Ul.getValue(t)})},onInvalid:function(t){Jo(t,nk,{type:c,value:Ul.getValue(t)})}},validator:{validate:function(n){var e=Ul.getValue(n),o=s(e)?ft.value(!0):ft.error(t("aria.input.invalid"));return Ox(o)},validateOnLoad:!1}})),Ky.config({})]),onSetValue:function(t){Rx.isInvalid(t)&&Rx.run(t).get(e)}})],m="hex"!==r?[Xy.parts["aria-descriptor"]({text:l})]:[];return{dom:{tag:"div",attributes:{role:"presentation"}},components:f.concat(m)}},u=function(t,n){var e=n.red,o=n.green,r=n.blue;Ul.setValue(t,{red:e,green:o,blue:r})},a=pp({dom:{tag:"div",classes:[n("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),c=function(t,n){a.getOpt(t).each((function(t){Ki(t.element,"background-color","#"+n.value)}))};return qf({factory:function(){var e={red:me(C.some(255)),green:me(C.some(255)),blue:me(C.some(255)),hex:me(C.some("ffffff"))},s=function(t){return e[t].get()},l=function(t,n){e[t].set(n)},f=function(t){var n=t.red,e=t.green,o=t.blue;l("red",C.some(n)),l("green",C.some(e)),l("blue",C.some(o))},d=function(t,n){var e=n.event;"hex"!==e.type?l(e.type,C.none()):r(t)},m=function(t,n,e){var o=parseInt(e,10);l(n,C.some(o)),s("red").bind((function(t){return s("green").bind((function(n){return s("blue").map((function(e){return Db(t,n,e,1)}))}))})).each((function(n){var e,o,r=(e=t,o=kb(n),ZS.getField(e,"hex").each((function(t){bg.isFocused(t)||Ul.setValue(e,{hex:o.value})})),o);c(t,r)}))},g=function(t,n){var e=n.event;"hex"===e.type?function(t,n){o(t);var e=vb(n);l("hex",C.some(n));var r=Mb(e);u(t,r),f(r),Jo(t,dw,{hex:e}),c(t,e)}(t,e.value):m(t,e.type,e.value)},p=function(n){return{label:t(ok+n+".label"),description:t(ok+n+".description")}},h=p("red"),v=p("green"),b=p("blue"),y=p("hex");return Nt(ZS.sketch((function(e){return{dom:{tag:"form",classes:[n("rgb-form")],attributes:{"aria-label":t("aria.color.picker")}},components:[e.field("red",Xy.sketch(i(Bb,"red",h.label,h.description,255))),e.field("green",Xy.sketch(i(Bb,"green",v.label,v.description,255))),e.field("blue",Xy.sketch(i(Bb,"blue",b.label,b.description,255))),e.field("hex",Xy.sketch(i(xb,"hex",y.label,y.description,"ffffff"))),a.asSpec()],formBehaviours:uc([Rx.config({invalidClass:n("form-invalid")}),mg("rgb-form-events",[rr(tk,g),rr(nk,d),rr(ek,d)])])}})),{apis:{updateHex:function(t,n){var e,o;Ul.setValue(t,{hex:n.value}),e=t,o=Mb(n),u(e,o),f(o),c(t,n)}}})},name:"RgbForm",configFields:[],apis:{updateHex:function(t,n,e){t.updateHex(n,e)}},extraApis:{}})},ik=function(t,n){var e=KS.parts.spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[n("sv-palette-spectrum")]}}),o=KS.parts.thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[n("sv-palette-thumb")],innerHtml:"<div class="+n("sv-palette-inner-thumb")+' role="presentation"></div>'}}),i=function(t,n){var e,o,r=t.width,i=t.height,u=t.getContext("2d");null!==u&&(u.fillStyle=n,u.fillRect(0,0,r,i),(e=u.createLinearGradient(0,0,r,0)).addColorStop(0,"rgba(255,255,255,1)"),e.addColorStop(1,"rgba(255,255,255,0)"),u.fillStyle=e,u.fillRect(0,0,r,i),(o=u.createLinearGradient(0,0,0,i)).addColorStop(0,"rgba(0,0,0,0)"),o.addColorStop(1,"rgba(0,0,0,1)"),u.fillStyle=o,u.fillRect(0,0,r,i))};return qf({factory:function(t){var u=r({x:0,y:0}),a=uc([nd.config({find:C.some}),bg.config({})]);return KS.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[n("sv-palette")]},model:{mode:"xy",getInitialValue:u},rounded:!1,components:[e,o],onChange:function(t,n,e){Jo(t,gw,{value:e})},onInit:function(t,n,e,o){i(e.element.dom,Ib(Rb))},sliderBehaviours:a})},name:"SaturationBrightnessPalette",configFields:[],apis:{setRgba:function(t,n,e){var o,r;o=e,r=n.components()[0].element.dom,i(r,Ib(o))}},extraApis:{}})},uk=function(t,n){return qf({name:"ColourPicker",configFields:[Un("dom"),oe("onValidHex",e),oe("onInvalidHex",e)],factory:function(e){var o,i,u,a,c,s=rk(t,n,e.onValidHex,e.onInvalidHex),l=ik(0,n),f={paletteRgba:me(Rb)},d=pp(l.sketch({})),m=pp(s.sketch({})),g=function(t,n){d.getOpt(t).each((function(t){var e=Mb(n);f.paletteRgba.set(e),l.setRgba(t,e)}))},p=function(t,n){m.getOpt(t).each((function(t){s.updateHex(t,n)}))},h=function(t,n,e){G(e,(function(e){e(t,n)}))};return{uid:e.uid,dom:e.dom,components:[d.asSpec(),(u=n,a=KS.parts.spectrum({dom:{tag:"div",classes:[u("hue-slider-spectrum")],attributes:{role:"presentation"}}}),c=KS.parts.thumb({dom:{tag:"div",classes:[u("hue-slider-thumb")],attributes:{role:"presentation"}}}),KS.sketch({dom:{tag:"div",classes:[u("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:r({y:0})},components:[a,c],sliderBehaviours:uc([bg.config({})]),onChange:function(t,n,e){Jo(t,mw,{value:e})}})),m.asSpec()],behaviours:uc([mg("colour-picker-events",[rr(gw,(i=[p],function(t,n){var e,o,r,u,a,c,s,l,d,m=n.event.value,g=f.paletteRgba.get(),p=(u=r=0,a=(e=g).red/255,c=e.green/255,s=e.blue/255,l=Math.min(a,Math.min(c,s)),d=Math.max(a,Math.max(c,s)),l===d?fw(0,0,100*(u=l)):(r=60*((r=a===l?3:s===l?1:5)-(a===l?c-s:s===l?a-c:s-a)/(d-l)),o=(d-l)/d,u=d,fw(Math.round(r),Math.round(100*o),Math.round(100*u)))),v=fw(p.hue,m.x,100-m.y),b=Ab(v),y=kb(b);h(t,y,i)})),rr(mw,(o=[g,p],function(t,n){var e,r,i,u=n.event.value,a=(e=u.y,r=fw((100-e)/100*360,100,100),i=Ab(r),kb(i));h(t,a,o)}))]),nd.config({find:function(t){return m.getOpt(t)}}),ag.config({mode:"acyclic"})])}}})},ak=function(){return nd.config({find:C.some})},ck=function(t){return nd.config({find:t.getOpt})},sk=function(t){return nd.config({find:function(n){return Dr(n.element,t).bind((function(t){return n.getSystem().getByDom(t).toOptional()}))}})},lk={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","colorcustom.sb.saturation":"Saturation","colorcustom.sb.brightness":"Brightness","colorcustom.sb.picker":"Saturation and Brightness Picker","colorcustom.sb.palette":"Saturation and Brightness Palette","colorcustom.sb.instructions":"Use arrow keys to select saturation and brightness, on x and y axes","colorcustom.hue.hue":"Hue","colorcustom.hue.slider":"Hue Slider","colorcustom.hue.palette":"Hue Palette","colorcustom.hue.instructions":"Use arrow keys to select a hue","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},fk=function(t){return lk[t]},dk=tinymce.util.Tools.resolve("tinymce.Resource"),mk=tinymce.util.Tools.resolve("tinymce.util.Tools"),gk=mn([oe("preprocess",i),oe("postprocess",i)]),pk=function(t,n,e){return Ul.config(Nt({store:{mode:"manual",getValue:n,setValue:e}},t.map((function(t){return{store:{initialValue:t}}})).getOr({})))},hk=function(t,n,e){return pk(t,(function(t){return n(t.element)}),(function(t,n){return e(t.element,n)}))},vk=function(t,n){var e=Bn("RepresentingConfigs.memento processors",gk,n);return Ul.config({store:{mode:"manual",getValue:function(n){var o=t.get(n),r=Ul.getValue(o);return e.postprocess(r)},setValue:function(n,o){var r=e.preprocess(o),i=t.get(n);Ul.setValue(i,r)}}})},bk=pk,yk=function(t){return hk(t,Xr,Yr)},xk=function(t){return Ul.config({store:{mode:"memory",initialValue:t}})},wk=function(t,n){var e=function(t,n){n.stop()},o=function(t){return function(n,e){G(t,(function(t){t(n,e)}))}},r=function(t,n){var e;pv.isDisabled(t)||(e=n.event.raw,u(t,e.dataTransfer.files))},i=function(t,n){var e=n.event.raw.target;u(t,e.files)},u=function(e,o){var r,i,u;Ul.setValue(e,(r=o,i=n,u=mk.explode(i.getSetting("images_file_types","jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp","string")),Y(at(r),(function(t){return N(u,(function(n){return Ce(t.name.toLowerCase(),"."+n.toLowerCase())}))})))),Jo(e,nx,{name:t.name})},a=pp({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:uc([mg("input-file-events",[sr(yo()),sr(Bo())])])}),c=t.label.map((function(t){return tx(t,n)})),s=Xy.parts.field({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:uc([xk([]),ak(),pv.config({}),Bg.config({toggleClass:"dragenter",toggleOnExecute:!1}),mg("dropzone-events",[rr("dragenter",o([e,Bg.toggle])),rr("dragleave",o([e,Bg.toggle])),rr("dragover",e),rr("drop",o([e,r])),rr(bo(),i)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p",innerHtml:n.translate("Drop an image here")}},gp.sketch({dom:{tag:"button",innerHtml:n.translate("Browse for an image"),styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[a.asSpec()],action:function(t){a.get(t).element.dom.click()},buttonBehaviours:uc([Ky.config({}),Xv(n.isDisabled),Wv()])})]}]}}}});return $y(c,s,["tox-form__group--stretched"],[])},Sk=ii("alloy-fake-before-tabstop"),kk=ii("alloy-fake-after-tabstop"),Ck=function(t){return{dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:t},behaviours:uc([bg.config({ignore:!0}),Ky.config({})])}},Ok=function(t){return{dom:{tag:"div",classes:["tox-navobj"]},components:[Ck([Sk]),t,Ck([kk])],behaviours:uc([sk(1)])}},_k=function(t,n){Jo(t,po(),{raw:{which:9,shiftKey:n}})},Tk=function(t,n){var e=n.element;zi(e,Sk)?_k(t,!0):zi(e,kk)&&_k(t,!1)},Ek=function(t){return Ty(t,["."+Sk,"."+kk].join(","),s)},Dk=!(We().browser.isIE()||We().browser.isEdge()),Bk=function(t,n){var e,o,r=Dk&&t.sandboxed,i=d(d({},t.label.map((function(t){return{title:t}})).getOr({})),r?{sandbox:"allow-scripts allow-same-origin"}:{}),u=(e=r,o=me(""),{getValue:function(t){return o.get()},setValue:function(t,n){var r;e?Kr(t.element,"srcdoc",n):(Kr(t.element,"src","javascript:''"),(r=t.element.dom.contentWindow.document).open(),r.write(n),r.close()),o.set(n)}}),a=t.label.map((function(t){return tx(t,n)})),c=Xy.parts.field({factory:{sketch:function(t){return Ok({uid:t.uid,dom:{tag:"iframe",attributes:i},behaviours:uc([Ky.config({}),bg.config({}),bk(C.none(),u.getValue,u.setValue)])})}}});return $y(a,c,["tox-form__group--stretched"],[])},Ak=function(t,n){return Ik(document.createElement("canvas"),t,n)},Mk=function(t){var n=Ak(t.width,t.height);return Fk(n).drawImage(t,0,0),n},Fk=function(t){return t.getContext("2d")},Ik=function(t,n,e){return t.width=n,t.height=e,t},Rk=function(t){return t.naturalWidth||t.width},Pk=function(t){return t.naturalHeight||t.height},Vk=window.Promise?window.Promise:(Nx=function(t){if("object"!=n(this))throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],Xx(t,Wx(Lk,this),Wx(zk,this))},jx=window,Ux=Nx.immediateFn||"function"==typeof jx.setImmediate&&jx.setImmediate||function(t){return setTimeout(t,1)},Wx=function(t,n){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return t.apply(n,e)}},Gx=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},Xx=function(t,n,e){var o=!1;try{t((function(t){o||(o=!0,n(t))}),(function(t){o||(o=!0,e(t))}))}catch(b){if(o)return;o=!0,e(b)}},Nx.prototype["catch"]=function(t){return this.then(null,t)},Nx.prototype.then=function(t,n){var e=this;return new Nx((function(o,r){Hk.call(e,new jk(t,n,o,r))}))},Nx.all=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var o=Array.prototype.slice.call(1===t.length&&Gx(t[0])?t[0]:t);return new Nx((function(t,e){if(0===o.length)return t([]);for(var r=o.length,i=function i(u,a){try{if(a&&("object"==n(a)||"function"==typeof a)){var c=a.then;if("function"==typeof c)return void c.call(a,(function(t){i(u,t)}),e)}o[u]=a,0==--r&&t(o)}catch(v){e(v)}},u=0;u<o.length;u++)i(u,o[u])}))},Nx.resolve=function(t){return t&&"object"==n(t)&&t.constructor===Nx?t:new Nx((function(n){n(t)}))},Nx.reject=function(t){return new Nx((function(n,e){e(t)}))},Nx.race=function(t){return new Nx((function(n,e){for(var o=0,r=t;o<r.length;o++)r[o].then(n,e)}))},Nx);function Hk(t){var n=this;null!==this._state?Ux((function(){var e,o=n._state?t.onFulfilled:t.onRejected;if(null!==o){try{e=o(n._value)}catch(h){return void t.reject(h)}t.resolve(e)}else(n._state?t.resolve:t.reject)(n._value)})):this._deferreds.push(t)}function Lk(t){try{if(t===this)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==n(t)||"function"==typeof t)){var e=t.then;if("function"==typeof e)return void Xx(Wx(e,t),Wx(Lk,this),Wx(zk,this))}this._state=!0,this._value=t,Nk.call(this)}catch(h){zk.call(this,h)}}function zk(t){this._state=!1,this._value=t,Nk.call(this)}function Nk(){for(var t=0,n=this._deferreds;t<n.length;t++){var e=n[t];Hk.call(this,e)}this._deferreds=[]}function jk(t,n,e,o){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof n?n:null,this.resolve=e,this.reject=o}var Uk,Wk,Gk,Xk,Yk=function(t){return new Vk((function(n,e){(function(t){var n=t.split(","),e=/data:([^;]+)/.exec(n[0]);if(!e)return C.none();for(var o=e[1],r=n[1],i=atob(r),u=i.length,a=Math.ceil(u/1024),c=new Array(a),s=0;s<a;++s){for(var l=1024*s,f=Math.min(1024+l,u),d=new Array(f-l),m=l,g=0;m<f;++g,++m)d[g]=i[m].charCodeAt(0);c[s]=new Uint8Array(d)}return C.some(new Blob(c,{type:o}))})(t).fold((function(){e("uri is not base64: "+t)}),n)}))},qk=function(t,n,e){return n=n||"image/png",F(HTMLCanvasElement.prototype.toBlob)?new Vk((function(o,r){t.toBlob((function(t){t?o(t):r()}),n,e)})):Yk(t.toDataURL(n,e))},Kk=function(t){return n=t,new Vk((function(t,e){var o=URL.createObjectURL(n),r=new Image,i=function(){r.removeEventListener("load",u),r.removeEventListener("error",a)},u=function(){i(),t(r)},a=function(){i(),e("Unable to load data of type "+n.type+": "+o)};r.addEventListener("load",u),r.addEventListener("error",a),r.src=o,r.complete&&setTimeout(u,0)})).then((function(t){Jk(t);var n=Ak(Rk(t),Pk(t));return Fk(n).drawImage(t,0,0),n}));var n},Jk=function(t){URL.revokeObjectURL(t.src)},$k=function(t,n,e){var o=n.type,i=r(o),u=r(e),a=function(n,e){return t.then((function(t){return r=e,o=(o=n)||"image/png",t.toDataURL(o,r);var o,r}))};return{getType:i,toBlob:function(){return Vk.resolve(n)},toDataURL:u,toBase64:function(){return e.split(",")[1]},toAdjustedBlob:function(n,e){return t.then((function(t){return qk(t,n,e)}))},toAdjustedDataURL:a,toAdjustedBase64:function(t,n){return a(t,n).then((function(t){return t.split(",")[1]}))},toCanvas:function(){return t.then(Mk)}}},Qk=function(t,n){return qk(t,n).then((function(n){return $k(Vk.resolve(t),n,t.toDataURL())}))},Zk=function(t){return n=t,new Vk((function(t){var e=new FileReader;e.onloadend=function(){t(e.result)},e.readAsDataURL(n)})).then((function(n){return $k(Kk(t),t,n)}));var n},tC=function(t,n,e){var o="string"==typeof t?parseFloat(t):t;return e<o?o=e:o<n&&(o=n),o},nC=function(){return[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1]},eC=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10],oC=function(t,n){for(var e,o=[],r=new Array(25),i=0;i<5;i++){for(var u=0;u<5;u++)o[u]=n[u+5*i];for(u=0;u<5;u++){for(var a=e=0;a<5;a++)e+=t[u+5*a]*o[a];r[u+5*i]=e}}return r},rC=function(t,n){return t.toCanvas().then((function(e){return iC(e,t.getType(),n)}))},iC=function(t,n,e){var o=Fk(t),r=function(t,n){for(var e,o,r,i,u=t.data,a=n[0],c=n[1],s=n[2],l=n[3],f=n[4],d=n[5],m=n[6],g=n[7],p=n[8],h=n[9],v=n[10],b=n[11],y=n[12],x=n[13],w=n[14],S=n[15],k=n[16],C=n[17],O=n[18],_=n[19],T=0;T<u.length;T+=4)e=u[T],o=u[T+1],r=u[T+2],i=u[T+3],u[T]=e*a+o*c+r*s+i*l+f,u[T+1]=e*d+o*m+r*g+i*p+h,u[T+2]=e*v+o*b+r*y+i*x+w,u[T+3]=e*S+o*k+r*C+i*O+_;return t}(o.getImageData(0,0,t.width,t.height),e);return o.putImageData(r,0,0),Qk(t,n)},uC=function(t,n,e){var o=Fk(t),r=function(t,n,e){for(var o=function(t,n,e){return e<t?t=e:t<n&&(t=n),t},r=Math.round(Math.sqrt(e.length)),i=Math.floor(r/2),u=t.data,a=n.data,c=t.width,s=t.height,l=0;l<s;l++)for(var f=0;f<c;f++){for(var d=0,m=0,g=0,p=0;p<r;p++)for(var h=0;h<r;h++){var v=o(f+h-i,0,c-1),b=4*(o(l+p-i,0,s-1)*c+v),y=e[p*r+h];d+=u[b]*y,m+=u[1+b]*y,g+=u[2+b]*y}var x=4*(l*c+f);a[x]=o(d,0,255),a[1+x]=o(m,0,255),a[2+x]=o(g,0,255)}return n}(o.getImageData(0,0,t.width,t.height),r=o.getImageData(0,0,t.width,t.height),e);return o.putImageData(r,0,0),Qk(t,n)},aC=function(t){return function(n,e){return rC(n,t(nC(),e))}},cC=(Uk=[-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0,0,0,0,0,1],function(t){return rC(t,Uk)}),sC=aC((function(t,n){return n=tC(255*n,-255,255),oC(t,[1,0,0,0,n,0,1,0,0,n,0,0,1,0,n,0,0,0,1,0,0,0,0,0,1])})),lC=aC((function(t,n){var e;return n=tC(n,-1,1),e=(n*=100)<0?127+n/100*127:127*(e=0===(e=n%1)?eC[n]:eC[Math.floor(n)]*(1-e)+eC[Math.floor(n)+1]*e)+127,oC(t,[e/127,0,0,0,.5*(127-e),0,e/127,0,0,.5*(127-e),0,0,e/127,0,.5*(127-e),0,0,0,1,0,0,0,0,0,1])})),fC=(Wk=[0,-1,0,-1,5,-1,0,-1,0],function(t){return e=Wk,(n=t).toCanvas().then((function(t){return uC(t,n.getType(),e)}));var n,e}),dC=(Gk=function(t,n){return 255*Math.pow(t/255,1-n)},function(t,n){return t.toCanvas().then((function(e){return function(t,n,e){for(var o=Fk(t),r=new Array(256),i=0;i<r.length;i++)r[i]=Gk(i,e);var u=function(t,n){for(var e=t.data,o=0;o<e.length;o+=4)e[o]=n[e[o]],e[o+1]=n[e[o+1]],e[o+2]=n[e[o+2]];return t}(o.getImageData(0,0,t.width,t.height),r);return o.putImageData(u,0,0),Qk(t,n)}(e,t.getType(),n)}))}),mC=function t(n,e,o){var r=Rk(n),i=Pk(n),u=e/r,a=o/i,c=!1;(u<.5||2<u)&&(u=u<.5?.5:2,c=!0),(a<.5||2<a)&&(a=a<.5?.5:2,c=!0);var s=gC(n,u,a);return c?s.then((function(n){return t(n,e,o)})):s},gC=function(t,n,e){return new Vk((function(o){var r=Rk(t),i=Pk(t),u=Math.floor(r*n),a=Math.floor(i*e),c=Ak(u,a);Fk(c).drawImage(t,0,0,r,i,0,0,u,a),o(c)}))},pC=function(t,n,e){var o=Ak(t.width,t.height),r=Fk(o),i=0,u=0;return 90!==(e=e<0?360+e:e)&&270!==e||Ik(o,o.height,o.width),90!==e&&180!==e||(i=o.width),270!==e&&180!==e||(u=o.height),r.translate(i,u),r.rotate(e*Math.PI/180),r.drawImage(t,0,0),Qk(o,n)},hC=function(t,n,e){var o=Ak(t.width,t.height),r=Fk(o);return"v"===e?(r.scale(1,-1),r.drawImage(t,0,-o.height)):(r.scale(-1,1),r.drawImage(t,-o.width,0)),Qk(o,n)},vC=function(t,n,e,o,r,i){var u=Ak(r,i);return Fk(u).drawImage(t,-e,-o),Qk(u,n)},bC=function(t){return cC(t)},yC=function(t){return fC(t)},xC=function(t,n){return dC(t,n)},wC=function(t,n,e,o){return rC(t,(r=nC(),u=e,a=o,i=tC(i=n,0,2),u=tC(u,0,2),a=tC(a,0,2),oC(r,[i,0,0,0,0,0,u,0,0,0,0,0,a,0,0,0,0,0,1,0,0,0,0,0,1])));var r,i,u,a},SC=function(t,n){return sC(t,n)},kC=function(t,n){return lC(t,n)},CC=function(t,n){return o=n,(e=t).toCanvas().then((function(t){return hC(t,e.getType(),o)}));var e,o},OC=function(t,n,e,o,r){return u=n,a=e,c=o,s=r,(i=t).toCanvas().then((function(t){return vC(t,i.getType(),u,a,c,s)}));var i,u,a,c,s},_C=function(t,n,e){return r=n,i=e,(o=t).toCanvas().then((function(t){return mC(t,r,i).then((function(t){return Qk(t,o.getType())}))}));var o,r,i},TC=function(t,n){return o=n,(e=t).toCanvas().then((function(t){return pC(t,e.getType(),o)}));var e,o},EC=function(t,n){return d({dom:{tag:"span",innerHtml:t,classes:["tox-icon","tox-tbtn__icon-wrap"]}},n)},DC=function(t,n){return EC(vp(t,n),{})},BC=function(t,n){return EC(vp(t,n),{behaviours:uc([dg.config({})])})},AC=function(t,n,e){return{dom:{tag:"span",innerHtml:e.translate(t),classes:[n+"__select-label"]},behaviours:uc([dg.config({})])}},MC=ii("toolbar.button.execute"),FC=((Xk={})[Eo()]=["disabling","alloy.base.behaviour","toggling","toolbar-button-events"],Xk),IC=ii("update-menu-text"),RC=ii("update-menu-icon"),PC=function(t,n,o){var r=me(e),i=t.text.map((function(t){return pp(AC(t,n,o.providers))})),a=t.icon.map((function(t){return pp(BC(t,o.providers.icons))})),c=function(t,n){var e=Ul.getValue(t);return bg.focus(e),Jo(e,"keydown",{raw:n.event.raw}),iw.close(e),C.some(!0)},s=t.role.fold((function(){return{}}),(function(t){return{role:t}})),l=t.tooltip.fold((function(){return{}}),(function(t){var n=o.providers.translate(t);return{title:n,"aria-label":n}}));return pp(iw.sketch(d(d(d({},t.uid?{uid:t.uid}:{}),s),{dom:{tag:"button",classes:[n,n+"--select"].concat(W(t.classes,(function(t){return n+"--"+t}))),attributes:d({},l)},components:Zv([a.map((function(t){return t.asSpec()})),i.map((function(t){return t.asSpec()})),C.some({dom:{tag:"div",classes:[n+"__select-chevron"],innerHtml:vp("chevron-down",o.providers.icons)}})]),matchWidth:!0,useMinWidth:!0,dropdownBehaviours:uc(g(t.dropdownBehaviours,[Xv((function(){return t.disabled||o.providers.isDisabled()})),Wv(),uw.config({}),dg.config({}),mg("dropdown-events",[Jv(t,r),$v(t,r)]),mg("menubutton-update-display-text",[rr(IC,(function(t,n){i.bind((function(n){return n.getOpt(t)})).each((function(t){dg.set(t,[du(o.providers.translate(n.event.text))])}))})),rr(RC,(function(t,n){a.bind((function(n){return n.getOpt(t)})).each((function(t){dg.set(t,[BC(n.event.icon,o.providers.icons)])}))}))])])),eventOrder:Nt(FC,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"]}),sandboxBehaviours:uc([ag.config({mode:"special",onLeft:c,onRight:c})]),lazySink:o.getSink,toggleClass:n+"--active",parts:{menu:Sh(0,t.columns,t.presets)},fetch:function(n){return Cx(u(t.fetch,n))}}))).asSpec()},VC=function(t){return"separator"===t.type},HC={type:"separator"},LC=function(t,n){var e=K(t,(function(t,e){return T(e)?""===e?t:"|"===e?0<t.length&&!VC(t[t.length-1])?t.concat([HC]):t:Pt(n,e.toLowerCase())?t.concat([n[e.toLowerCase()]]):t:t.concat([e])}),[]);return 0<e.length&&VC(e[e.length-1])&&e.pop(),e},zC=function(t,n){return Pt(t,"getSubmenuItems")?(o=n,r=(e=t).getSubmenuItems(),i=NC(r,o),{item:e,menus:Nt(i.menus,Qt(e.value,i.items)),expansions:Nt(i.expansions,Qt(e.value,e.value))}):{item:t,menus:{},expansions:{}};var e,o,r,i},NC=function(t,n){var e=LC(T(t)?t.split(" "):t,n);return q(e,(function(t,e){var o=function(t){if(VC(t))return t;var n=Rt(t,"value").getOrThunk((function(){return ii("generated-menu-item")}));return Nt({value:n},t)}(e),r=zC(o,n);return{menus:Nt(t.menus,r.menus),items:[r.item].concat(t.items),expansions:Nt(t.expansions,r.expansions)}}),{menus:{},expansions:{},items:[]})},jC=function(t,n,e,o){var r=ii("primary-menu"),i=NC(t,e.shared.providers.menuItems());if(0===i.items.length)return C.none();var u=xy(r,i.items,n,e,o),a=Dt(i.menus,(function(t,o){return xy(o,t,n,e,!1)})),c=Nt(a,Qt(r,u));return C.from(tp.tieredData(r,c,i.expansions))},UC=function(t){return{isDisabled:function(){return pv.isDisabled(t)},setDisabled:function(n){return pv.set(t,n)},setActive:function(n){var e=t.element;n?(Vi(e,"tox-tbtn--enabled"),Kr(e,"aria-pressed",!0)):(Li(e,"tox-tbtn--enabled"),Zr(e,"aria-pressed"))},isActive:function(){return zi(t.element,"tox-tbtn--enabled")}}},WC=function(t,n,e,o){return PC({text:t.text,icon:t.icon,tooltip:t.tooltip,role:o,fetch:function(n,o){t.fetch((function(t){o(jC(t,ah.CLOSE_ON_EXECUTE,e,!1))}))},onSetup:t.onSetup,getApi:UC,columns:1,presets:"normal",classes:[],dropdownBehaviours:[Ky.config({})]},n,e.shared)},GC=function(t,n,e){return function(o){o(W(t,(function(t){var o,r,i=t.text.fold((function(){return{}}),(function(t){return{text:t}}));return d(d({type:t.type,active:!1},i),{onAction:function(t){var o=!t.isActive();t.setActive(o),r.storage.set(o),e.shared.getSink().each((function(t){n().getOpt(t).each((function(t){gc(t.element),Jo(t,rx,{name:r.name,value:r.storage.get()})}))}))},onSetup:(o=r=t,function(t){t.setActive(o.storage.get())})})})))}},XC=function(t,n,e,o,r,i){void 0===e&&(e=[]);var u=n.fold((function(){return{}}),(function(t){return{action:t}})),a=d({buttonBehaviours:uc([Xv((function(){return t.disabled||i.isDisabled()})),Wv(),Ky.config({}),mg("button press",[or("click"),or("mousedown")])].concat(e)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]}},u),c=Nt(a,{dom:o});return Nt(c,{components:r})},YC=function(t,n,e,o){void 0===o&&(o=[]);var r={tag:"button",classes:["tox-tbtn"],attributes:t.tooltip.map((function(t){return{"aria-label":e.translate(t),title:e.translate(t)}})).getOr({})},i=t.icon.map((function(t){return DC(t,e.icons)})),u=Zv([i]);return XC(t,n,o,r,u,e)},qC=function(t,n,e,o){void 0===o&&(o=[]);var r=YC(t,C.some(n),e,o);return gp.sketch(r)},KC=function(t,n,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);var i=e.translate(t.text),u=t.icon?t.icon.map((function(t){return DC(t,e.icons)})):C.none(),a=u.isSome()?Zv([u]):[],c=u.isSome()?{}:{innerHtml:i},s=g(t.primary||t.borderless?["tox-button"]:["tox-button","tox-button--secondary"],u.isSome()?["tox-button--icon"]:[],t.borderless?["tox-button--naked"]:[],r),l=d(d({tag:"button",classes:s},c),{attributes:{title:i}});return XC(t,n,o,l,a,e)},JC=function(t,n,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);var i=KC(t,C.some(n),e,o,r);return gp.sketch(i)},$C=function(t,n){return function(e){"custom"===n?Jo(e,rx,{name:t,value:{}}):"submit"===n?Ko(e,ix):"cancel"===n?Ko(e,ox):console.error("Unknown button type: ",n)}},QC=function(t,n,o){if("menu"===n){var r=t,i=d(d({},t),{onSetup:function(n){return n.setDisabled(t.disabled),e},fetch:GC(r.items,(function(){return u}),o)}),u=pp(WC(i,"tox-tbtn",o,C.none()));return u.asSpec()}if("custom"===(s=n)||"cancel"===s||"submit"===s){var a=$C(t.name,n),c=d(d({},t),{borderless:!1});return JC(c,a,o.shared.providers,[])}var s;console.error("Unknown footer button type: ",n)},ZC=function(t,n){var e,o,r=$C(t.name,"custom");return e=C.none(),o=Xy.parts.field(d({factory:gp},KC(t,C.some(r),n,[xk(""),ak()]))),$y(e,o,[],[])},tO=r([oe("field1Name","field1"),oe("field2Name","field2"),va("onLockedChange"),ma(["lockClass"]),oe("locked",!1),Yl("coupledFieldBehaviours",[nd,Ul])]),nO=function(t,n){return xf({factory:Xy,name:t,overrides:function(t){return{fieldBehaviours:uc([mg("coupled-input-behaviour",[rr(vo(),(function(e){If(e,t,n).bind(nd.getCurrent).each((function(n){If(e,t,"lock").each((function(o){Bg.isOn(o)&&t.onLockedChange(e,n,o)}))}))}))])])}}})},eO=r([nO("field1","field2"),nO("field2","field1"),xf({factory:gp,schema:[Un("dom")],name:"lock",overrides:function(t){return{buttonBehaviours:uc([Bg.config({selected:t.locked,toggleClass:t.markers.lockClass,aria:{mode:"pressed"}})])}}})]),oO=Kf({name:"FormCoupledInputs",configFields:tO(),partFields:eO(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,behaviours:ql(t.coupledFieldBehaviours,[nd.config({find:C.some}),Ul.config({store:{mode:"manual",getValue:function(n){var e=Lf(n,t,["field1","field2"]),o={};return o[t.field1Name]=Ul.getValue(e.field1()),o[t.field2Name]=Ul.getValue(e.field2()),o},setValue:function(n,e){var o=Lf(n,t,["field1","field2"]);Vt(e,t.field1Name)&&Ul.setValue(o.field1(),e[t.field1Name]),Vt(e,t.field2Name)&&Ul.setValue(o.field2(),e[t.field2Name])}}})]),apis:{getField1:function(n){return If(n,t,"field1")},getField2:function(n){return If(n,t,"field2")},getLock:function(n){return If(n,t,"lock")}}}},apis:{getField1:function(t,n){return t.getField1(n)},getField2:function(t,n){return t.getField2(n)},getLock:function(t,n){return t.getLock(n)}}}),rO=function(t){var n=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/.exec(t);if(null===n)return ft.error(t);var e=parseFloat(n[1]),o=n[2];return ft.value({value:e,unit:o})},iO=function(t,n){var e={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1},o=function(t){return Object.prototype.hasOwnProperty.call(e,t)};return t.unit===n?C.some(t.value):o(t.unit)&&o(n)?e[t.unit]===e[n]?C.some(t.value):C.some(t.value/e[t.unit]*e[n]):C.none()},uO=function(t){return C.none()},aO=function(t,n){var e,o,r,i=rO(t).toOptional(),u=rO(n).toOptional();return o=u,r=function(t,n){return iO(t,n.unit).map((function(t){return n.value/t})).map((function(t){return e=t,o=n.unit,function(t){return iO(t,o).map((function(t){return{value:t*e,unit:o}}))};var e,o})).getOr(uO)},((e=i).isSome()&&o.isSome()?C.some(r(e.getOrDie(),o.getOrDie())):C.none()).getOr(uO)},cO=function(t,n){var e=uO,o=ii("ratio-event"),r=oO.parts.lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:n.translate(t.label.getOr("Constrain proportions"))}},components:[{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__lock"],innerHtml:vp("lock",n.icons)}},{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__unlock"],innerHtml:vp("unlock",n.icons)}}],buttonBehaviours:uc([pv.config({disabled:function(){return t.disabled||n.isDisabled()}}),Wv(),Ky.config({})])}),i=function(t){return{dom:{tag:"div",classes:["tox-form__group"]},components:t}},u=function(e){return Xy.parts.field({factory:gx,inputClasses:["tox-textfield"],inputBehaviours:uc([pv.config({disabled:function(){return t.disabled||n.isDisabled()}}),Wv(),Ky.config({}),mg("size-input-events",[rr(mo(),(function(t,n){Jo(t,o,{isField1:e})})),rr(bo(),(function(n,e){Jo(n,nx,{name:t.name})}))])]),selectOnFocus:!1})},a=function(t){return{dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}}},c=oO.parts.field1(i([Xy.parts.label(a("Width")),u(!0)])),s=oO.parts.field2(i([Xy.parts.label(a("Height")),u(!1)]));return oO.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[c,s,i([a("&nbsp;"),r])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:function(t,n,o){rO(Ul.getValue(t)).each((function(t){e(t).each((function(t){var e,o,r,i;Ul.setValue(n,(r={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4},-1!==(i=(e=t).value.toFixed((o=e.unit)in r?r[o]:1)).indexOf(".")&&(i=i.replace(/\.?0*$/,"")),i+e.unit))}))}))},coupledFieldBehaviours:uc([pv.config({disabled:function(){return t.disabled||n.isDisabled()},onDisabled:function(t){oO.getField1(t).bind(Xy.getField).each(pv.disable),oO.getField2(t).bind(Xy.getField).each(pv.disable),oO.getLock(t).each(pv.disable)},onEnabled:function(t){oO.getField1(t).bind(Xy.getField).each(pv.enable),oO.getField2(t).bind(Xy.getField).each(pv.enable),oO.getLock(t).each(pv.enable)}}),Wv(),mg("size-input-events2",[rr(o,(function(t,n){var o=n.event.isField1,r=o?oO.getField1(t):oO.getField2(t),i=o?oO.getField2(t):oO.getField1(t),u=r.map(Ul.getValue).getOr(""),a=i.map(Ul.getValue).getOr("");e=aO(u,a)}))])])})},sO={undo:r(ii("undo")),redo:r(ii("redo")),zoom:r(ii("zoom")),back:r(ii("back")),apply:r(ii("apply")),swap:r(ii("swap")),transform:r(ii("transform")),tempTransform:r(ii("temp-transform")),transformApply:r(ii("transform-apply"))},lO=r("save-state"),fO=r("disable"),dO=r("enable"),mO={formActionEvent:rx,saveState:lO,disable:fO,enable:dO},gO=function(t,n){var o=function(t,e,o,r){return pp(JC({name:t,text:t,disabled:o,primary:r,icon:C.none(),borderless:!1},e,n))},i=function(t,e,o,r){return pp(qC({name:t,icon:C.some(t),tooltip:C.some(e),disabled:r,primary:!1,borderless:!1},o,n))},u=function(t,n){t.map((function(t){var e=t.get(n);e.hasConfigured(pv)&&pv.disable(e)}))},a=function(t,n){t.map((function(t){var e=t.get(n);e.hasConfigured(pv)&&pv.enable(e)}))},c={tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools-edit-panel"]},s=e,l=function(t,n,e){Jo(t,n,e)},f=function(t){return Ko(t,mO.disable())},d=function(t){return Ko(t,mO.enable())},m=function(t,n){f(t),l(t,sO.transform(),{transform:n}),d(t)},g=function(t){return function(){Z.getOpt(t).each((function(t){dg.set(t,[$])}))}},p=function(t,n){f(t),l(t,sO.transformApply(),{transform:n,swap:g(t)}),d(t)},h=function(){return o("Back",(function(t){return l(t,sO.back(),{swap:g(t)})}),!1,!1)},v=function(){return pp({dom:{tag:"div",classes:["tox-spacer"]},behaviours:uc([pv.config({})])})},b=function(){return o("Apply",(function(t){return l(t,sO.apply(),{swap:g(t)})}),!0,!0)},y=[h(),v(),o("Apply",(function(n){p(n,(function(n){var e=t.getRect();return OC(n,e.x,e.y,e.w,e.h)})),t.hideCrop()}),!1,!0)],x=jy.sketch({dom:c,components:y.map((function(t){return t.asSpec()})),containerBehaviours:uc([mg("image-tools-crop-buttons-events",[rr(mO.disable(),(function(t,n){u(y,t)})),rr(mO.enable(),(function(t,n){a(y,t)}))])])}),w=pp(cO({name:"size",label:C.none(),constrain:!0,disabled:!1},n)),S=[h(),v(),w,v(),o("Apply",(function(t){w.getOpt(t).each((function(n){var e,o,r=Ul.getValue(n),i=parseInt(r.width,10),u=parseInt(r.height,10),a=(e=i,o=u,function(t){return _C(t,e,o)});p(t,a)}))}),!1,!0)],k=jy.sketch({dom:c,components:S.map((function(t){return t.asSpec()})),containerBehaviours:uc([mg("image-tools-resize-buttons-events",[rr(mO.disable(),(function(t,n){u(S,t)})),rr(mO.enable(),(function(t,n){a(S,t)}))])])}),O=function(t,n){return function(e){return t(e,n)}},_=O(CC,"h"),T=O(CC,"v"),E=O(TC,-90),D=O(TC,90),B=function(t,n){var e,o;o=n,f(e=t),l(e,sO.tempTransform(),{transform:o}),d(e)},A=[h(),v(),i("flip-horizontally","Flip horizontally",(function(t){B(t,_)}),!1),i("flip-vertically","Flip vertically",(function(t){B(t,T)}),!1),i("rotate-left","Rotate counterclockwise",(function(t){B(t,E)}),!1),i("rotate-right","Rotate clockwise",(function(t){B(t,D)}),!1),v(),b()],M=jy.sketch({dom:c,components:A.map((function(t){return t.asSpec()})),containerBehaviours:uc([mg("image-tools-fliprotate-buttons-events",[rr(mO.disable(),(function(t,n){u(A,t)})),rr(mO.enable(),(function(t,n){a(A,t)}))])])}),F=function(t,e,o,i,u){var a=KS.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}}),c=KS.parts.spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),s=KS.parts.thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return pp(KS.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:o,maxX:u,getInitialValue:r({x:i})},components:[a,c,s],sliderBehaviours:uc([bg.config({})]),onChoose:e}))},I=function(t,n,e,o,r){return[h(),(i=n,F(t,(function(t,n,e){var o=O(i,e.x/100);m(t,o)}),e,o,r)),b()];var i},R=function(t,n,e,o,r){var i=I(t,n,e,o,r);return jy.sketch({dom:c,components:i.map((function(t){return t.asSpec()})),containerBehaviours:uc([mg("image-tools-filter-panel-buttons-events",[rr(mO.disable(),(function(t,n){u(i,t)})),rr(mO.enable(),(function(t,n){a(i,t)}))])])})},P=[h(),v(),b()],V=jy.sketch({dom:c,components:P.map((function(t){return t.asSpec()}))}),H=R("Brightness",SC,-100,0,100),L=R("Contrast",kC,-100,0,100),z=R("Gamma",xC,-100,0,100),N=function(t){return F(t,(function(t,n,e){var o=j.getOpt(t),r=W.getOpt(t),i=U.getOpt(t);o.each((function(n){r.each((function(e){i.each((function(o){var r,i,u,a=Ul.getValue(n).x/100,c=Ul.getValue(o).x/100,s=Ul.getValue(e).x/100,l=(r=a,i=c,u=s,function(t){return wC(t,r,i,u)});m(t,l)}))}))}))}),0,100,200)},j=N("R"),U=N("G"),W=N("B"),G=[h(),j,U,W,b()],X=jy.sketch({dom:c,components:G.map((function(t){return t.asSpec()}))}),Y=function(t,n,e){return function(o){l(o,sO.swap(),{transform:n,swap:function(){Z.getOpt(o).each((function(n){dg.set(n,[t]),e(n)}))}})}},q=C.some(yC),K=C.some(bC),J=[i("crop","Crop",Y(x,C.none(),(function(n){t.showCrop()})),!1),i("resize","Resize",Y(k,C.none(),(function(n){w.getOpt(n).each((function(n){var e=t.getMeasurements(),o=e.width,r=e.height;Ul.setValue(n,{width:o,height:r})}))})),!1),i("orientation","Orientation",Y(M,C.none(),s),!1),i("brightness","Brightness",Y(H,C.none(),s),!1),i("sharpen","Sharpen",Y(V,q,s),!1),i("contrast","Contrast",Y(L,C.none(),s),!1),i("color-levels","Color levels",Y(X,C.none(),s),!1),i("gamma","Gamma",Y(z,C.none(),s),!1),i("invert","Invert",Y(V,K,s),!1)],$=jy.sketch({dom:c,components:J.map((function(t){return t.asSpec()}))}),Q=jy.sketch({dom:{tag:"div"},components:[$],containerBehaviours:uc([dg.config({})])}),Z=pp(Q);return{memContainer:Z,getApplyButton:function(t){return Z.getOpt(t).map((function(t){var n=t.components()[0];return n.components()[n.components().length-1]}))}}},pO=tinymce.util.Tools.resolve("tinymce.geom.Rect"),hO=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),vO=tinymce.util.Tools.resolve("tinymce.util.Observable"),bO=tinymce.util.Tools.resolve("tinymce.util.VK"),yO=function(t){var n,e;if(t.changedTouches)for(n="screenX screenY pageX pageY clientX clientY".split(" "),e=0;e<n.length;e++)t[n[e]]=t.changedTouches[0][n[e]]};function xO(t,n){var e,o,r,i,u=n.document||document,a=u.getElementById(n.handle||t),c=function(t){if(yO(t),t.button!==o)return s(t);t.deltaX=t.screenX-r,t.deltaY=t.screenY-i,t.preventDefault(),n.drag(t)},s=function t(o){yO(o),hO(u).off("mousemove touchmove",c).off("mouseup touchend",t),e.remove(),n.stop&&n.stop(o)};return hO(a).on("mousedown touchstart",(function(t){var l,f,d,m,g,p,h,v,b,y,x=(l=u,f=Math.max,d=l.documentElement,m=l.body,g=f(d.scrollWidth,m.scrollWidth),p=f(d.clientWidth,m.clientWidth),h=f(d.offsetWidth,m.offsetWidth),v=f(d.scrollHeight,m.scrollHeight),b=f(d.clientHeight,m.clientHeight),{width:g<h?p:g,height:v<f(d.offsetHeight,m.offsetHeight)?b:v});yO(t),t.preventDefault(),o=t.button;var w=a;r=t.screenX,i=t.screenY,y=window.getComputedStyle?window.getComputedStyle(w,null).getPropertyValue("cursor"):w.runtimeStyle.cursor,e=hO("<div></div>").css({position:"absolute",top:0,left:0,width:x.width,height:x.height,zIndex:2147483647,opacity:1e-4,cursor:y}).appendTo(u.body),hO(u).on("mousemove touchmove",c).on("mouseup touchend",s),n.start(t)})),{destroy:function(){hO(a).off()}}}var wO,SO,kO,CO=0,OO=function(t,n,e,o,r){var i,u="tox-",a="tox-crid-"+CO++,c=[{name:"move",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:0,deltaH:0,label:"Crop Mask"},{name:"nw",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:-1,deltaH:-1,label:"Top Left Crop Handle"},{name:"ne",xMul:1,yMul:0,deltaX:0,deltaY:1,deltaW:1,deltaH:-1,label:"Top Right Crop Handle"},{name:"sw",xMul:0,yMul:1,deltaX:1,deltaY:0,deltaW:-1,deltaH:1,label:"Bottom Left Crop Handle"},{name:"se",xMul:1,yMul:1,deltaX:0,deltaY:0,deltaW:1,deltaH:1,label:"Bottom Right Crop Handle"}],s=["top","right","bottom","left"],l=function(t,n){return{x:n.x-t.x,y:n.y-t.y,w:n.w,h:n.h}},f=function(n,o,r,i){var u,a=o.x,c=o.y,s=o.w,f=o.h;a+=r*n.deltaX,c+=i*n.deltaY,(s+=r*n.deltaW)<20&&(s=20),(f+=i*n.deltaH)<20&&(f=20),u=t=pO.clamp({x:a,y:c,w:s,h:f},e,"move"===n.name),u=l(e,u),p.fire("updateRect",{rect:u}),g(u)},d=function(t){var e=function(t,n){n.h<0&&(n.h=0),n.w<0&&(n.w=0),hO("#"+a+"-"+t,o).css({left:n.x,top:n.y,width:n.w,height:n.h})};mk.each(c,(function(n){hO("#"+a+"-"+n.name,o).css({left:t.w*n.xMul+t.x,top:t.h*n.yMul+t.y})})),e("top",{x:n.x,y:n.y,w:n.w,h:t.y-n.y}),e("right",{x:t.x+t.w,y:t.y,w:n.w-t.x-t.w+n.x,h:t.h}),e("bottom",{x:n.x,y:t.y+t.h,w:n.w,h:n.h-t.y-t.h+n.y}),e("left",{x:n.x,y:t.y,w:t.x-n.x,h:t.h}),e("move",t)},m=function(n){d(t=n)},g=function(t){var n,o;m((n=e,{x:(o=t).x+n.x,y:o.y+n.y,w:o.w,h:o.h}))};hO('<div id="'+a+'" class="'+u+'croprect-container" role="grid" aria-dropeffect="execute">').appendTo(o),mk.each(s,(function(t){hO("#"+a,o).append('<div id="'+a+"-"+t+'"class="'+u+'croprect-block" style="display: none" data-mce-bogus="all">')})),mk.each(c,(function(t){hO("#"+a,o).append('<div id="'+a+"-"+t.name+'" class="'+u+"croprect-handle "+u+"croprect-handle-"+t.name+'"style="display: none" data-mce-bogus="all" role="gridcell" tabindex="-1" aria-label="'+t.label+'" aria-grabbed="false" title="'+t.label+'">')})),i=mk.map(c,(function(n){var e;return xO(a,{document:o.ownerDocument,handle:a+"-"+n.name,start:function(){e=t},drag:function(t){f(n,e,t.deltaX,t.deltaY)}})})),d(t),hO(o).on("focusin focusout",(function(t){hO(t.target).attr("aria-grabbed","focus"===t.type?"true":"false")})),hO(o).on("keydown",(function(n){var e;mk.each(c,(function(t){if(n.target.id===a+"-"+t.name)return e=t,!1}));var o=function(t,n,o,r,i){t.stopPropagation(),t.preventDefault(),f(e,o,r,i)};switch(n.keyCode){case bO.LEFT:o(n,0,t,-10,0);break;case bO.RIGHT:o(n,0,t,10,0);break;case bO.UP:o(n,0,t,0,-10);break;case bO.DOWN:o(n,0,t,0,10);break;case bO.ENTER:case bO.SPACEBAR:n.preventDefault(),r()}}));var p=mk.extend({toggleVisibility:function(t){var n=mk.map(c,(function(t){return"#"+a+"-"+t.name})).concat(mk.map(s,(function(t){return"#"+a+"-"+t}))).join(",");t?hO(n,o).show():hO(n,o).hide()},setClampRect:function(n){e=n,d(t)},setRect:m,getInnerRect:function(){return l(e,t)},setInnerRect:g,setViewPortRect:function(e){n=e,d(t)},destroy:function(){mk.each(i,(function(t){t.destroy()})),i=[]}},vO);return p},_O=function(t){var n=pp({dom:{tag:"div",classes:["tox-image-tools__image-bg"],attributes:{role:"presentation"}}}),o=me(1),r=me(C.none()),i=me({x:0,y:0,w:1,h:1}),u=me({x:0,y:0,w:1,h:1}),a=function(t,e){l.getOpt(t).each((function(t){var u=o.get(),a=Tu(t.element),c=yu(t.element),s=e.dom.naturalWidth*u,l=e.dom.naturalHeight*u,f=Math.max(0,a/2-s/2),d=Math.max(0,c/2-l/2),m={left:f.toString()+"px",top:d.toString()+"px",width:s.toString()+"px",height:l.toString()+"px",position:"absolute"};Ji(e,m),n.getOpt(t).each((function(t){Ji(t.element,m)})),r.get().each((function(t){var n=i.get();t.setRect({x:n.x*u+f,y:n.y*u+d,w:n.w*u,h:n.h*u}),t.setClampRect({x:f,y:d,w:s,h:l}),t.setViewPortRect({x:0,y:0,w:a,h:c})}))}))},c=function(t,n){var e,r=pe.fromTag("img");return Kr(r,"src",n),e=r.dom,new Ip((function(t){var n=function n(){e.removeEventListener("load",n),t(e)};e.complete?t(e):e.addEventListener("load",n)})).then((function(){return l.getOpt(t).map((function(t){var n=mu({element:r});dg.replaceAt(t,1,C.some(n));var e=u.get(),c={x:0,y:0,w:r.dom.naturalWidth,h:r.dom.naturalHeight};u.set(c);var s,f,d=pO.inflate(c,-20,-20);return i.set(d),e.w===c.w&&e.h===c.h||(s=t,f=r,l.getOpt(s).each((function(t){var n=Tu(t.element),e=yu(t.element),r=f.dom.naturalWidth,i=f.dom.naturalHeight,u=Math.min(n/r,e/i);1<=u?o.set(1):o.set(u)}))),a(t,r),r}))}))},s=jy.sketch({dom:{tag:"div",classes:["tox-image-tools__image"]},components:[n.asSpec(),{dom:{tag:"img",attributes:{src:t}}},{dom:{tag:"div"},behaviours:uc([mg("image-panel-crop-events",[fr((function(t){l.getOpt(t).each((function(t){var n=t.element.dom,u=OO({x:10,y:10,w:100,h:100},{x:0,y:0,w:200,h:200},{x:0,y:0,w:200,h:200},n,e);u.toggleVisibility(!1),u.on("updateRect",(function(t){var n=t.rect,e=o.get(),r={x:Math.round(n.x/e),y:Math.round(n.y/e),w:Math.round(n.w/e),h:Math.round(n.h/e)};i.set(r)})),r.set(C.some(u))}))}))])])}],containerBehaviours:uc([dg.config({}),mg("image-panel-events",[fr((function(n){c(n,t)}))])])}),l=pp(s);return{memContainer:l,updateSrc:c,zoom:function(t,n){var e=o.get(),r=0<n?Math.min(2,e+.1):Math.max(.1,e-.1);o.set(r),l.getOpt(t).each((function(t){var n=t.components()[1].element;a(t,n)}))},showCrop:function(){r.get().each((function(t){t.toggleVisibility(!0)}))},hideCrop:function(){r.get().each((function(t){t.toggleVisibility(!1)}))},getRect:function(){return i.get()},getMeasurements:function(){var t=u.get();return{width:t.w,height:t.h}}}},TO=function(t,n,e,o,r){return qC({name:t,icon:C.some(n),disabled:e,tooltip:C.some(t),primary:!1,borderless:!1},o,r)},EO=function(t,n){n?pv.enable(t):pv.disable(t)},DO=function(t){var n,o,r,i,u=me(t),a=me(C.none()),c=(o=-1,{data:n=[],add:function(t){var e=n.splice(++o);return n.push(t),{state:t,removed:e}},undo:function(){if(r())return n[--o]},redo:function(){if(i())return n[++o]},canUndo:r=function(){return 0<o},canRedo:i=function(){return-1!==o&&o<n.length-1}});c.add(t);var s=function(t){u.set(t)},l=function(t){return{blob:t,url:URL.createObjectURL(t)}},f=function(t){URL.revokeObjectURL(t.url)},d=function(){a.get().each(f),a.set(C.none())},m=function(t){var n=l(t);s(n);var e,o=c.add(n).removed;return e=o,mk.each(e,f),n.url};return{getBlobState:function(){return u.get()},setBlobState:s,addBlobState:m,getTempState:function(){return a.get().fold((function(){return u.get()}),(function(t){return t}))},updateTempState:function(t){var n=l(t);return d(),a.set(C.some(n)),n.url},addTempState:function(t){var n=l(t);return a.set(C.some(n)),n.url},applyTempState:function(t){return a.get().fold(e,(function(n){m(n.blob),t()}))},destroyTempState:d,undo:function(){var t=c.undo();return s(t),t.url},redo:function(){var t=c.redo();return s(t),t.url},getHistoryStates:function(){return{undoEnabled:c.canUndo(),redoEnabled:c.canRedo()}}}},BO=function(t,n){var o,r,i,u=DO(t.currentState),a=function(t){var n=u.getHistoryStates();h.updateButtonUndoStates(t,n.undoEnabled,n.redoEnabled),Jo(t,mO.formActionEvent,{name:mO.saveState(),value:n.undoEnabled})},c=function(t){return t.toBlob()},s=function(t){Jo(t,mO.formActionEvent,{name:mO.disable(),value:{}})},l=function(t){v.getApplyButton(t).each((function(t){pv.enable(t)})),Jo(t,mO.formActionEvent,{name:mO.enable(),value:{}})},f=function(t,n){return s(t),p.updateSrc(t,n)},d=function(t,n,e,o,r){return s(t),Zk(n).then(e).then(c).then(o).then((function(n){return f(t,n).then((function(n){return a(t),r(),l(t),n}))}))["catch"]((function(n){return console.log(n),l(t),n}))},m=function(t,n,e){var o=u.getBlobState().blob;d(t,o,n,(function(t){return u.updateTempState(t)}),e)},g=function(t){var n=u.getBlobState().url;return u.destroyTempState(),a(t),n},p=_O(t.currentState.url),h=(r=pp(TO("Undo","undo",!0,(function(t){Jo(t,sO.undo(),{direction:1})}),o=n)),i=pp(TO("Redo","redo",!0,(function(t){Jo(t,sO.redo(),{direction:1})}),o)),{container:jy.sketch({dom:{tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools__sidebar"]},components:[r.asSpec(),i.asSpec(),TO("Zoom in","zoom-in",!1,(function(t){Jo(t,sO.zoom(),{direction:1})}),o),TO("Zoom out","zoom-out",!1,(function(t){Jo(t,sO.zoom(),{direction:-1})}),o)]}),updateButtonUndoStates:function(t,n,e){r.getOpt(t).each((function(t){EO(t,n)})),i.getOpt(t).each((function(t){EO(t,e)}))}}),v=gO(p,n);return{dom:{tag:"div",attributes:{role:"presentation"}},components:[v.memContainer.asSpec(),p.memContainer.asSpec(),h.container],behaviours:uc([Ul.config({store:{mode:"manual",getValue:function(){return u.getBlobState()}}}),mg("image-tools-events",[rr(sO.undo(),(function(t,n){var e=u.undo();f(t,e).then((function(n){l(t),a(t)}))})),rr(sO.redo(),(function(t,n){var e=u.redo();f(t,e).then((function(n){l(t),a(t)}))})),rr(sO.zoom(),(function(t,n){var e=n.event.direction;p.zoom(t,e)})),rr(sO.back(),(function(t,n){var e,o;o=g(e=t),f(e,o).then((function(t){l(e)})),(0,n.event.swap)(),p.hideCrop()})),rr(sO.apply(),(function(t,n){u.applyTempState((function(){g(t),(0,n.event.swap)()}))})),rr(sO.transform(),(function(t,n){return m(t,n.event.transform,e)})),rr(sO.tempTransform(),(function(t,n){return o=t,r=n.event.transform,i=u.getTempState().blob,void d(o,i,r,(function(t){return u.addTempState(t)}),e);var o,r,i})),rr(sO.transformApply(),(function(t,n){return e=t,o=n.event.transform,r=n.event.swap,i=u.getBlobState().blob,void d(e,i,o,(function(t){var n=u.addBlobState(t);return g(e),n}),r);var e,o,r,i})),rr(sO.swap(),(function(t,n){var e;e=t,h.updateButtonUndoStates(e,!1,!1);var o=n.event.transform,r=n.event.swap;o.fold((function(){r()}),(function(n){m(t,n,r)}))}))]),ak()])}},AO=function(t){return!Pt(t,"items")},MO="data-value",FO=function t(n,e,o,r){return W(o,(function(o){return AO(o)?{type:"togglemenuitem",text:o.text,value:o.value,active:o.value===r,onAction:function(){Ul.setValue(n,o.value),Jo(n,nx,{name:e}),bg.focus(n)}}:{type:"nestedmenuitem",text:o.text,getSubmenuItems:function(){return t(n,e,o.items,r)}}}))},IO=function t(n,e){return ct(n,(function(n){return AO(n)?$f(n.value===e,n):t(n.items,e)}))},RO=qf({name:"HtmlSelect",configFields:[Un("options"),Wl("selectBehaviours",[bg,Ul]),oe("selectClasses",[]),oe("selectAttributes",{}),$n("data")],factory:function(t,n){var e=W(t.options,(function(t){return{dom:{tag:"option",value:t.value,innerHtml:t.text}}})),o=t.data.map((function(t){return Qt("initialValue",t)})).getOr({});return{uid:t.uid,dom:{tag:"select",classes:t.selectClasses,attributes:t.selectAttributes},components:e,behaviours:Xl(t.selectBehaviours,[bg.config({}),Ul.config({store:d({mode:"manual",getValue:function(t){return ru(t.element)},setValue:function(n,e){J(t.options,(function(t){return t.value===e})).isSome()&&iu(n.element,e)}},o)})])}}}),PO=function(t,n){var e=t.label.map((function(t){return tx(t,n)})),o=[pv.config({disabled:function(){return t.disabled||n.isDisabled()}}),Wv(),ag.config({mode:"execution",useEnter:!0!==t.multiline,useControlEnter:!0===t.multiline,execute:function(t){return Ko(t,ix),C.some(!0)}}),mg("textfield-change",[rr(vo(),(function(n,e){Jo(n,nx,{name:t.name})})),rr(_o(),(function(n,e){Jo(n,nx,{name:t.name})}))]),Ky.config({})],i=t.validation.map((function(t){return Rx.config({getRoot:function(t){return Or(t.element)},invalidClass:"tox-invalid",validator:{validate:function(n){var e=Ul.getValue(n),o=t.validator(e);return Ox(!0===o?ft.value(e):ft.error(o))},validateOnLoad:t.validateOnLoad}})})).toArray(),u=t.placeholder.fold(r({}),(function(t){return{placeholder:n.translate(t)}})),a=t.inputMode.fold(r({}),(function(t){return{inputmode:t}})),c=d(d({},u),a),s=Xy.parts.field({tag:!0===t.multiline?"textarea":"input",inputAttributes:c,inputClasses:[t.classname],inputBehaviours:uc(Q([o,i])),selectOnFocus:!1,factory:gx}),l=(t.flex?["tox-form__group--stretched"]:[]).concat(t.maximized?["tox-form-group--maximize"]:[]),f=[pv.config({disabled:function(){return t.disabled||n.isDisabled()},onDisabled:function(t){Xy.getField(t).each(pv.disable)},onEnabled:function(t){Xy.getField(t).each(pv.enable)}}),Wv()];return $y(e,s,l,f)},VO=Object.freeze({__proto__:null,events:function(t,n){var e=t.stream.streams.setup(t,n);return nr([rr(t.event,e),dr((function(){return n.cancel()}))].concat(t.cancelEvent.map((function(t){return[rr(t,(function(){return n.cancel()}))]})).getOr([])))}}),HO=function(t){var n=me(null);return Si({readState:function(){return{timer:null!==n.get()?"set":"unset"}},setTimer:function(t){n.set(t)},cancel:function(){var t=n.get();null!==t&&t.cancel()}})},LO=Object.freeze({__proto__:null,throttle:HO,init:function(t){return t.stream.streams.state(t)}}),zO=[Wn("stream",Fn("mode",{throttle:[Un("delay"),oe("stopEvent",!0),ya("streams",{setup:function(t,n){var e=t.stream,o=kp(t.onStream,e.delay);return n.setTimer(o),function(t,n){o.throttle(t,n),e.stopEvent&&n.stop()}},state:HO})]})),oe("event","input"),$n("cancelEvent"),va("onStream")],NO=cc({fields:zO,name:"streaming",active:VO,state:LO}),jO=function(t,n,e){var o=Ul.getValue(e);Ul.setValue(n,o),WO(n)},UO=function(t,n){var e=t.element,o=ru(e),r=e.dom;"number"!==Jr(e,"type")&&n(r,o)},WO=function(t){UO(t,(function(t,n){return t.setSelectionRange(n.length,n.length)}))},GO=function(t,n,e){if(t.selectsOver){var o=Ul.getValue(n),r=t.getDisplayText(o),i=Ul.getValue(e);return 0===t.getDisplayText(i).indexOf(r)?C.some((function(){var t,o;jO(0,n,e),t=n,o=r.length,UO(t,(function(t,n){return t.setSelectionRange(o,n.length)}))})):C.none()}return C.none()},XO=r("alloy.typeahead.itemexecute"),YO=r([$n("lazySink"),Un("fetch"),oe("minChars",5),oe("responseTime",1e3),pa("onOpen"),oe("getHotspot",C.some),oe("getAnchorOverrides",r({})),oe("layouts",C.none()),oe("eventOrder",{}),fe("model",{},[oe("getDisplayText",(function(t){return void 0!==t.meta&&void 0!==t.meta.text?t.meta.text:t.value})),oe("selectsOver",!0),oe("populateFromBrowse",!0)]),pa("onSetValue"),ha("onExecute"),pa("onItemExecute"),oe("inputClasses",[]),oe("inputAttributes",{}),oe("inputStyles",{}),oe("matchWidth",!0),oe("useMinWidth",!1),oe("dismissOnBlur",!0),ma(["openClass"]),$n("initialData"),Wl("typeaheadBehaviours",[bg,Ul,NO,ag,Bg,Hx]),de("previewing",(function(){return me(!0)}))].concat(fx()).concat(ew())),qO=r([wf({schema:[da()],name:"menu",overrides:function(t){return{fakeFocus:!0,onHighlight:function(n,e){t.previewing.get()?n.getSystem().getByUid(t.uid).each((function(o){GO(t.model,o,e).fold((function(){return dd.dehighlight(n,e)}),(function(t){return t()}))})):n.getSystem().getByUid(t.uid).each((function(n){t.model.populateFromBrowse&&jO(t.model,n,e)})),t.previewing.set(!1)},onExecute:function(n,e){return n.getSystem().getByUid(t.uid).toOptional().map((function(t){return Jo(t,XO(),{item:e}),!0}))},onHover:function(n,e){t.previewing.set(!1),n.getSystem().getByUid(t.uid).each((function(n){t.model.populateFromBrowse&&jO(t.model,n,e)}))}}}})]),KO=Kf({name:"Typeahead",configFields:YO(),partFields:qO(),factory:function(t,n,o,r){var i=function(n,o,i){t.previewing.set(!1);var u=Hx.getCoupled(n,"sandbox");kl.isOpen(u)?nd.getCurrent(u).each((function(t){dd.getHighlighted(t).fold((function(){i(t)}),(function(){tr(u,t.element,"keydown",o)}))})):qx(t,a(n),n,u,r,(function(t){nd.getCurrent(t).each(i)}),vx.HighlightFirst).get(e)},u=dx(t),a=function(t){return function(n){return n.map((function(n){var e=It(n.menus),o=Z(e,(function(t){return Y(t.items,(function(t){return"item"===t.type}))}));return Ul.getState(t).update(W(o,(function(t){return t.data}))),n}))}},c=[bg.config({}),Ul.config({onSetValue:t.onSetValue,store:d({mode:"dataset",getDataKey:function(t){return ru(t.element)},getFallbackEntry:function(t){return{value:t,meta:{}}},setValue:function(n,e){iu(n.element,t.model.getDisplayText(e))}},t.initialData.map((function(t){return Qt("initialValue",t)})).getOr({}))}),NO.config({stream:{mode:"throttle",delay:t.responseTime,stopEvent:!1},onStream:function(n,o){var i,u=Hx.getCoupled(n,"sandbox");bg.isFocused(n)&&ru(n.element).length>=t.minChars&&(i=nd.getCurrent(u).bind((function(t){return dd.getHighlighted(t).map(Ul.getValue)})),t.previewing.set(!0),qx(t,a(n),n,u,r,(function(n){nd.getCurrent(u).each((function(n){i.fold((function(){t.model.selectsOver&&dd.highlightFirst(n)}),(function(t){dd.highlightBy(n,(function(n){return Ul.getValue(n).value===t.value})),dd.getHighlighted(n).orThunk((function(){return dd.highlightFirst(n),C.none()}))}))}))}),vx.HighlightFirst).get(e))},cancelEvent:Fo()}),ag.config({mode:"special",onDown:function(t,n){return i(t,n,dd.highlightFirst),C.some(!0)},onEscape:function(t){var n=Hx.getCoupled(t,"sandbox");return kl.isOpen(n)?(kl.close(n),C.some(!0)):C.none()},onUp:function(t,n){return i(t,n,dd.highlightLast),C.some(!0)},onEnter:function(n){var e=Hx.getCoupled(n,"sandbox"),o=kl.isOpen(e);if(o&&!t.previewing.get())return nd.getCurrent(e).bind((function(t){return dd.getHighlighted(t)})).map((function(t){return Jo(n,XO(),{item:t}),!0}));var r=Ul.getValue(n);return Ko(n,Fo()),t.onExecute(e,n,r),o&&kl.close(e),C.some(!0)}}),Bg.config({toggleClass:t.markers.openClass,aria:{mode:"expanded"}}),Hx.config({others:{sandbox:function(n){return tw(t,n,{onOpen:function(){return Bg.on(n)},onClose:function(){return Bg.off(n)}})}}}),mg("typeaheadevents",[gr((function(n){var o=e;Jx(t,a(n),n,r,o,vx.HighlightFirst).get(e)})),rr(XO(),(function(n,e){var o=Hx.getCoupled(n,"sandbox");jO(t.model,n,e.event.item),Ko(n,Fo()),t.onItemExecute(n,o,e.event.item,Ul.getValue(n)),kl.close(o),WO(n)}))].concat(t.dismissOnBlur?[rr(Oo(),(function(t){var n=Hx.getCoupled(t,"sandbox");hc(n.element).isNone()&&kl.close(n)}))]:[]))];return{uid:t.uid,dom:mx(Nt(t,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:d(d({},u),Xl(t.typeaheadBehaviours,c)),eventOrder:t.eventOrder}}}),JO=function t(n){return d(d({},n),{toCached:function(){return t(n.toCached())},bindFuture:function(e){return t(n.bind((function(t){return t.fold((function(t){return Ox(ft.error(t))}),(function(t){return e(t)}))})))},bindResult:function(e){return t(n.map((function(t){return t.bind(e)})))},mapResult:function(e){return t(n.map((function(t){return t.map(e)})))},mapError:function(e){return t(n.map((function(t){return t.mapError(e)})))},foldResult:function(t,e){return n.map((function(n){return n.fold(t,e)}))},withTimeout:function(e,o){return t(Cx((function(t){var r=!1,i=setTimeout((function(){r=!0,t(ft.error(o()))}),e);n.get((function(n){r||(clearTimeout(i),t(n))}))})))}})},$O=function(t){return JO(Cx(t))},QO=$O,ZO={type:"separator"},t_=function(t){return{type:"menuitem",value:t.url,text:t.title,meta:{attach:t.attach},onAction:e}},n_=function(t,n){return{type:"menuitem",value:n,text:t,meta:{attach:void 0},onAction:e}},e_=function(t,n){return o=t,e=Y(n,(function(t){return t.type===o})),W(e,t_);var e,o},o_=function(t,n){var e=t.toLowerCase();return Y(n,(function(t){var n=void 0!==t.meta&&void 0!==t.meta.text?t.meta.text:t.text;return ke(n.toLowerCase(),e)||ke(t.value.toLowerCase(),e)}))},r_=function(t,n,e){var o=Ul.getValue(n),r=void 0!==o.meta.text?o.meta.text:o.value;return e.getLinkInformation().fold((function(){return[]}),(function(n){var o,i,u,a,c=o_(r,(o=e.getHistory(t),W(o,(function(t){return n_(t,t)}))));return"file"===t?(i=[c,o_(r,e_("header",n.targets)),o_(r,Q([(a=n,C.from(a.anchorTop).map((function(t){return n_("<top>",t)})).toArray()),e_("anchor",n.targets),(u=n,C.from(u.anchorBottom).map((function(t){return n_("<bottom>",t)})).toArray())]))],K(i,(function(t,n){return 0===t.length||0===n.length?t.concat(n):t.concat(ZO,n)}),[])):c}))},i_=ii("aria-invalid"),u_=function(t,n,o){var r,i,u,a,c,s=n.shared.providers,l=function(n){var e=Ul.getValue(n);o.addToHistory(e.value,t.filetype)},f=Xy.parts.field({factory:KO,dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":i_,type:"url"},minChars:0,responseTime:0,fetch:function(e){var r=r_(t.filetype,e,o),i=jC(r,ah.BUBBLE_TO_SANDBOX,n,!1);return Ox(i)},getHotspot:function(t){return b.getOpt(t)},onSetValue:function(t,n){t.hasConfigured(Rx)&&Rx.run(t).get(e)},typeaheadBehaviours:uc(Q([o.getValidationHandler().map((function(n){return Rx.config({getRoot:function(t){return Or(t.element)},invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:function(t,n){g.getOpt(t).each((function(t){Kr(t.element,"title",s.translate(n))}))}},validator:{validate:function(e){var o=Ul.getValue(e);return QO((function(e){n({type:t.filetype,url:o.value},(function(t){var n,o;"invalid"===t.status?(n=ft.error(t.message),e(n)):(o=ft.value(t.message),e(o))}))}))},validateOnLoad:!1}})})).toArray(),[pv.config({disabled:function(){return t.disabled||s.isDisabled()}}),Ky.config({}),mg("urlinput-events",Q(["file"===t.filetype?[rr(vo(),(function(n){Jo(n,nx,{name:t.name})}))]:[],[rr(bo(),(function(n){Jo(n,nx,{name:t.name}),l(n)})),rr(_o(),(function(n){Jo(n,nx,{name:t.name}),l(n)}))]]))]])),eventOrder:((r={})[vo()]=["streaming","urlinput-events","invalidating"],r),model:{getDisplayText:function(t){return t.value},selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:n.shared.getSink,parts:{menu:Sh(0,0,"normal")},onExecute:function(t,n,e){Jo(n,ix,{})},onItemExecute:function(n,e,o,r){l(n),Jo(n,nx,{name:t.name})}}),m=t.label.map((function(t){return tx(t,s)})),g=pp((i="invalid",u=C.some(i_),void 0===(a="warning")&&(a=i),void 0===c&&(c=i),{dom:{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+i],innerHtml:vp(a,s.icons),attributes:d({title:s.translate(c),"aria-live":"polite"},u.fold((function(){return{}}),(function(t){return{id:t}})))}})),p=pp({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[g.asSpec()]}),h=o.getUrlPicker(t.filetype),v=ii("browser.url.event"),b=pp({dom:{tag:"div",classes:["tox-control-wrap"]},components:[f,p.asSpec()],behaviours:uc([pv.config({disabled:function(){return t.disabled||s.isDisabled()}})])}),y=pp(JC({name:t.name,icon:C.some("browse"),text:t.label.getOr(""),disabled:t.disabled,primary:!1,borderless:!0},(function(t){return Ko(t,v)}),s,[],["tox-browse-url"]));return Xy.sketch({dom:Zy([]),components:m.toArray().concat([{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:Q([[b.asSpec()],h.map((function(){return y.asSpec()})).toArray()])}]),fieldBehaviours:uc([pv.config({disabled:function(){return t.disabled||s.isDisabled()},onDisabled:function(t){Xy.getField(t).each(pv.disable),y.getOpt(t).each(pv.disable)},onEnabled:function(t){Xy.getField(t).each(pv.enable),y.getOpt(t).each(pv.enable)}}),Wv(),mg("url-input-events",[rr(v,(function(n){nd.getCurrent(n).each((function(e){var o=Ul.getValue(e),r=d({fieldname:t.name},o);h.each((function(o){o(r).get((function(o){Ul.setValue(e,o),Jo(n,nx,{name:t.name})}))}))}))}))])])})},a_=function(t){return function(n,e,o){return Rt(e,"name").fold((function(){return t(e,o)}),(function(r){return n.field(r,t(e,o))}))}},c_={bar:a_((function(t,n){return e=t,o=n.shared,{dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:W(e.items,o.interpreter)};var e,o})),collection:a_((function(t,n){return lx(t,n.shared.providers)})),alertbanner:a_((function(t,n){return e=t,o=n.shared.providers,jy.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in","tox-notification--"+e.level]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[gp.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:vp(e.icon,o.icons),attributes:{title:o.translate(e.iconTooltip)}},action:function(t){Jo(t,rx,{name:"alert-banner",value:e.url})}})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:o.translate(e.text)}}]});var e,o})),input:a_((function(t,n){return e=t,o=n.shared.providers,PO({name:e.name,multiline:!1,label:e.label,inputMode:e.inputMode,placeholder:e.placeholder,flex:!1,disabled:e.disabled,classname:"tox-textfield",validation:C.none(),maximized:e.maximized},o);var e,o})),textarea:a_((function(t,n){return e=t,o=n.shared.providers,PO({name:e.name,multiline:!0,label:e.label,inputMode:C.none(),placeholder:e.placeholder,flex:!0,disabled:e.disabled,classname:"tox-textarea",validation:C.none(),maximized:e.maximized},o);var e,o})),label:a_((function(t,n){return e=t,o=n.shared,r={dom:{tag:"label",innerHtml:o.providers.translate(e.label),classes:["tox-label"]}},i=W(e.items,o.interpreter),{dom:{tag:"div",classes:["tox-form__group"]},components:[r].concat(i),behaviours:uc([ak(),dg.config({}),yk(C.none()),ag.config({mode:"acyclic"})])};var e,o,r,i})),iframe:(wO=function(t,n){return Bk(t,n.shared.providers)},function(t,n,e){var o=Nt(n,{source:"dynamic"});return a_(wO)(t,o,e)}),button:a_((function(t,n){return ZC(t,n.shared.providers)})),checkbox:a_((function(t,n){return e=t,o=n.shared.providers,r=Ul.config({store:{mode:"manual",getValue:function(t){return t.element.dom.checked},setValue:function(t,n){t.element.dom.checked=n}}}),u=function(t){return t.element.dom.click(),C.some(!0)},a=Xy.parts.field({factory:{sketch:i},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:uc([ak(),pv.config({disabled:function(){return e.disabled||o.isDisabled()}}),Ky.config({}),bg.config({}),r,ag.config({mode:"special",onEnter:u,onSpace:u,stopSpaceKeyup:!0}),mg("checkbox-events",[rr(bo(),(function(t,n){Jo(t,nx,{name:e.name})}))])])}),c=Xy.parts.label({dom:{tag:"span",classes:["tox-checkbox__label"],innerHtml:o.translate(e.label)},behaviours:uc([uw.config({})])}),l=pp({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[(s=function(t){return{dom:{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+t],innerHtml:vp("checked"===t?"selected":"unselected",o.icons)}}})("checked"),s("unchecked")]}),Xy.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[a,l.asSpec(),c],fieldBehaviours:uc([pv.config({disabled:function(){return e.disabled||o.isDisabled()},disableClass:"tox-checkbox--disabled",onDisabled:function(t){Xy.getField(t).each(pv.disable)},onEnabled:function(t){Xy.getField(t).each(pv.enable)}}),Wv()])});var e,o,r,u,a,c,s,l})),colorinput:a_((function(t,n){return lw(t,n.shared,n.colorinput)})),colorpicker:a_((function(t){var n=function(t){return"tox-"+t},e=uk(fk,n),o=pp(e.sketch({dom:{tag:"div",classes:["tox-color-picker-container"],attributes:{role:"presentation"}},onValidHex:function(t){Jo(t,rx,{name:"hex-valid",value:!0})},onInvalidHex:function(t){Jo(t,rx,{name:"hex-valid",value:!1})}}));return{dom:{tag:"div"},components:[o.asSpec()],behaviours:uc([Ul.config({store:{mode:"manual",getValue:function(t){var n=o.get(t);return nd.getCurrent(n).bind((function(t){return Ul.getValue(t).hex})).map((function(t){return"#"+t})).getOr("")},setValue:function(t,n){var e=/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/.exec(n),r=o.get(t);nd.getCurrent(r).fold((function(){console.log("Can not find form")}),(function(t){Ul.setValue(t,{hex:C.from(e[1]).getOr("")}),ZS.getField(t,"hex").each((function(t){Ko(t,vo())}))}))}}}),ak()])}})),dropzone:a_((function(t,n){return wk(t,n.shared.providers)})),grid:a_((function(t,n){return e=t,o=n.shared,{dom:{tag:"div",classes:["tox-form__grid","tox-form__grid--"+e.columns+"col"]},components:W(e.items,o.interpreter)};var e,o})),listbox:a_((function(t,n){return o=t,u=(i=n).shared.providers,a=it(o.items).filter(AO),c=o.label.map((function(t){return tx(t,u)})),s={dom:{tag:"div",classes:["tox-listboxfield"]},components:[Xy.parts.field({dom:{},factory:{sketch:function(t){return PC({uid:t.uid,text:a.map((function(t){return t.text})),icon:C.none(),tooltip:o.label,role:C.none(),fetch:function(t,n){var e=FO(t,o.name,o.items,Ul.getValue(t));n(jC(e,ah.CLOSE_ON_EXECUTE,i,!1))},onSetup:r(e),getApi:r({}),columns:1,presets:"normal",classes:[],dropdownBehaviours:[Ky.config({}),Ul.config({store:{mode:"manual",initialValue:a.map((function(t){return t.value})).getOr(""),getValue:function(t){return Jr(t.element,MO)},setValue:function(t,n){IO(o.items,n).each((function(n){Kr(t.element,MO,n.value),Jo(t,IC,{text:n.text})}))}}})]},"tox-listbox",i.shared)}}})]},Xy.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:Q([c.toArray(),[s]]),fieldBehaviours:uc([pv.config({disabled:r(o.disabled),onDisabled:function(t){Xy.getField(t).each(pv.disable)},onEnabled:function(t){Xy.getField(t).each(pv.enable)}})])});var o,i,u,a,c,s})),selectbox:a_((function(t,n){return e=t,o=n.shared.providers,r=W(e.items,(function(t){return{text:o.translate(t.text),value:t.value}})),i=e.label.map((function(t){return tx(t,o)})),u=Xy.parts.field({dom:{},selectAttributes:{size:e.size},options:r,factory:RO,selectBehaviours:uc([pv.config({disabled:function(){return e.disabled||o.isDisabled()}}),Ky.config({}),mg("selectbox-change",[rr(bo(),(function(t,n){Jo(t,nx,{name:e.name})}))])])}),a=1<e.size?C.none():C.some({dom:{tag:"div",classes:["tox-selectfield__icon-js"],innerHtml:vp("chevron-down",o.icons)}}),c={dom:{tag:"div",classes:["tox-selectfield"]},components:Q([[u],a.toArray()])},Xy.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:Q([i.toArray(),[c]]),fieldBehaviours:uc([pv.config({disabled:function(){return e.disabled||o.isDisabled()},onDisabled:function(t){Xy.getField(t).each(pv.disable)},onEnabled:function(t){Xy.getField(t).each(pv.enable)}}),Wv()])});var e,o,r,i,u,a,c})),sizeinput:a_((function(t,n){return cO(t,n.shared.providers)})),urlinput:a_((function(t,n){return u_(t,n,n.urlinput)})),customeditor:a_((function(t){var n=me(C.none()),e=pp({dom:{tag:t.tag}}),o=me(C.none());return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:uc([mg("custom-editor-events",[fr((function(r){e.getOpt(r).each((function(e){var r;r=t,(Object.prototype.hasOwnProperty.call(r,"init")?t.init(e.element.dom):dk.load(t.scriptId,t.scriptUrl).then((function(n){return n(e.element.dom,t.settings)}))).then((function(t){o.get().each((function(n){t.setValue(n)})),o.set(C.none()),n.set(C.some(t))}))}))}))]),Ul.config({store:{mode:"manual",getValue:function(){return n.get().fold((function(){return o.get().getOr("")}),(function(t){return t.getValue()}))},setValue:function(t,e){n.get().fold((function(){o.set(C.some(e))}),(function(t){return t.setValue(e)}))}}}),ak()]),components:[e.asSpec()]}})),htmlpanel:a_((function(t){return"presentation"===t.presets?jy.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html}}):jy.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html,attributes:{role:"document"}},containerBehaviours:uc([Ky.config({}),bg.config({})])})})),imagetools:a_((function(t,n){return BO(t,n.shared.providers)})),table:a_((function(t,n){return e=t,o=n.shared.providers,u=function(t){return{dom:{tag:"th",innerHtml:o.translate(t)}}},a=function(t){return{dom:{tag:"td",innerHtml:o.translate(t)}}},c=function(t){return{dom:{tag:"tr"},components:W(t,a)}},{dom:{tag:"table",classes:["tox-dialog__table"]},components:[(i=e.header,{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:W(i,u)}]}),(r=e.cells,{dom:{tag:"tbody"},components:W(r,c)})],behaviours:uc([Ky.config({}),bg.config({})])};var e,o,r,i,u,a,c})),panel:a_((function(t,n){return o=n,{dom:{tag:"div",classes:(e=t).classes},components:W(e.items,o.shared.interpreter)};var e,o}))},s_={field:function(t,n){return n}},l_=function(t,n,e){var o=Nt(e,{shared:{interpreter:function(n){return f_(t,n,o)}}});return f_(t,n,o)},f_=function(t,n,e){return Rt(c_,n.type).fold((function(){return console.error('Unknown factory type "'+n.type+'", defaulting to container: ',n),n}),(function(o){return o(t,n,e)}))},d_={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},m_=function(t,n,e){var o=Lc(-12,12,d_),r={maxHeightFunction:Ic()};return function(){return e()?{anchor:"node",root:Ir(t()),node:C.from(t()),bubble:o,layouts:{onRtl:function(){return[lp]},onLtr:function(){return[sp]}},overrides:r}:{anchor:"hotspot",hotspot:n(),bubble:o,layouts:{onRtl:function(){return[La]},onLtr:function(){return[za]}},overrides:r}}},g_=function(t,n,e){return function(){return e()?{anchor:"node",root:Ir(t()),node:C.from(t()),layouts:{onRtl:function(){return[fp]},onLtr:function(){return[fp]}}}:{anchor:"hotspot",hotspot:n(),layouts:{onRtl:function(){return[Wa]},onLtr:function(){return[Wa]}}}}},p_=function(t,n,e){var o,r,i,u=Pv(t),a=function(){return pe.fromDom(t.getBody())},c=function(){return pe.fromDom(t.getContentAreaContainer())},s=function(){return u||!e()};return{inlineDialog:m_(c,n,s),banner:g_(c,n,s),cursor:(r=t,function(){return{anchor:"selection",root:i(),getSelection:function(){var t=r.selection.getRng();return C.some(ps.range(pe.fromDom(t.startContainer),t.startOffset,pe.fromDom(t.endContainer),t.endOffset))}}}),node:(o=i=a,function(t){return{anchor:"node",root:o(),node:t}})}},h_=function(t){return{colorPicker:function(t,n){Zb(r)(t,n)},hasCustomColors:function(){return jb(o)},getColors:function(){return Ub(e)},getColorCols:(n=e=o=r=t,function(){return Xb(n)})};var n,e,o,r},v_=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",format:"bold"},{title:"Italic",format:"italic"},{title:"Underline",format:"underline"},{title:"Strikethrough",format:"strikethrough"},{title:"Superscript",format:"superscript"},{title:"Subscript",format:"subscript"},{title:"Code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",format:"alignleft"},{title:"Center",format:"aligncenter"},{title:"Right",format:"alignright"},{title:"Justify",format:"alignjustify"}]}],b_=function t(n){return K(n,(function(n,e){if(Pt(e,"items")){var o=t(e.items);return{customFormats:n.customFormats.concat(o.customFormats),formats:n.formats.concat([{title:e.title,items:o.formats}])}}if(Pt(e,"inline")||Pt(e,"block")||Pt(e,"selector")){var r="custom-"+(T(e.name)?e.name:e.title.toLowerCase());return{customFormats:n.customFormats.concat([{name:r,format:e}]),formats:n.formats.concat([{title:e.title,format:r,icon:e.icon}])}}return d(d({},n),{formats:n.formats.concat(e)})}),{customFormats:[],formats:[]})},y_=function(t){return n=t,C.from(n.getParam("style_formats")).filter(D).map((function(n){var e,o,r,i=(e=t,o=b_(n),r=function(t){G(t,(function(t){e.formatter.has(t.name)||e.formatter.register(t.name,t.format)}))},e.formatter?r(o.customFormats):e.on("init",(function(){r(o.customFormats)})),o.formats);return t.getParam("style_formats_merge",!1,"boolean")?v_.concat(i):i})).getOr(v_);var n},x_=function(t,n,e){var o={type:"formatter",isSelected:n(t.format),getStylePreview:e(t.format)};return Nt(t,o)},w_=function(t,n,e,o){var r=function n(r){return W(r,(function(r){var i,u,a,c,s,l=_t(r);if(Vt(r,"items")){var f=n(r.items);return Nt(Nt(r,{type:"submenu"}),{getStyleItems:function(){return f}})}return Vt(r,"format")?x_(r,e,o):1===l.length&&z(l,"title")?Nt(r,{type:"separator"}):(u=T((i=r).name)?i.name:ii(i.title),c={type:"formatter",format:a="custom-"+u,isSelected:e(a),getStylePreview:o(a)},s=Nt(i,c),t.formatter.register(u,s),s)}))};return r(n)},S_=mk.trim,k_=function(t){return function(n){if(M(e=n)&&1===e.nodeType){if(n.contentEditable===t)return!0;if(n.getAttribute("data-mce-contenteditable")===t)return!0}var e;return!1}},C_=k_("true"),O_=k_("false"),__=function(t,n,e,o,r){return{type:t,title:n,url:e,level:o,attach:r}},T_=function(t){return t.innerText||t.textContent},E_=function(t){return(n=t)&&"A"===n.nodeName&&void 0!==(n.id||n.name)&&B_(t);var n},D_=function(t){return t&&/^(H[1-6])$/.test(t.nodeName)},B_=function(t){return function(t){for(;t=t.parentNode;){var n=t.contentEditable;if(n&&"inherit"!==n)return C_(t)}return!1}(t)&&!O_(t)},A_=function(t){return D_(t)&&B_(t)},M_=function(t){var n,e,o=(n=t).id?n.id:ii("h");return __("header",T_(t),"#"+o,D_(e=t)?parseInt(e.nodeName.substr(1),10):0,(function(){t.id=o}))},F_=function(t){var n=t.id||t.name,o=T_(t);return __("anchor",o||"#"+n,"#"+n,0,e)},I_=function(t){var n,e;return n="h1,h2,h3,h4,h5,h6,a:not([href])",e=t,W(Ts(pe.fromDom(e),n),(function(t){return t.dom}))},R_=function(t){return 0<S_(t.title).length},P_=function(t){var n=I_(t);return Y(W(Y(n,A_),M_).concat(W(Y(n,E_),F_)),R_)},V_="tinymce-url-history",H_=function(t){return T(t)&&/^https?/.test(t)},L_=function(t){return E(t)&&Ft(t,(function(t){return!(D(n=t)&&n.length<=5&&tt(n,H_));var n})).isNone()},z_=function(){var t,n=Vb.getItem(V_);if(null===n)return{};try{t=JSON.parse(n)}catch(h){if(h instanceof SyntaxError)return console.log("Local storage "+V_+" was not valid JSON",h),{};throw h}return L_(t)?t:(console.log("Local storage "+V_+" was not valid format",t),{})},N_=function(t){var n=z_();return Object.prototype.hasOwnProperty.call(n,t)?n[t]:[]},j_=function(t,n){var e,o,r;H_(t)&&(e=z_(),o=Object.prototype.hasOwnProperty.call(e,n)?e[n]:[],r=Y(o,(function(n){return n!==t})),e[n]=[t].concat(r).slice(0,5),function(t){if(!L_(t))throw new Error("Bad format for history:\n"+JSON.stringify(t));Vb.setItem(V_,JSON.stringify(t))}(e))},U_=function(t){return!!t},W_=function(t){return Dt(mk.makeMap(t,/[, ]/),U_)},G_=function(t){return C.from(t.getParam("file_picker_callback")).filter(F)},X_=function(t,n){var e,o,r,i,u=(e=t,o=C.some(e.getParam("file_picker_types")).filter(U_),r=C.some(e.getParam("file_browser_callback_types")).filter(U_),i=o.or(r).map(W_),G_(e).fold(s,(function(t){return i.fold(l,(function(t){return 0<_t(t).length&&t}))})));return B(u)?u?G_(t):C.none():u[n]?G_(t):C.none()},Y_=function(t){return C.from(t).filter(T).getOrUndefined()},q_=function(t){return C.from(void 0===(e=(n=t).getParam("file_picker_validator_handler",void 0,"function"))?n.getParam("filepicker_validator_handler",void 0,"function"):e);var n,e},K_=function(t){return{getHistory:N_,addToHistory:j_,getLinkInformation:function(){return!1===(n=t).getParam("typeahead_urls")?C.none():C.some({targets:P_(n.getBody()),anchorTop:Y_(n.getParam("anchor_top","#top")),anchorBottom:Y_(n.getParam("anchor_bottom","#bottom"))});var n},getValidationHandler:function(){return q_(t)},getUrlPicker:function(n){return X_(e=t,o=n).map((function(t){return function(n){return Cx((function(r){var i=d({filetype:o,fieldname:n.fieldname},C.from(n.meta).getOr({}));t.call(e,(function(t,n){if(!T(t))throw new Error("Expected value to be string");if(void 0!==n&&!E(n))throw new Error("Expected meta to be a object");r({value:t,meta:n})}),n.value,i)}))}}));var e,o}}},J_=function(t,n,e){var o,r,i=me(!1),u={isPositionedAtTop:function(){return"top"===o.get()},getDockingMode:(o=me(Iv(n)?"bottom":"top")).get,setDockingMode:o.set},a={shared:{providers:{icons:function(){return n.ui.registry.getAll().icons},menuItems:function(){return n.ui.registry.getAll().menuItems},translate:nv.translate,isDisabled:function(){return n.mode.isReadOnly()||n.ui.isDisabled()},getSetting:n.getParam.bind(n)},interpreter:function(t){return f_(s_,t,a)},anchors:p_(n,e,u.isPositionedAtTop),header:u,getSink:function(){return ft.value(t)}},urlinput:K_(n),styleselect:function(t){var n=function(n){return function(){return t.formatter.match(n)}},e=function(n){return function(){var e=t.formatter.get(n);return void 0!==e?C.some({tag:0<e.length&&(e[0].inline||e[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))}):C.none()}},o=function t(n){var e=n.items;return void 0!==e&&0<e.length?Z(e,t):[n.format]},r=me([]),i=me([]),u=me([]),a=me([]),c=me(!1);return t.on("PreInit",(function(u){var a=y_(t),c=w_(t,a,n,e);r.set(c),i.set(Z(c,o))})),t.on("addStyleModifications",(function(r){var i=w_(t,r.items,n,e);u.set(i),c.set(r.replace),a.set(Z(i,o))})),{getData:function(){var t=c.get()?[]:r.get(),n=u.get();return t.concat(n)},getFlattenedKeys:function(){var t=c.get()?[]:i.get(),n=a.get();return t.concat(n)}}}(n),colorinput:h_(n),dialog:{isDraggableModal:(r=n,function(){return r.getParam("draggable_modal",!1,"boolean")})},isContextMenuOpen:function(){return i.get()},setContextMenuState:function(t){return i.set(t)}};return a},$_=r((function(t,n){var e,o,r;e=t,o=Math.floor(n),r=_u.max(e,o,["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"]),Ki(e,"max-width",r+"px")})),Q_="contexttoolbar-hide",Z_=r([Un("dom"),oe("shell",!0),Wl("toolbarBehaviours",[dg])]),tT=r([Sf({name:"groups",overrides:function(){return{behaviours:uc([dg.config({})])}}})]),nT=Kf({name:"Toolbar",configFields:Z_(),partFields:tT(),factory:function(t,n,e,o){var r=function(n){return t.shell?C.some(n):If(n,t,"groups")},i=t.shell?{behaviours:[dg.config({})],components:[]}:{behaviours:[],components:n};return{uid:t.uid,dom:t.dom,components:i.components,behaviours:Xl(t.toolbarBehaviours,i.behaviours),apis:{setGroups:function(t,n){r(t).fold((function(){throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")}),(function(t){dg.set(t,n)}))}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)}}}),eT=function(t,n,e){return{within:t,extra:n,withinWidth:e}},oT=function(t,n,e){var o,i=(o=function(t,n){var o=e(t);return C.some({element:t,start:n,finish:n+o,width:o})},K(t,(function(t,n){return o(n,t.len).fold(r(t),(function(n){return{len:n.finish,list:t.list.concat([n])}}))}),{len:0,list:[]}).list),u=Y(i,(function(t){return t.finish<=n})),a=q(u,(function(t,n){return t+n.width}),0);return{within:u,extra:i.slice(u.length),withinWidth:a}},rT=function(t){return W(t,(function(t){return t.element}))},iT=function(t,n,e,o){var r,i,u,a,c,s,l,f,d,m=(0===(r=oT(n,t,e)).extra.length?C.some(r):C.none()).getOrThunk((function(){return oT(n,t-e(o),e)})),g=m.within,p=m.extra,h=m.withinWidth;return 1===p.length&&p[0].width<=e(o)?(l=p,f=h,d=rT(g.concat(l)),eT(d,[],f)):1<=p.length?(u=p,a=o,c=h,s=rT(g).concat([a]),eT(s,rT(u),c)):(i=h,eT(rT(g),[],i))},uT=function(t,n){var e=W(n,(function(t){return hu(t)}));nT.setGroups(t,e)},aT=function(t,n,e){var o=Rf(t,n,"primary"),r=Hx.getCoupled(t,"overflowGroup");Ki(o.element,"visibility","hidden");var i=n.builtGroups.get().concat([r]),u=ct(i,(function(t){return hc(t.element).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))}));e([]),uT(o,i);var a=Tu(o.element),c=iT(a,n.builtGroups.get(),(function(t){return Tu(t.element)}),r);0===c.extra.length?(dg.remove(o,r),e([])):(uT(o,c.within),e(c.extra)),eu(o.element,"visibility"),ou(o.element),u.each(bg.focus)},cT=r([Wl("splitToolbarBehaviours",[Hx]),de("builtGroups",(function(){return me([])}))]),sT=r([ma(["overflowToggledClass"]),ne("getOverflowBounds"),Un("lazySink"),de("overflowGroups",(function(){return me([])}))].concat(cT())),lT=r([xf({factory:nT,schema:Z_(),name:"primary"}),wf({schema:Z_(),name:"overflow"}),wf({name:"overflow-button"}),wf({name:"overflow-group"})]),fT=r([ma(["toggledClass"]),Un("lazySink"),Yn("fetch"),ne("getBounds"),ee("fireDismissalEventInstead",[oe("event",No())]),Jc()]),dT=r([wf({name:"button",overrides:function(t){return{dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:uc([Bg.config({toggleClass:t.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1})])}}}),wf({factory:nT,schema:Z_(),name:"toolbar",overrides:function(t){return{toolbarBehaviours:uc([ag.config({mode:"cyclic",onEscape:function(n){return If(n,t,"button").each(bg.focus),C.none()}})])}}})]),mT=function(t,n){var e=Hx.getCoupled(t,"toolbarSandbox");kl.isOpen(e)?kl.close(e):kl.open(e,n.toolbar())},gT=function(t,n,e,o){var r=e.getBounds.map((function(t){return t()})),i=e.lazySink(t).getOrDie();nl.positionWithinBounds(i,{anchor:"hotspot",hotspot:t,layouts:o,overrides:{maxWidthFunction:$_()}},n,r)},pT=function(t,n,e,o,r){nT.setGroups(n,r),gT(t,n,e,o),Bg.on(t)},hT=Kf({name:"FloatingToolbarButton",factory:function(t,n,e,o){return d(d({},gp.sketch(d(d({},o.button()),{action:function(t){mT(t,o)},buttonBehaviours:ql({dump:o.button().buttonBehaviours},[Hx.config({others:{toolbarSandbox:function(n){return o=n,r=e,i=t,{dom:{tag:"div",attributes:{id:(u=Qu()).id}},behaviours:uc([ag.config({mode:"special",onEscape:function(t){return kl.close(t),C.some(!0)}}),kl.config({onOpen:function(t,n){i.fetch().get((function(t){pT(o,n,i,r.layouts,t),u.link(o.element),ag.focusIn(n)}))},onClose:function(){Bg.off(o),bg.focus(o),u.unlink(o.element)},isPartOf:function(t,n,e){return ta(n,e)||ta(o,e)},getAttachPoint:function(){return i.lazySink(o).getOrDie()}}),dc.config({channels:d(d({},El(d({isExtraPart:s},i.fireDismissalEventInstead.map((function(t){return{fireEventInstead:{event:t.event}}})).getOr({})))),Bl({doReposition:function(){kl.getState(Hx.getCoupled(o,"toolbarSandbox")).each((function(t){gT(o,t,i,r.layouts)}))}}))})])};var o,r,i,u}}})])}))),{apis:{setGroups:function(n,o){kl.getState(Hx.getCoupled(n,"toolbarSandbox")).each((function(r){pT(n,r,t,e.layouts,o)}))},reposition:function(n){kl.getState(Hx.getCoupled(n,"toolbarSandbox")).each((function(o){gT(n,o,t,e.layouts)}))},toggle:function(t){mT(t,o)},getToolbar:function(t){return kl.getState(Hx.getCoupled(t,"toolbarSandbox"))},isOpen:function(t){return kl.isOpen(Hx.getCoupled(t,"toolbarSandbox"))}}})},configFields:fT(),partFields:dT(),apis:{setGroups:function(t,n,e){t.setGroups(n,e)},reposition:function(t,n){t.reposition(n)},toggle:function(t,n){t.toggle(n)},getToolbar:function(t,n){return t.getToolbar(n)},isOpen:function(t,n){return t.isOpen(n)}}}),vT=r([Un("items"),ma(["itemSelector"]),Wl("tgroupBehaviours",[ag])]),bT=r([kf({name:"items",unit:"item"})]),yT=Kf({name:"ToolbarGroup",configFields:vT(),partFields:bT(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,behaviours:Xl(t.tgroupBehaviours,[ag.config({mode:"flow",selector:t.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),xT=function(t){return W(t,(function(t){return hu(t)}))},wT=function(t,n,e){aT(t,e,(function(o){e.overflowGroups.set(o),n.getOpt(t).each((function(t){hT.setGroups(t,xT(o))}))}))},ST=Kf({name:"SplitFloatingToolbar",configFields:sT(),partFields:lT(),factory:function(t,n,e,o){var r=pp(hT.sketch({fetch:function(){return Cx((function(n){n(xT(t.overflowGroups.get()))}))},layouts:{onLtr:function(){return[za,La]},onRtl:function(){return[La,za]},onBottomLtr:function(){return[ja,Na]},onBottomRtl:function(){return[Na,ja]}},getBounds:e.getOverflowBounds,lazySink:t.lazySink,fireDismissalEventInstead:{},markers:{toggledClass:t.markers.overflowToggledClass},parts:{button:o["overflow-button"](),toolbar:o.overflow()}}));return{uid:t.uid,dom:t.dom,components:n,behaviours:Xl(t.splitToolbarBehaviours,[Hx.config({others:{overflowGroup:function(){return yT.sketch(d(d({},o["overflow-group"]()),{items:[r.asSpec()]}))}}})]),apis:{setGroups:function(n,e){t.builtGroups.set(W(e,n.getSystem().build)),wT(n,r,t)},refresh:function(n){return wT(n,r,t)},toggle:function(t){r.getOpt(t).each((function(t){hT.toggle(t)}))},isOpen:function(t){return r.getOpt(t).map(hT.isOpen).getOr(!1)},reposition:function(t){r.getOpt(t).each((function(t){hT.reposition(t)}))},getOverflow:function(t){return r.getOpt(t).bind(hT.getToolbar)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},reposition:function(t,n){t.reposition(n)},toggle:function(t,n){t.toggle(n)},isOpen:function(t,n){return t.isOpen(n)},getOverflow:function(t,n){return t.getOverflow(n)}}}),kT=function(t,n){return n.getAnimationRoot.fold((function(){return t.element}),(function(n){return n(t)}))},CT=function(t){return t.dimension.property},OT=function(t,n){return t.dimension.getDimension(n)},_T=function(t,n){var e=kT(t,n);ji(e,[n.shrinkingClass,n.growingClass])},TT=function(t,n){Li(t.element,n.openClass),Vi(t.element,n.closedClass),Ki(t.element,CT(n),"0px"),ou(t.element)},ET=function(t,n){Li(t.element,n.closedClass),Vi(t.element,n.openClass),eu(t.element,CT(n))},DT=function(t,n,e,o){e.setCollapsed(),Ki(t.element,CT(n),OT(n,t.element)),ou(t.element),_T(t,n),TT(t,n),n.onStartShrink(t),n.onShrunk(t)},BT=function(t,n,e,o){var r=o.getOrThunk((function(){return OT(n,t.element)}));e.setCollapsed(),Ki(t.element,CT(n),r),ou(t.element);var i=kT(t,n);Li(i,n.growingClass),Vi(i,n.shrinkingClass),TT(t,n),n.onStartShrink(t)},AT=function(t,n,e){var o=OT(n,t.element);("0px"===o?DT:BT)(t,n,e,C.some(o))},MT=function(t,n,e){var o=kT(t,n),r=zi(o,n.shrinkingClass),i=OT(n,t.element);ET(t,n);var u=OT(n,t.element);(r?function(){Ki(t.element,CT(n),i),ou(t.element)}:function(){TT(t,n)})(),Li(o,n.shrinkingClass),Vi(o,n.growingClass),ET(t,n),Ki(t.element,CT(n),u),e.setExpanded(),n.onStartGrow(t)},FT=function(t,n,e){var o=kT(t,n);return!0===zi(o,n.growingClass)},IT=function(t,n,e){var o=kT(t,n);return!0===zi(o,n.shrinkingClass)},RT=Object.freeze({__proto__:null,refresh:function(t,n,e){var o;e.isExpanded()&&(eu(t.element,CT(n)),o=OT(n,t.element),Ki(t.element,CT(n),o))},grow:function(t,n,e){e.isExpanded()||MT(t,n,e)},shrink:function(t,n,e){e.isExpanded()&&AT(t,n,e)},immediateShrink:function(t,n,e){e.isExpanded()&&DT(t,n,e,C.none())},hasGrown:function(t,n,e){return e.isExpanded()},hasShrunk:function(t,n,e){return e.isCollapsed()},isGrowing:FT,isShrinking:IT,isTransitioning:function(t,n,e){return FT(t,n)||IT(t,n)},toggleGrow:function(t,n,e){(e.isExpanded()?AT:MT)(t,n,e)},disableTransitions:_T}),PT=Object.freeze({__proto__:null,exhibit:function(t,n,e){var o=n.expanded;return Ci(o?{classes:[n.openClass],styles:{}}:{classes:[n.closedClass],styles:Qt(n.dimension.property,"0px")})},events:function(t,n){return nr([lr(xo(),(function(e,o){o.event.raw.propertyName===t.dimension.property&&(_T(e,t),n.isExpanded()&&eu(e.element,t.dimension.property),(n.isExpanded()?t.onGrown:t.onShrunk)(e))}))])}}),VT=[Un("closedClass"),Un("openClass"),Un("shrinkingClass"),Un("growingClass"),$n("getAnimationRoot"),pa("onShrunk"),pa("onStartShrink"),pa("onGrown"),pa("onStartGrow"),oe("expanded",!1),Wn("dimension",Fn("property",{width:[ya("property","width"),ya("getDimension",(function(t){return Tu(t)+"px"}))],height:[ya("property","height"),ya("getDimension",(function(t){return yu(t)+"px"}))]}))],HT=cc({fields:VT,name:"sliding",active:PT,apis:RT,state:Object.freeze({__proto__:null,init:function(t){var n=me(t.expanded);return Si({isExpanded:function(){return!0===n.get()},isCollapsed:function(){return!1===n.get()},setCollapsed:u(n.set,!1),setExpanded:u(n.set,!0),readState:function(){return"expanded: "+n.get()}})}})}),LT=r([ma(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),pa("onOpened"),pa("onClosed")].concat(cT())),zT=r([xf({factory:nT,schema:Z_(),name:"primary"}),xf({factory:nT,schema:Z_(),name:"overflow",overrides:function(t){return{toolbarBehaviours:uc([HT.config({dimension:{property:"height"},closedClass:t.markers.closedClass,openClass:t.markers.openClass,shrinkingClass:t.markers.shrinkingClass,growingClass:t.markers.growingClass,onShrunk:function(n){If(n,t,"overflow-button").each((function(t){Bg.off(t),bg.focus(t)})),t.onClosed(n)},onGrown:function(n){ag.focusIn(n),t.onOpened(n)},onStartGrow:function(n){If(n,t,"overflow-button").each(Bg.on)}}),ag.config({mode:"acyclic",onEscape:function(n){return If(n,t,"overflow-button").each(bg.focus),C.some(!0)}})])}}}),wf({name:"overflow-button",overrides:function(t){return{buttonBehaviours:uc([Bg.config({toggleClass:t.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])}}}),wf({name:"overflow-group"})]),NT=function(t,n){If(t,n,"overflow-button").bind((function(){return If(t,n,"overflow")})).each((function(e){jT(t,n),HT.toggleGrow(e)}))},jT=function(t,n){If(t,n,"overflow").each((function(e){aT(t,n,(function(t){var n=W(t,(function(t){return hu(t)}));nT.setGroups(e,n)})),If(t,n,"overflow-button").each((function(t){HT.hasGrown(e)&&Bg.on(t)})),HT.refresh(e)}))},UT=Kf({name:"SplitSlidingToolbar",configFields:LT(),partFields:zT(),factory:function(t,n,e,o){var r="alloy.toolbar.toggle";return{uid:t.uid,dom:t.dom,components:n,behaviours:Xl(t.splitToolbarBehaviours,[Hx.config({others:{overflowGroup:function(t){return yT.sketch(d(d({},o["overflow-group"]()),{items:[gp.sketch(d(d({},o["overflow-button"]()),{action:function(n){Ko(t,r)}}))]}))}}}),mg("toolbar-toggle-events",[rr(r,(function(n){NT(n,t)}))])]),apis:{setGroups:function(n,e){var o;o=W(e,n.getSystem().build),t.builtGroups.set(o),jT(n,t)},refresh:function(n){return jT(n,t)},toggle:function(n){return NT(n,t)},isOpen:function(n){return If(n,t,"overflow").map(HT.hasGrown).getOr(!1)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},toggle:function(t,n){t.toggle(n)},isOpen:function(t,n){return t.isOpen(n)}}}),WT=r(ii("toolbar-height-change")),GT=function(t){var n=t.title.fold((function(){return{}}),(function(t){return{attributes:{title:t}}}));return{dom:d({tag:"div",classes:["tox-toolbar__group"]},n),components:[yT.parts.items({})],items:t.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled])"},tgroupBehaviours:uc([Ky.config({}),bg.config({})])}},XT=function(t){return yT.sketch(GT(t))},YT=function(t,n){var e=fr((function(n){var e=W(t.initGroups,XT);nT.setGroups(n,e)}));return uc([qv(t.providers.isDisabled),Wv(),ag.config({mode:n,onEscape:t.onEscape,selector:".tox-toolbar__group"}),mg("toolbar-events",[e])])},qT=function(t){var n=t.cyclicKeying?"cyclic":"acyclic";return{uid:t.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":GT({title:C.none(),items:[]}),"overflow-button":YC({name:"more",icon:C.some("more-drawer"),disabled:!1,tooltip:C.some("More..."),primary:!1,borderless:!1},C.none(),t.providers)},splitToolbarBehaviours:YT(t,n)}},KT=function(t){var n=qT(t),e=ST.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return ST.sketch(d(d({},n),{lazySink:t.getSink,getOverflowBounds:function(){var n=t.moreDrawerData.lazyHeader().element,e=Nu(n),o=kr(n),r=Nu(o),i=Math.max(o.dom.scrollHeight,r.height);return Lu(e.x+4,r.y,e.width-8,i)},parts:d(d({},n.parts),{overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:t.attributes}}}),components:[e],markers:{overflowToggledClass:"tox-tbtn--enabled"}}))},JT=function(t){var n=UT.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),e=UT.parts.overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),o=qT(t);return UT.sketch(d(d({},o),{components:[n,e],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:function(t){t.getSystem().broadcastOn([WT()],{type:"opened"})},onClosed:function(t){t.getSystem().broadcastOn([WT()],{type:"closed"})}}))},$T=function(t){var n=t.cyclicKeying?"cyclic":"acyclic";return nT.sketch({uid:t.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(t.type===ih.scrolling?["tox-toolbar--scrolling"]:[])},components:[nT.parts.groups({})],toolbarBehaviours:YT(t,n)})},QT=mn([Gn("type"),Wn("items",pn([Cn([Gn("name"),Jn("items",Vn)]),Vn]))].concat(Wp)),ZT=[te("text"),te("tooltip"),te("icon"),Yn("fetch"),se("onSetup",(function(){return e}))],tE=mn(g([Gn("type")],ZT)),nE=function(t){return En("menubutton",tE,t)},eE=mn([Gn("type"),te("tooltip"),te("icon"),te("text"),ne("select"),Yn("fetch"),se("onSetup",(function(){return e})),ae("presets","normal",["normal","color","listpreview"]),oe("columns",1),Yn("onAction"),Yn("onItemAction")]),oE=Object.freeze({__proto__:null,events:function(t,n){var e=function(e,o){t.updateState.each((function(t){var r=t(e,o);n.set(r)})),t.renderComponents.each((function(t){var r=t(o,n.get()),i=W(r,e.getSystem().build);il(e,i)}))};return nr([rr(To(),(function(n,o){var r,i=o;i.universal||(r=t.channel,z(i.channels,r)&&e(n,i.data))})),fr((function(n,o){t.initialData.each((function(t){e(n,t)}))}))])}}),rE=Object.freeze({__proto__:null,getState:function(t,n,e){return e}}),iE=[Un("channel"),$n("renderComponents"),$n("updateState"),$n("initialData")],uE=cc({fields:iE,name:"reflecting",active:oE,apis:rE,state:Object.freeze({__proto__:null,init:function(){var t=me(C.none());return{readState:function(){return t.get().fold((function(){return"none"}),(function(t){return t}))},get:function(){return t.get()},set:function(n){return t.set(n)},clear:function(){return t.set(C.none())}}}})}),aE=r([Un("toggleClass"),Un("fetch"),va("onExecute"),oe("getHotspot",C.some),oe("getAnchorOverrides",r({})),Jc(),va("onItemExecute"),$n("lazySink"),Un("dom"),pa("onOpen"),Wl("splitDropdownBehaviours",[Hx,ag,bg]),oe("matchWidth",!1),oe("useMinWidth",!1),oe("eventOrder",{}),$n("role")].concat(ew())),cE=xf({factory:gp,schema:[Un("dom")],name:"arrow",defaults:function(){return{buttonBehaviours:uc([bg.revoke()])}},overrides:function(t){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(n){n.getSystem().getByUid(t.uid).each($o)},buttonBehaviours:uc([Bg.config({toggleOnExecute:!1,toggleClass:t.toggleClass})])}}}),sE=xf({factory:gp,schema:[Un("dom")],name:"button",defaults:function(){return{buttonBehaviours:uc([bg.revoke()])}},overrides:function(t){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(n){n.getSystem().getByUid(t.uid).each((function(e){t.onExecute(e,n)}))}}}}),lE=r([cE,sE,Sf({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[Un("text")],name:"aria-descriptor"}),wf({schema:[da()],name:"menu",defaults:function(t){return{onExecute:function(n,e){n.getSystem().getByUid(t.uid).each((function(o){t.onItemExecute(o,n,e)}))}}}}),zx()]),fE=Kf({name:"SplitDropdown",configFields:aE(),partFields:lE(),factory:function(t,n,o,r){var i,u=function(t){nd.getCurrent(t).each((function(t){dd.highlightFirst(t),ag.focusIn(t)}))},a=function(n){Jx(t,(function(t){return t}),n,r,u,vx.HighlightFirst).get(e)},c=function(n){var e=Rf(n,t,"button");return $o(e),C.some(!0)},s=d(d({},nr([fr((function(n,e){If(n,t,"aria-descriptor").each((function(t){var e=ii("aria");Kr(t.element,"id",e),Kr(n.element,"aria-describedby",e)}))}))])),Mg(C.some(a))),l={repositionMenus:function(t){Bg.isOn(t)&&nw(t)}};return{uid:t.uid,dom:t.dom,components:n,apis:l,eventOrder:d(d({},t.eventOrder),((i={})[Eo()]=["disabling","toggling","alloy.base.behaviour"],i)),events:s,behaviours:Xl(t.splitDropdownBehaviours,[Hx.config({others:{sandbox:function(n){var e=Rf(n,t,"arrow");return tw(t,n,{onOpen:function(){Bg.on(e),Bg.on(n)},onClose:function(){Bg.off(e),Bg.off(n)}})}}}),ag.config({mode:"special",onSpace:c,onEnter:c,onDown:function(t){return a(t),C.some(!0)}}),bg.config({}),Bg.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:t.role.getOr("button"),"aria-haspopup":!0}}}},apis:{repositionMenus:function(t,n){return t.repositionMenus(n)}}}),dE=function(t){return{isDisabled:function(){return pv.isDisabled(t)},setDisabled:function(n){return pv.set(t,n)}}},mE=function(t){return{setActive:function(n){Bg.set(t,n)},isActive:function(){return Bg.isOn(t)},isDisabled:function(){return pv.isDisabled(t)},setDisabled:function(n){return pv.set(t,n)}}},gE=function(t,n){return t.map((function(t){return{"aria-label":n.translate(t),title:n.translate(t)}})).getOr({})},pE=ii("focus-button"),hE=["checklist","ordered-list"],vE=["indent","outdent","table-insert-column-after","table-insert-column-before","unordered-list"],bE=function(t,n,e,o,r,i){var u,a=function(t){return nv.isRtl()&&z(hE,t)?t+"-rtl":t},c=nv.isRtl()&&t.exists((function(t){return z(vE,t)}));return{dom:{tag:"button",classes:["tox-tbtn"].concat(n.isSome()?["tox-tbtn--select"]:[]).concat(c?["tox-tbtn__icon-rtl"]:[]),attributes:gE(e,i)},components:Zv([t.map((function(t){return DC(a(t),i.icons)})),n.map((function(t){return AC(t,"tox-tbtn",i)}))]),eventOrder:((u={})[ao()]=["focusing","alloy.base.behaviour","common-button-display-events"],u),buttonBehaviours:uc([qv(i.isDisabled),Wv(),mg("common-button-display-events",[rr(ao(),(function(t,n){n.event.prevent(),Ko(t,pE)}))])].concat(o.map((function(e){return uE.config({channel:e,initialData:{icon:t,text:n},renderComponents:function(t,n){return Zv([t.icon.map((function(t){return DC(a(t),i.icons)})),t.text.map((function(t){return AC(t,"tox-tbtn",i)}))])}})})).toArray()).concat(r.getOr([])))}},yE=function(t,n,o){var r,i=me(e),u=bE(t.icon,t.text,t.tooltip,C.none(),C.none(),o);return gp.sketch({dom:u.dom,components:u.components,eventOrder:FC,buttonBehaviours:uc([mg("toolbar-button-events",[(r={onAction:t.onAction,getApi:n.getApi},gr((function(t,n){Kv(r,t)((function(n){Jo(t,MC,{buttonApi:n}),r.onAction(n)}))}))),Jv(n,i),$v(n,i)]),qv((function(){return t.disabled||o.isDisabled()})),Wv()].concat(n.toolbarButtonBehaviours))})},xE=function(t,n,e){return yE(t,{toolbarButtonBehaviours:[].concat(0<e.length?[mg("toolbarButtonWith",e)]:[]),getApi:dE,onSetup:t.onSetup},n)},wE=function(t,n,e){return Nt(yE(t,{toolbarButtonBehaviours:[dg.config({}),Bg.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(0<e.length?[mg("toolbarToggleButtonWith",e)]:[]),getApi:mE,onSetup:t.onSetup},n))},SE=function(t,n){var o,r,i,u,a=ii("channel-update-split-dropdown-display"),c=function(t){return{isDisabled:function(){return pv.isDisabled(t)},setDisabled:function(n){return pv.set(t,n)},setIconFill:function(n,e){Ju(t.element,'svg path[id="'+n+'"], rect[id="'+n+'"]').each((function(t){Kr(t,"fill",e)}))},setIconStroke:function(n,e){Ju(t.element,'svg path[id="'+n+'"], rect[id="'+n+'"]').each((function(t){Kr(t,"stroke",e)}))},setActive:function(n){Kr(t.element,"aria-pressed",n),Ju(t.element,"span").each((function(e){t.getSystem().getByDom(e).each((function(t){return Bg.set(t,n)}))}))},isActive:function(){return Ju(t.element,"span").exists((function(n){return t.getSystem().getByDom(n).exists(Bg.isOn)}))}}},l=me(e),f={getApi:c,onSetup:t.onSetup};return fE.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:d({"aria-pressed":!1},gE(t.tooltip,n.providers))},onExecute:function(n){t.onAction(c(n))},onItemExecute:function(t,n,e){},splitDropdownBehaviours:uc([Yv(n.providers.isDisabled),Wv(),mg("split-dropdown-events",[rr(pE,bg.focus),Jv(f,l),$v(f,l)]),uw.config({})]),eventOrder:((o={})[Lo()]=["alloy.base.behaviour","split-dropdown-events"],o),toggleClass:"tox-tbtn--enabled",lazySink:n.getSink,fetch:(r=c,i=t,u=n.providers,function(t){return Cx((function(t){return i.fetch(t)})).map((function(n){return C.from(wy(Nt(ty(ii("menu-value"),n,(function(n){i.onItemAction(r(t),n)}),i.columns,i.presets,ah.CLOSE_ON_EXECUTE,i.select.getOr(s),u),{movement:ey(i.columns,i.presets),menuBehaviours:Gh("auto"!==i.columns?[]:[fr((function(t,n){Uh(t,4,bh(i.presets)).each((function(n){var e=n.numRows,o=n.numColumns;ag.setGridSize(t,e,o)}))}))])})))}))}),parts:{menu:Sh(0,t.columns,t.presets)},components:[fE.parts.button(bE(t.icon,t.text,C.none(),C.some(a),C.some([Bg.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),n.providers)),fE.parts.arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:vp("chevron-down",n.providers.icons)},buttonBehaviours:uc([Yv(n.providers.isDisabled),Wv()])}),fE.parts["aria-descriptor"]({text:n.providers.translate("To open the popup, press Shift+Enter")})]})},kE=function(t,n){return rr(MC,(function(e,o){var r,i=t.get(e),u=(r=i,{hide:function(){return Ko(r,Mo())},getValue:function(){return Ul.getValue(r)}});n.onAction(u,o.event.buttonApi)}))},CE=function(t,n,o){var r,i,u,a,c,s,l,f,g,p,h,v,b={backstage:{shared:{providers:o}}};return"contextformtogglebutton"===n.type?(l=t,g=b,(p=(f=n).original).primary,h=m(p,["primary"]),v=Dn(Kp(d(d({},h),{type:"togglebutton",onAction:e}))),wE(v,g.backstage.shared.providers,[kE(l,f)])):(r=t,u=b,(a=(i=n).original).primary,c=m(a,["primary"]),s=Dn(Xp(d(d({},c),{type:"button",onAction:e}))),xE(s,u.backstage.shared.providers,[kE(r,i)]))},OE=function(t,n){var e,o,r,i,u=t.label.fold((function(){return{}}),(function(t){return{"aria-label":t}})),c=pp(gx.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:t.initValue(),inputAttributes:u,selectOnFocus:!0,inputBehaviours:uc([ag.config({mode:"special",onEnter:function(t){return s.findPrimary(t).map((function(t){return $o(t),!0}))},onLeft:function(t,n){return n.cut(),C.none()},onRight:function(t,n){return n.cut(),C.none()}})])})),s=(e=c,o=t.commands,r=n,i=W(o,(function(t){return pp(CE(e,t,r))})),{asSpecs:function(){return W(i,(function(t){return t.asSpec()}))},findPrimary:function(t){return ct(o,(function(n,e){return n.primary?C.from(i[e]).bind((function(n){return n.getOpt(t)})).filter(a(pv.isDisabled)):C.none()}))}});return[{title:C.none(),items:[c.asSpec()]},{title:C.none(),items:s.asSpecs()}]},_E=OE,TE=function(t,n){var e,o,r,i,u,a=Ru(window),c=zu(pe.fromDom(t.getContentAreaContainer())),s=kv(t)||Cv(t)||_v(t),l=(e=c,o=a,r=Math.max(o.x,e.x),i=e.right-r,u=o.width-(r-o.x),{x:r,width:Math.min(i,u)}),f=l.x,d=l.width;if(t.inline&&!s)return Lu(f,a.y,d,a.height);var m=function(t,n,e,o){var r=pe.fromDom(t.getContainer()),i=Ju(r,".tox-editor-header").getOr(r),u=zu(i),a=u.y>=n.bottom,c=o&&!a;if(t.inline&&c)return{y:Math.max(u.bottom,e.y),bottom:e.bottom};if(t.inline&&!c)return{y:e.y,bottom:Math.min(u.y,e.bottom)};var s=zu(r);return c?{y:Math.max(u.bottom,e.y),bottom:Math.min(s.bottom,e.bottom)}:{y:Math.max(s.y,e.y),bottom:Math.min(u.y,e.bottom)}}(t,c,a,n.header.isPositionedAtTop()),g=m.y,p=m.bottom;return Lu(f,g,d,p-g)},EE=function(t,n){var e=Y(n,(function(n){return n.predicate(t.dom)})),o=X(e,(function(t){return"contexttoolbar"===t.type}));return{contextToolbars:o.pass,contextForms:o.fail}},DE=function(t,n,e){var o=EE(t,n);if(0<o.contextForms.length)return C.some({elem:t,toolbars:[o.contextForms[0]]});var r=EE(t,e);if(0<r.contextForms.length)return C.some({elem:t,toolbars:[r.contextForms[0]]});if(0<o.contextToolbars.length||0<r.contextToolbars.length){var i=function(t){if(t.length<=1)return t;var n=function(n){return N(t,(function(t){return t.position===n}))},e=function(n){return Y(t,(function(t){return t.position===n}))},o=n("selection"),r=n("node");if(o||r){if(r&&o){var i=e("node"),u=W(e("selection"),(function(t){return d(d({},t),{position:"node"})}));return i.concat(u)}return e(o?"selection":"node")}return e("line")}(o.contextToolbars.concat(r.contextToolbars));return C.some({elem:t,toolbars:i})}return C.none()},BE=function(t,n,e){return t(n)?C.none():$e(n,(function(t){var n=EE(t,e.inNodeScope),o=n.contextToolbars,r=n.contextForms,i=0<r.length?r:function(t){if(t.length<=1)return t;var n=function(n){return J(t,(function(t){return t.position===n}))};return n("selection").orThunk((function(){return n("node")})).orThunk((function(){return n("line")})).map((function(t){return t.position})).fold((function(){return[]}),(function(n){return Y(t,(function(t){return t.position===n}))}))}(o);return 0<i.length?C.some({elem:t,toolbars:i}):C.none()}),t)},AE=function(t,n){var e={},o=[],r=[],i={},u={},a=function(t,a){var c=Dn(En("ContextForm",eh,a));(e[t]=c).launch.map((function(e){i["form:"+t]=d(d({},a.launch),{type:"contextformtogglebutton"===e.type?"togglebutton":"button",onAction:function(){n(c)}})})),"editor"===c.scope?r.push(c):o.push(c),u[t]=c},c=function(t,n){En("ContextToolbar",oh,n).each((function(e){"editor"===n.scope?r.push(e):o.push(e),u[t]=e}))},s=_t(t);return G(s,(function(n){var e=t[n];"contextform"===e.type?a(n,e):"contexttoolbar"===e.type&&c(n,e)})),{forms:e,inNodeScope:o,inEditorScope:r,lookupTable:u,formNavigators:i}},ME=ii("forward-slide"),FE=ii("backward-slide"),IE=ii("change-slide-event"),RE="tox-pop--resizing",PE=function(t,n,e){var o,r,i,u,a,c=e.dataset,s="basic"===c.type?function(){return W(c.data,(function(t){return x_(t,e.isSelectedFor,e.getPreviewFor)}))}:c.getData;return{items:(o=n,r=e,i=function(t,n,e,i){var a=o.shared.providers.translate(t.title);if("separator"===t.type)return C.some({type:"separator",text:a});if("submenu"!==t.type)return C.some(d({type:"togglemenuitem",text:a,icon:t.icon,active:t.isSelected(i),disabled:e,onAction:r.onAction(t)},t.getStylePreview().fold((function(){return{}}),(function(t){return{meta:{style:t}}}))));var c=Z(t.getStyleItems(),(function(t){return u(t,n,i)}));return 0===n&&c.length<=0?C.none():C.some({type:"nestedmenuitem",text:a,disabled:c.length<=0,getSubmenuItems:function(){return Z(t.getStyleItems(),(function(t){return u(t,n,i)}))}})},u=function(t,n,e){var o="formatter"===t.type&&r.isInvalid(t);return 0===n?o?[]:i(t,n,!1,e).toArray():i(t,n,o,e).toArray()},{validateItems:a=function(t){var n=r.getCurrentValue(),e=r.shouldHide?0:1;return Z(t,(function(t){return u(t,e,n)}))},getFetch:function(t,n){return function(e,o){var r=n(),i=a(r);o(jC(i,ah.CLOSE_ON_EXECUTE,t,!1))}}}),getStyleItems:s}},VE=function(t,n,o){var r=PE(0,n,o),i=r.items,u=r.getStyleItems;return PC({text:o.icon.isSome()?C.none():C.some(""),icon:o.icon,tooltip:C.from(o.tooltip),role:C.none(),fetch:i.getFetch(n,u),onSetup:function(n){return o.setInitialValue.each((function(t){return t(n.getComponent())})),o.nodeChangeHandler.map((function(e){var o=e(n.getComponent());return t.on("NodeChange",o),function(){t.off("NodeChange",o)}})).getOr(e)},getApi:function(t){return{getComponent:function(){return t}}},columns:1,presets:"normal",classes:o.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",n.shared)};(kO=SO=SO||{})[kO.SemiColon=0]="SemiColon",kO[kO.Space=1]="Space";var HE,LE,zE,NE,jE,UE,WE=function(t,n,e,o){var r,i,u=t.getParam(n,e,"string");return{type:"basic",data:(i=u,r=o===SO.SemiColon?i.replace(/;$/,"").split(";"):i.split(" "),W(r,(function(t){var n=t,e=t,o=t.split("=");return 1<o.length&&(n=o[0],e=o[1]),{title:n,format:e}})))}},GE=[{title:"Left",icon:"align-left",format:"alignleft",command:"JustifyLeft"},{title:"Center",icon:"align-center",format:"aligncenter",command:"JustifyCenter"},{title:"Right",icon:"align-right",format:"alignright",command:"JustifyRight"},{title:"Justify",icon:"align-justify",format:"alignjustify",command:"JustifyFull"}],XE=function(t){var n=function(n){var e=J(GE,(function(n){return t.formatter.match(n.format)})).fold((function(){return"left"}),(function(t){return t.title.toLowerCase()}));Jo(n,RC,{icon:"align-"+e})},e=C.some((function(t){return function(){return n(t)}})),o=C.some(n),r={type:"basic",data:GE};return{tooltip:"Align",icon:C.some("align-left"),isSelectedFor:function(n){return function(){return t.formatter.match(n)}},getCurrentValue:C.none,getPreviewFor:function(t){return function(){return C.none()}},onAction:function(n){return function(){return J(GE,(function(t){return t.format===n.format})).each((function(n){return t.execCommand(n.command)}))}},setInitialValue:o,nodeChangeHandler:e,dataset:r,shouldHide:!1,isInvalid:function(n){return!t.formatter.canApply(n.format)}}},YE=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],qE=function(t){var n=t.split(/\s*,\s*/);return W(n,(function(t){return t.replace(/^['"]+|['"]+$/g,"")}))},KE=function(t){var n;return 0===t.indexOf("-apple-system")&&(n=qE(t.toLowerCase()),tt(YE,(function(t){return-1<n.indexOf(t.toLowerCase())})))},JE=function(t){var n=function(){var n=function(t){return t?qE(t)[0]:""},e=t.queryCommandValue("FontName"),o=i.data,r=e?e.toLowerCase():"";return{matchOpt:J(o,(function(t){var e=t.format;return e.toLowerCase()===r||n(e).toLowerCase()===n(r).toLowerCase()})).orThunk((function(){return KE(r)?C.from({title:"System Font",format:r}):C.none()})),font:e}},e=function(t){var e=n(),o=e.matchOpt,r=e.font,i=o.fold((function(){return r}),(function(t){return t.title}));Jo(t,IC,{text:i})},o=C.some((function(t){return function(){return e(t)}})),r=C.some(e),i=WE(t,"font_formats","Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats",SO.SemiColon);return{tooltip:"Fonts",icon:C.none(),isSelectedFor:function(t){return function(n){return n.exists((function(n){return n.format===t}))}},getCurrentValue:function(){return n().matchOpt},getPreviewFor:function(t){return function(){return C.some({tag:"div",styles:-1===t.indexOf("dings")?{"font-family":t}:{}})}},onAction:function(n){return function(){t.undoManager.transact((function(){t.focus(),t.execCommand("FontName",!1,n.format)}))}},setInitialValue:r,nodeChangeHandler:o,dataset:i,shouldHide:!1,isInvalid:s}},$E={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},QE={"xx-small":"7pt","x-small":"8pt",small:"10pt",medium:"12pt",large:"14pt","x-large":"18pt","xx-large":"24pt"},ZE=function(t,n){return/[0-9.]+px$/.test(t)?(e=72*parseInt(t,10)/96,o=n||0,r=Math.pow(10,o),Math.round(e*r)/r+"pt"):Rt(QE,t).getOr(t);var e,o,r},tD=function(t){var n=function(){var n=C.none(),e=a.data,o=t.queryCommandValue("FontSize");if(o)for(var r=function(t){var r=ZE(o,t),i=Rt($E,r).getOr("");n=J(e,(function(t){return t.format===o||t.format===r||t.format===i}))},i=3;n.isNone()&&0<=i;i--)r(i);return{matchOpt:n,size:o}},e=r(C.none),o=function(t){var e=n(),o=e.matchOpt,r=e.size,i=o.fold((function(){return r}),(function(t){return t.title}));Jo(t,IC,{text:i})},i=C.some((function(t){return function(){return o(t)}})),u=C.some(o),a=WE(t,"fontsize_formats","8pt 10pt 12pt 14pt 18pt 24pt 36pt",SO.Space);return{tooltip:"Font sizes",icon:C.none(),isSelectedFor:function(t){return function(n){return n.exists((function(n){return n.format===t}))}},getPreviewFor:e,getCurrentValue:function(){return n().matchOpt},onAction:function(n){return function(){t.undoManager.transact((function(){t.focus(),t.execCommand("FontSize",!1,n.format)}))}},setInitialValue:u,nodeChangeHandler:i,dataset:a,shouldHide:!1,isInvalid:s}},nD=function(t,n){var e=n(),o=W(e,(function(t){return t.format}));return C.from(t.formatter.closest(o)).bind((function(t){return J(e,(function(n){return n.format===t}))})).orThunk((function(){return $f(t.formatter.match("p"),{title:"Paragraph",format:"p"})}))},eD=function(t){var n=me(C.none()),e=function(){return n.get().each(t)};return{clear:function(){e(),n.set(C.none())},isSet:function(){return n.get().isSome()},set:function(t){e(),n.set(C.some(t))}}},oD=function(){return eD((function(t){return t.destroy()}))},rD=function(){return eD((function(t){return t.unbind()}))},iD=function(t,n){return function(e){var o=rD(),r=function(){e.setActive(t.formatter.match(n));var r=t.formatter.formatChanged(n,e.setActive);o.set(r)};return t.initialized?r():t.on("init",r),o.clear}},uD=function(t){return function(n){return function(){t.undoManager.transact((function(){t.focus(),t.execCommand("mceToggleFormat",!1,n.format)}))}}},aD=function(t){var n=function(n){var e=nD(t,(function(){return r.data})).fold((function(){return"Paragraph"}),(function(t){return t.title}));Jo(n,IC,{text:e})},e=C.some((function(t){return function(){return n(t)}})),o=C.some(n),r=WE(t,"block_formats","Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre",SO.SemiColon);return{tooltip:"Blocks",icon:C.none(),isSelectedFor:function(n){return function(){return t.formatter.match(n)}},getCurrentValue:C.none,getPreviewFor:function(n){return function(){var e=t.formatter.get(n);return C.some({tag:0<e.length&&(e[0].inline||e[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))})}},onAction:uD(t),setInitialValue:o,nodeChangeHandler:e,dataset:r,shouldHide:!1,isInvalid:function(n){return!t.formatter.canApply(n.format)}}},cD=function(t,n){var e=function(n){var e=function t(n){var e=n.items;return void 0!==e&&0<e.length?Z(e,t):[{title:n.title,format:n.format}]},o=Z(y_(t),e),r=nD(t,(function(){return o})).fold((function(){return"Paragraph"}),(function(t){return t.title}));Jo(n,IC,{text:r})},o=C.some((function(t){return function(){return e(t)}})),r=C.some(e);return{tooltip:"Formats",icon:C.none(),isSelectedFor:function(n){return function(){return t.formatter.match(n)}},getCurrentValue:C.none,getPreviewFor:function(n){return function(){var e=t.formatter.get(n);return void 0!==e?C.some({tag:0<e.length&&(e[0].inline||e[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))}):C.none()}},onAction:uD(t),setInitialValue:r,nodeChangeHandler:o,shouldHide:t.getParam("style_formats_autohide",!1,"boolean"),isInvalid:function(n){return!t.formatter.canApply(n.format)},dataset:n}},sD=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styleselect"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],lD=function(t,n){return function(e,o,r){var i=t(e).mapError((function(t){return An(t)})).getOrDie();return n(i,o,r)}},fD={button:lD(Xp,(function(t,n){return e=t,o=n.backstage.shared.providers,xE(e,o,[]);var e,o})),togglebutton:lD(Kp,(function(t,n){return e=t,o=n.backstage.shared.providers,wE(e,o,[]);var e,o})),menubutton:lD(nE,(function(t,n){return WC(t,"tox-tbtn",n.backstage,C.none())})),splitbutton:lD((function(t){return En("SplitButton",eE,t)}),(function(t,n){return SE(t,n.backstage.shared)})),grouptoolbarbutton:lD((function(t){return En("GroupToolbarButton",QT,t)}),(function(t,n,e){var o,r,i,u,a,c,s=e.ui.registry.getAll().buttons,l=((o={})[qc]=n.backstage.shared.header.isPositionedAtTop()?ea.TopToBottom:ea.BottomToTop,o);switch(Dv(e)){case ih.floating:return r=t,i=n.backstage,u=function(t){return pD(e,{buttons:s,toolbar:t,allowToolbarGroups:!1},n,C.none())},a=l,c=i.shared,hT.sketch({lazySink:c.getSink,fetch:function(){return Cx((function(t){t(W(u(r.items),XT))}))},markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:bE(r.icon,r.text,r.tooltip,C.none(),C.none(),c.providers),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:a}}}});default:throw new Error("Toolbar groups are only supported when using floating toolbar mode")}})),styleSelectButton:function(t,n){return e=t,o=n.backstage,r=d({type:"advanced"},o.styleselect),VE(e,o,cD(e,r));var e,o,r},fontsizeSelectButton:function(t,n){return e=t,o=n.backstage,VE(e,o,tD(e));var e,o},fontSelectButton:function(t,n){return e=t,o=n.backstage,VE(e,o,JE(e));var e,o},formatButton:function(t,n){return e=t,o=n.backstage,VE(e,o,aD(e));var e,o},alignMenuButton:function(t,n){return e=t,o=n.backstage,VE(e,o,XE(e));var e,o}},dD={styleselect:fD.styleSelectButton,fontsizeselect:fD.fontsizeSelectButton,fontselect:fD.fontSelectButton,formatselect:fD.formatButton,align:fD.alignMenuButton},mD=function(t){var n,e,o,r=t.toolbar,i=t.buttons;return!1===r?[]:void 0===r||!0===r?(e=i,o=W(sD,(function(t){var n=Y(t.items,(function(t){return Pt(e,t)||Pt(dD,t)}));return{name:t.name,items:n}})),Y(o,(function(t){return 0<t.items.length}))):T(r)?(n=r.split("|"),W(n,(function(t){return{items:t.trim().split(" ")}}))):R(r,(function(t){return Pt(t,"name")&&Pt(t,"items")}))?r:(console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[])},gD=function(t,n,e,o,r,i){return Rt(n,e.toLowerCase()).orThunk((function(){return i.bind((function(t){return ct(t,(function(t){return Rt(n,t+e.toLowerCase())}))}))})).fold((function(){return Rt(dD,e.toLowerCase()).map((function(n){return n(t,r)})).orThunk((function(){return C.none()}))}),(function(n){return"grouptoolbarbutton"!==n.type||o?(u=r,a=t,Rt(fD,(i=n).type).fold((function(){return console.error("skipping button defined by",i),C.none()}),(function(t){return C.some(t(i,u,a))}))):(console.warn("Ignoring the '"+e+"' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested."),C.none());var i,u,a}))},pD=function(t,n,e,o){var r=mD(n),i=W(r,(function(r){var i=Z(r.items,(function(r){return 0===r.trim().length?[]:gD(t,n.buttons,r,n.allowToolbarGroups,e,o).toArray()}));return{title:C.from(t.translate(r.name)),items:i}}));return Y(i,(function(t){return 0<t.items.length}))},hD={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},vD={maxHeightFunction:Ic(),maxWidthFunction:$_()},bD={onLtr:function(){return[Ua,Wa,Na,La,ja,za,fp,dp,sp,ap,lp,cp]},onRtl:function(){return[Ua,Wa,ja,za,Na,La,fp,dp,lp,cp,sp,ap]}},yD={onLtr:function(){return[Wa,La,za,Na,ja,Ua,fp,dp,sp,ap,lp,cp]},onRtl:function(){return[Wa,za,La,ja,Na,Ua,fp,dp,lp,cp,sp,ap]}},xD=function(t,n,o,r){var i,u,a=We().deviceType.isTouch,c=pu((i={sink:o,onEscape:function(){return t.focus(),C.some(!0)}},u=me([]),np.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:function(t){u.set([]),np.getContent(t).each((function(t){eu(t.element,"visibility")})),Li(t.element,RE),eu(t.element,"width")},inlineBehaviours:uc([mg("context-toolbar-events",[lr(xo(),(function(t,n){Li(t.element,RE),eu(t.element,"width")})),rr(IE,(function(t,n){var e=t.element;eu(e,"width");var o=Tu(e);np.setContent(t,n.event.contents),Vi(e,RE);var r=Tu(e);Ki(e,"width",o+"px"),np.getContent(t).each((function(t){n.event.focus.bind((function(t){return gc(t),hc(e)})).orThunk((function(){return ag.focusIn(t),pc(Fr(e))}))})),mp.setTimeout((function(){Ki(t.element,"width",r+"px")}),0)})),rr(ME,(function(t,n){np.getContent(t).each((function(n){u.set(u.get().concat([{bar:n,focus:pc(Fr(t.element))}]))})),Jo(t,IE,{contents:n.event.forwardContents,focus:C.none()})})),rr(FE,(function(t,n){ut(u.get()).each((function(n){u.set(u.get().slice(0,u.get().length-1)),Jo(t,IE,{contents:hu(n.bar),focus:n.focus})}))}))]),ag.config({mode:"special",onEscape:function(t){return ut(u.get()).fold((function(){return i.onEscape()}),(function(n){return Ko(t,FE),C.some(!0)}))}})]),lazySink:function(){return ft.value(i.sink)}}))),s=function(){return TE(t,r.backstage.shared)},l=function(){if(a()&&r.backstage.isContextMenuOpen())return!0;var n,e,o,i,u,c,l=(n=h.get().filter((function(t){return Wi(pe.fromDom(t))})).map((function(t){return t.getBoundingClientRect()})).getOrThunk((function(){return t.selection.getRng().getBoundingClientRect()})),e=t.inline?Mu().top:Nu(pe.fromDom(t.getBody())).y,{y:n.top+e,bottom:n.bottom+e}),f=s();return o=l.y,i=l.bottom,u=f.y,c=f.bottom,!(Math.max(o,u)<=Math.min(i,c))},f=function(){p.set(C.none()),np.hide(c)},m=function(){np.hide(c)},g=function(){p.get().each((function(t){var n=c.element;eu(n,"display"),l()?Ki(n,"display","none"):nl.positionWithinBounds(o,t,c,C.some(s()))}))},p=me(C.none()),h=me(C.none()),v=me(null),b=function(n){return{dom:{tag:"div",classes:["tox-pop__dialog"]},components:[n],behaviours:uc([ag.config({mode:"acyclic"}),mg("pop-dialog-wrap-events",[fr((function(n){t.shortcuts.add("ctrl+F9","focus statusbar",(function(){return ag.focusIn(n)}))})),dr((function(n){t.shortcuts.remove("ctrl+F9")}))])])}},y=Ut((function(){return AE(n,(function(t){var n=x([t]);Jo(c,ME,{forwardContents:b(n)})}))})),x=function(n){var e=t.ui.registry.getAll().buttons,o=y(),i=d(d({},e),o.formNavigators),u=Dv(t)===ih.scrolling?ih.scrolling:ih["default"],a=Q(W(n,(function(n){return"contexttoolbar"===n.type?pD(t,{buttons:i,toolbar:n.items,allowToolbarGroups:!1},r,C.some(["form:"])):(e=n,o=r.backstage.shared.providers,_E(e,o));var e,o})));return $T({type:u,uid:ii("context-toolbar"),initGroups:a,onEscape:C.none,cyclicKeying:!0,providers:r.backstage.shared.providers})};t.on("contexttoolbar-show",(function(n){var e=y();Rt(e.lookupTable,n.toolbarKey).each((function(e){S([e],n.target===t?C.none():C.some(n)),np.getContent(c).each(ag.focusIn)}))}));var w=function(t,n){var e,o,i="node"===t?r.backstage.shared.anchors.node(n):r.backstage.shared.anchors.cursor();return Nt(i,(e=t,o=a(),"line"===e?{bubble:Lc(12,0,hD),layouts:{onLtr:function(){return[Ga]},onRtl:function(){return[Xa]}},overrides:vD}:{bubble:Lc(0,12,hD),layouts:o?yD:bD,overrides:vD}))},S=function(t,n){var e,o,i,u;O(),a()&&r.backstage.isContextMenuOpen()||(e=x(t),o=n.map(pe.fromDom),i=w(t[0].position,o),p.set(C.some(i)),h.set(n),u=c.element,eu(u,"display"),np.showWithinBounds(c,i,b(e),(function(){return C.some(s())})),l()&&Ki(u,"display","none"))},k=function(){var n,e,o,r,i,u,a;t.hasFocus()&&(n=y(),e=n,o=t,i=pe.fromDom(o.getBody()),u=function(t){return Ye(t,i)},a=pe.fromDom(o.selection.getNode()),(u(r=a)||Ke(i,r)?DE(a,e.inNodeScope,e.inEditorScope).orThunk((function(){return BE(u,a,e)})):C.none()).fold(f,(function(t){S(t.toolbars,C.some(t.elem.dom))})))},O=function(){var t=v.get();null!==t&&(mp.clearTimeout(t),v.set(null))},_=function(){O(),v.set(mp.setEditorTimeout(t,k,0))};t.on("init",(function(){t.on(Q_,m),t.on("ScrollContent ScrollWindow longpress",g),t.on("click keyup focus SetContent ObjectResized ResizeEditor",(function(){_()})),t.on("focusout",(function(n){mp.setEditorTimeout(t,(function(){hc(o.element).isNone()&&hc(c.element).isNone()&&f()}),0)})),t.on("SwitchMode",(function(){t.mode.isReadOnly()&&f()})),t.on("AfterProgressState",(function(n){n.state?f():t.hasFocus()&&_()})),t.on("NodeChange",(function(t){hc(c.element).fold(_,e)}))}))},wD=jf,SD=Of,kD=r([oe("shell",!1),Un("makeItem"),oe("setupItem",e),Yl("listBehaviours",[dg])]),CD=Sf({name:"items",overrides:function(){return{behaviours:uc([dg.config({})])}}}),OD=r([CD]),_D=Kf({name:r("CustomList")(),configFields:kD(),partFields:OD(),factory:function(t,n,e,o){var r=t.shell?{behaviours:[dg.config({})],components:[]}:{behaviours:[],components:n},i=function(n){return t.shell?C.some(n):If(n,t,"items")};return{uid:t.uid,dom:t.dom,components:r.components,behaviours:Xl(t.listBehaviours,r.behaviours),apis:{setItems:function(n,e){i(n).fold((function(){throw console.error("Custom List was defined to not be a shell, but no item container was specified in components"),new Error("Custom List was defined to not be a shell, but no item container was specified in components")}),(function(o){var r=dg.contents(o),i=e.length,u=i-r.length,a=0<u?j(u,(function(){return t.makeItem()})):[],c=r.slice(i);G(c,(function(t){return dg.remove(o,t)})),G(a,(function(t){return dg.append(o,t)}));var s=dg.contents(o);G(s,(function(o,r){t.setupItem(n,o,e[r],r)}))}))}}}},apis:{setItems:function(t,n,e){t.setItems(n,e)}}}),TD=r([]),ED=Object.freeze({__proto__:null,setup:e,isDocked:s,getBehaviours:TD}),DD=function(t){return(tu(t,"position").is("fixed")?C.none():Tr(t)).orThunk((function(){var n=pe.fromTag("span");return Or(t).bind((function(t){Nr(t,n);var e=Tr(n);return Wr(n),e}))}))},BD=function(t){return DD(t).map(Cu).getOrThunk((function(){return Su(0,0)}))},AD=Ht([{static:[]},{absolute:["positionCss"]},{fixed:["positionCss"]}]),MD=function(t,n){var e=t.element;Vi(e,n.transitionClass),Li(e,n.fadeOutClass),Vi(e,n.fadeInClass),n.onShow(t)},FD=function(t,n){var e=t.element;Vi(e,n.transitionClass),Li(e,n.fadeInClass),Vi(e,n.fadeOutClass),n.onHide(t)},ID=function(t,n,e){return tt(t,(function(t){switch(t){case"bottom":return r=e,n.bottom<=r.bottom;case"top":return o=e,n.y>=o.y}var o,r}))},RD=function(t,n){return n.getInitialPosition().map((function(n){return Lu(n.bounds.x,n.bounds.y,Tu(t),yu(t))}))},PD=function(t,n,e){e.setInitialPosition(C.some({style:function(t){var n={},e=t.dom;if(Ui(e))for(var o=0;o<e.style.length;o++){var r=e.style.item(o);n[r]=e.style[r]}return n}(t),position:Qi(t,"position")||"static",bounds:n}))},VD=function(t,n,e){return e.getInitialPosition().bind((function(o){switch(e.setInitialPosition(C.none()),o.position){case"static":return C.some(AD["static"]());case"absolute":var r=DD(t).map(zu).getOrThunk((function(){return zu(Gi())}));return C.some(AD.absolute(bc("absolute",Rt(o.style,"left").map((function(t){return n.x-r.x})),Rt(o.style,"top").map((function(t){return n.y-r.y})),Rt(o.style,"right").map((function(t){return r.right-n.right})),Rt(o.style,"bottom").map((function(t){return r.bottom-n.bottom})))));default:return C.none()}}))},HD=function(t,n,e){var o,r,i,u=t.element;return tu(u,"position").is("fixed")?(r=n,RD(o=u,i=e).filter((function(t){return ID(i.getModes(),t,r)})).bind((function(t){return VD(o,t,i)}))):function(t,n,e){var o=zu(t);if(ID(e.getModes(),o,n))return C.none();PD(t,o,e);var r=ju(),i=o.x-r.x,u=n.y-r.y,a=r.bottom-n.bottom,c=o.y<=n.y;return C.some(AD.fixed(bc("fixed",C.some(i),c?C.some(u):C.none(),C.none(),c?C.none():C.some(a))))}(u,n,e)},LD=function(t,n){G(["left","right","top","bottom","position"],(function(n){return eu(t.element,n)})),n.onUndocked(t)},zD=function(t,n,e){yc(t.element,e),("fixed"===e.position?n.onDocked:n.onUndocked)(t)},ND=function(t,n,e,o,r){void 0===r&&(r=!1),n.contextual.each((function(n){n.lazyContext(t).each((function(i){var u,a,c=(a=o,(u=i).y<a.bottom&&u.bottom>a.y);c!==e.isVisible()&&(e.setVisible(c),r&&!c?(Ni(t.element,[n.fadeOutClass]),n.onHide(t)):(c?MD:FD)(t,n))}))}))},jD=function(t,n,o){var r,i,u=t.element;o.setDocked(!1),r=o,i=t.element,RD(i,r).bind((function(t){return VD(i,t,r)})).each((function(o){o.fold((function(){return LD(t,n)}),(function(e){return zD(t,n,e)}),e)})),o.setVisible(!0),n.contextual.each((function(n){ji(u,[n.fadeInClass,n.fadeOutClass,n.transitionClass]),n.onShow(t)})),UD(t,n,o)},UD=function(t,n,e){var o,r,i,u,a;t.getSystem().isConnected()&&(o=t,i=e,u=(r=n).lazyViewport(o),(a=i.isDocked())&&ND(o,r,i,u),HD(o,u,i).each((function(t){i.setDocked(!a),t.fold((function(){return LD(o,r)}),(function(t){return zD(o,r,t)}),(function(t){ND(o,r,i,u,!0),zD(o,r,t)}))})))},WD=function(t,n,e){e.isDocked()&&jD(t,n,e)},GD=Object.freeze({__proto__:null,refresh:UD,reset:WD,isDocked:function(t,n,e){return e.isDocked()},getModes:function(t,n,e){return e.getModes()},setModes:function(t,n,e,o){return e.setModes(o)}}),XD=Object.freeze({__proto__:null,events:function(t,n){return nr([lr(xo(),(function(e,o){t.contextual.each((function(t){zi(e.element,t.transitionClass)&&(ji(e.element,[t.transitionClass,t.fadeInClass]),(n.isVisible()?t.onShown:t.onHidden)(e)),o.stop()}))})),rr(Vo(),(function(e,o){UD(e,t,n)})),rr(Ho(),(function(e,o){WD(e,t,n)}))])}}),YD=[ee("contextual",[Gn("fadeInClass"),Gn("fadeOutClass"),Gn("transitionClass"),Yn("lazyContext"),pa("onShow"),pa("onShown"),pa("onHide"),pa("onHidden")]),se("lazyViewport",ju),le("modes",["top","bottom"],Vn),pa("onDocked"),pa("onUndocked")],qD=cc({fields:YD,name:"docking",active:XD,apis:GD,state:Object.freeze({__proto__:null,init:function(t){var n=me(!1),e=me(!0),o=me(C.none()),r=me(t.modes);return Si({isDocked:n.get,setDocked:n.set,getInitialPosition:o.get,setInitialPosition:o.set,isVisible:e.get,setVisible:e.set,getModes:r.get,setModes:r.set,readState:function(){return"docked:  "+n.get()+", visible: "+e.get()+", modes: "+r.get().join(",")}})}})}),KD={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},JD="tox-tinymce--toolbar-sticky-on",$D="tox-tinymce--toolbar-sticky-off",QD=function(t){var n=t.element;Or(n).each((function(e){var o,r,i="padding-"+qD.getModes(t)[0];qD.isDocked(t)?(o=Tu(e),Ki(n,"width",o+"px"),Ki(e,i,xu(r=n)+(parseInt(Qi(r,"margin-top"),10)||0)+(parseInt(Qi(r,"margin-bottom"),10)||0)+"px")):(eu(n,"width"),eu(e,i))}))},ZD=function(t,n){n?(Li(t,KD.fadeOutClass),Ni(t,[KD.transitionClass,KD.fadeInClass])):(Li(t,KD.fadeInClass),Ni(t,[KD.fadeOutClass,KD.transitionClass]))},tB=function(t,n){var e=pe.fromDom(t.getContainer());n?(Vi(e,JD),Li(e,$D)):(Vi(e,$D),Li(e,JD))},nB=function(t,n){var e,o=me(C.none()),r=n.getSink,i=function(t){r().each((function(n){return t(n.element)}))},u=function(n){t.inline||QD(n),tB(t,qD.isDocked(n)),n.getSystem().broadcastOn([Ol()],{}),r().each((function(t){return t.getSystem().broadcastOn([Ol()],{})}))},a=t.inline?[]:[dc.config({channels:((e={})[WT()]={onReceive:QD},e)})];return g([bg.config({}),qD.config({contextual:d({lazyContext:function(n){var e,o,r=xu(n.element),i=t.inline?t.getContentAreaContainer():t.getContainer(),u=zu(pe.fromDom(i)),a=u.height-r,c=u.y+(e=n,o="top",z(qD.getModes(e),o)?0:r);return C.some(Lu(u.x,c,u.width,a))},onShow:function(){i((function(t){return ZD(t,!0)}))},onShown:function(t){i((function(t){return ji(t,[KD.transitionClass,KD.fadeInClass])})),o.get().each((function(n){var e,r,i;e=t.element,i=wr(r=n),pc(i).filter((function(t){return!Ye(r,t)})).filter((function(t){return Ye(t,pe.fromDom(i.dom.body))||Ke(e,t)})).each((function(){return gc(r)})),o.set(C.none())}))},onHide:function(t){var n,e;o.set((n=t.element,e=r,hc(n).orThunk((function(){return e().toOptional().bind((function(t){return hc(t.element)}))})))),i((function(t){return ZD(t,!1)}))},onHidden:function(){i((function(t){return ji(t,[KD.transitionClass])}))}},KD),modes:[n.header.getDockingMode()],onDocked:u,onUndocked:u})],a)},eB=Object.freeze({__proto__:null,setup:function(t,n,e){t.inline||(n.header.isPositionedAtTop()||t.on("ResizeEditor",(function(){e().each(qD.reset)})),t.on("ResizeWindow ResizeEditor",(function(){e().each(QD)})),t.on("SkinLoaded",(function(){e().each((function(t){qD.isDocked(t)?qD.reset(t):qD.refresh(t)}))})),t.on("FullscreenStateChanged",(function(){e().each(qD.reset)}))),t.on("AfterScrollIntoView",(function(t){e().each((function(n){qD.refresh(n);var e,o,r,i,u,a,c,s,l,f,d,m,g,p,h,v,b,y=n.element;nm(y)&&(e=t,i=wr(o=y),u=i.dom.defaultView.innerHeight,a=Mu(i),c=pe.fromDom(e.elm),s=Nu(c),l=yu(c),f=s.y,d=f+l,m=Cu(o),g=yu(o),p=m.top,h=p+g,v=Math.abs(p-a.top)<2,b=Math.abs(h-(a.top+u))<2,v&&f<h?Fu(a.left,f-g,i):b&&p<d&&(r=f-u+l+g,Fu(a.left,r,i)))}))})),t.on("PostRender",(function(){tB(t,!1)}))},isDocked:function(t){return t().map(qD.isDocked).getOr(!1)},getBehaviours:nB}),oB=qf({factory:function(t,n){var e={focus:ag.focusIn,setMenus:function(t,e){var o=W(e,(function(t){var e={type:"menubutton",text:t.text,fetch:function(n){n(t.getItems())}},o=nE(e).mapError((function(t){return An(t)})).getOrDie();return WC(o,"tox-mbtn",n.backstage,C.some("menuitem"))}));dg.set(t,o)}};return{uid:t.uid,dom:t.dom,components:[],behaviours:uc([dg.config({}),mg("menubar-events",[fr((function(n){t.onSetup(n)})),rr(fo(),(function(t,n){Ju(t.element,".tox-mbtn--active").each((function(e){$u(n.event.target,".tox-mbtn").each((function(n){Ye(e,n)||t.getSystem().getByDom(e).each((function(e){t.getSystem().getByDom(n).each((function(t){iw.expand(t),iw.close(e),bg.focus(t)}))}))}))}))})),rr(Uo(),(function(t,n){n.event.prevFocus.bind((function(n){return t.getSystem().getByDom(n).toOptional()})).each((function(e){n.event.newFocus.bind((function(n){return t.getSystem().getByDom(n).toOptional()})).each((function(t){iw.isOpen(e)&&(iw.expand(t),iw.close(e))}))}))}))]),ag.config({mode:"flow",selector:".tox-mbtn",onEscape:function(n){return t.onEscape(n),C.some(!0)}}),Ky.config({})]),apis:e,domModification:{attributes:{role:"menubar"}}}},name:"silver.Menubar",configFields:[Un("dom"),Un("uid"),Un("onEscape"),Un("backstage"),oe("onSetup",e)],apis:{focus:function(t,n){t.focus(n)},setMenus:function(t,n,e){t.setMenus(n,e)}}}),rB="container",iB=[Wl("slotBehaviours",[])],uB=function(t){return"<alloy.field."+t+">"},aB=function(t,n){var e,o=function(n){return Hf(t)},r=function(n,e){return function(o,r){return If(o,t,r).map((function(t){return n(t,r)})).getOr(e)}},i=function(t,n){return"true"!==Jr(t.element,"aria-hidden")},u=r(i,!1),a=r((function(t,n){var e;i(t)&&(e=t.element,Ki(e,"display","none"),Kr(e,"aria-hidden","true"),Jo(t,Wo(),{name:n,visible:!1}))})),c=function(t,n){G(n,(function(n){return e(t,n)}))},s=r((function(t,n){var e;i(t)||(e=t.element,eu(e,"display"),Zr(e,"aria-hidden"),Jo(t,Wo(),{name:n,visible:!0}))})),l={getSlotNames:o,getSlot:function(n,e){return If(n,t,e)},isShowing:u,hideSlot:e=a,hideAllSlots:function(t){return c(t,o())},showSlot:s};return{uid:t.uid,dom:t.dom,components:n,behaviours:Gl(t.slotBehaviours),apis:l}},cB=Dt({getSlotNames:function(t,n){return t.getSlotNames(n)},getSlot:function(t,n,e){return t.getSlot(n,e)},isShowing:function(t,n,e){return t.isShowing(n,e)},hideSlot:function(t,n,e){return t.hideSlot(n,e)},hideAllSlots:function(t,n){return t.hideAllSlots(n)},showSlot:function(t,n,e){return t.showSlot(n,e)}},xi),sB=d(d({},cB),{sketch:function(t){var n,e=(n=[],{slot:function(t,e){return n.push(t),Df(rB,uB(t),e)},record:function(){return n}}),o=t(e),r=e.record(),i=W(r,(function(t){return xf({name:t,pname:uB(t)})}));return Wf(rB,iB,i,aB,o)}}),lB=mn([te("icon"),te("tooltip"),se("onShow",e),se("onHide",e),se("onSetup",(function(){return e}))]),fB=function(t){return{element:function(){return t.element.dom}}},dB=function(t,n){var o=W(_t(n),(function(t){var e=n[t],o=Dn(En("sidebar",lB,e));return{name:t,getApi:fB,onSetup:o.onSetup,onShow:o.onShow,onHide:o.onHide}}));return W(o,(function(n){var r=me(e);return t.slot(n.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:Gh([Jv(n,r),$v(n,r),rr(Wo(),(function(t,n){var e=n.event;J(o,(function(t){return t.name===e.name})).each((function(n){(e.visible?n.onShow:n.onHide)(n.getApi(t))}))}))])})}))},mB=function(t,n){nd.getCurrent(t).each((function(t){return dg.set(t,[(e=n,sB.sketch((function(t){return{dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:dB(t,e),slotBehaviours:Gh([fr((function(t){return sB.hideAllSlots(t)}))])}})))]);var e}))},gB=function(t){return nd.getCurrent(t).bind((function(t){return HT.isGrowing(t)||HT.hasGrown(t)?nd.getCurrent(t).bind((function(t){return J(sB.getSlotNames(t),(function(n){return sB.isShowing(t,n)}))})):C.none()}))},pB=ii("FixSizeEvent"),hB=ii("AutoSizeEvent"),vB=function(t){var n,e,o,r=pe.fromHtml(t),i=Er(r),u=(e=void 0!==(n=r).dom.attributes?n.dom.attributes:[],K(e,(function(t,n){var e;return"class"===n.name?t:d(d({},t),((e={})[n.name]=n.value,e))}),{})),a=(o=r,Array.prototype.slice.call(o.dom.classList,0)),c=0===i.length?{}:{innerHtml:Xr(r)};return d({tag:pr(r),classes:a,attributes:u},c)},bB=function(t,n,e){var o=t.element;!0===n?(dg.set(t,[{dom:{tag:"div",attributes:{"aria-label":e.translate("Loading...")},classes:["tox-throbber__busy-spinner"]},components:[{dom:vB('<div class="tox-spinner"><div></div><div></div><div></div></div>')}],behaviours:uc([ag.config({mode:"special",onTab:function(){return C.some(!0)},onShiftTab:function(){return C.some(!0)}}),bg.config({})])}]),eu(o,"display"),Zr(o,"aria-hidden")):(dg.set(t,[]),Ki(o,"display","none"),Kr(o,"aria-hidden","true"))},yB=SD.optional({factory:oB,name:"menubar",schema:[Un("backstage")]}),xB=SD.optional({factory:{sketch:function(t){return _D.sketch({uid:t.uid,dom:t.dom,listBehaviours:uc([ag.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:function(){return $T({type:t.type,uid:ii("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],providers:t.providers,onEscape:function(){return t.onEscape(),C.some(!0)}})},setupItem:function(t,n,e,o){nT.setGroups(n,e)},shell:!0})}},name:"multiple-toolbar",schema:[Un("dom"),Un("onEscape")]}),wB=SD.optional({factory:{sketch:function(t){var n;return((n=t).type===ih.sliding?JT:n.type===ih.floating?KT:$T)({type:t.type,uid:t.uid,onEscape:function(){return t.onEscape(),C.some(!0)},cyclicKeying:!1,initGroups:[],getSink:t.getSink,providers:t.providers,moreDrawerData:{lazyToolbar:t.lazyToolbar,lazyMoreButton:t.lazyMoreButton,lazyHeader:t.lazyHeader},attributes:t.attributes})}},name:"toolbar",schema:[Un("dom"),Un("onEscape"),Un("getSink")]}),SB=SD.optional({factory:{sketch:function(t){var n=t.editor,e=t.sticky?nB:TD;return{uid:t.uid,dom:t.dom,components:t.components,behaviours:uc(e(n,t.sharedBackstage))}}},name:"header",schema:[Un("dom")]}),kB=SD.optional({name:"socket",schema:[Un("dom")]}),CB=SD.optional({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"complementary"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:uc([Ky.config({}),bg.config({}),HT.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:function(t){nd.getCurrent(t).each(sB.hideAllSlots),Ko(t,hB)},onGrown:function(t){Ko(t,hB)},onStartGrow:function(t){Jo(t,pB,{width:tu(t.element,"width").getOr("")})},onStartShrink:function(t){Jo(t,pB,{width:Tu(t.element)+"px"})}}),dg.config({}),nd.config({find:function(t){var n=dg.contents(t);return it(n)}})])}],behaviours:uc([sk(0),mg("sidebar-sliding-events",[rr(pB,(function(t,n){Ki(t.element,"width",n.event.width)})),rr(hB,(function(t,n){eu(t.element,"width")}))])])}}},name:"sidebar",schema:[Un("dom")]}),OB=SD.optional({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:uc([dg.config({})]),components:[]}}},name:"throbber",schema:[Un("dom")]}),_B=Kf({name:"OuterContainer",factory:function(t,n,e){var o={getSocket:function(n){return wD.getPart(n,t,"socket")},setSidebar:function(n,e){wD.getPart(n,t,"sidebar").each((function(t){return mB(t,e)}))},toggleSidebar:function(n,e){wD.getPart(n,t,"sidebar").each((function(t){return n=t,o=e,void nd.getCurrent(n).each((function(t){nd.getCurrent(t).each((function(n){HT.hasGrown(t)?sB.isShowing(n,o)?HT.shrink(t):(sB.hideAllSlots(n),sB.showSlot(n,o)):(sB.hideAllSlots(n),sB.showSlot(n,o),HT.grow(t))}))}));var n,o}))},whichSidebar:function(n){return wD.getPart(n,t,"sidebar").bind(gB).getOrNull()},getHeader:function(n){return wD.getPart(n,t,"header")},getToolbar:function(n){return wD.getPart(n,t,"toolbar")},setToolbar:function(n,e){wD.getPart(n,t,"toolbar").each((function(t){t.getApis().setGroups(t,e)}))},setToolbars:function(n,e){wD.getPart(n,t,"multiple-toolbar").each((function(t){_D.setItems(t,e)}))},refreshToolbar:function(n){wD.getPart(n,t,"toolbar").each((function(t){return t.getApis().refresh(t)}))},toggleToolbarDrawer:function(n){wD.getPart(n,t,"toolbar").each((function(t){var n,e;n=t.getApis().toggle,e=function(n){return n(t)},void 0!==n&&null!==n?C.some(e(n)):C.none()}))},isToolbarDrawerToggled:function(n){return wD.getPart(n,t,"toolbar").bind((function(t){return C.from(t.getApis().isOpen).map((function(n){return n(t)}))})).getOr(!1)},getThrobber:function(n){return wD.getPart(n,t,"throbber")},focusToolbar:function(n){wD.getPart(n,t,"toolbar").orThunk((function(){return wD.getPart(n,t,"multiple-toolbar")})).each((function(t){ag.focusIn(t)}))},setMenubar:function(n,e){wD.getPart(n,t,"menubar").each((function(t){oB.setMenus(t,e)}))},focusMenubar:function(n){wD.getPart(n,t,"menubar").each((function(t){oB.focus(t)}))}};return{uid:t.uid,dom:t.dom,components:n,apis:o,behaviours:t.behaviours}},configFields:[Un("dom"),Un("behaviours")],partFields:[SB,yB,wB,xB,kB,CB,OB],apis:{getSocket:function(t,n){return t.getSocket(n)},setSidebar:function(t,n,e){t.setSidebar(n,e)},toggleSidebar:function(t,n,e){t.toggleSidebar(n,e)},whichSidebar:function(t,n){return t.whichSidebar(n)},getHeader:function(t,n){return t.getHeader(n)},getToolbar:function(t,n){return t.getToolbar(n)},setToolbar:function(t,n,e){var o=W(e,XT);t.setToolbar(n,o)},setToolbars:function(t,n,e){var o=W(e,(function(t){return W(t,XT)}));t.setToolbars(n,o)},refreshToolbar:function(t,n){return t.refreshToolbar(n)},toggleToolbarDrawer:function(t,n){t.toggleToolbarDrawer(n)},isToolbarDrawerToggled:function(t,n){return t.isToolbarDrawerToggled(n)},getThrobber:function(t,n){return t.getThrobber(n)},setMenubar:function(t,n,e){t.setMenubar(n,e)},focusMenubar:function(t,n){t.focusMenubar(n)},focusToolbar:function(t,n){t.focusToolbar(n)}}}),TB={file:{title:"File",items:"newdocument restoredraft | preview | export print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align lineheight | forecolor backcolor | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},EB=function(t){return"string"==typeof t?t.split(" "):t},DB=function(t,n){var e=d(d({},TB),n.menus),o=0<_t(n.menus).length,r=void 0===n.menubar||!0===n.menubar?EB("file edit view insert format tools table help"):EB(!1===n.menubar?"":n.menubar),i=Y(r,(function(t){return o&&n.menus.hasOwnProperty(t)&&n.menus[t].hasOwnProperty("items")||TB.hasOwnProperty(t)})),u=W(i,(function(o){var r,i,u,a=e[o];return r={title:a.title,items:EB(a.items)},i=n,u=t.getParam("removed_menuitems","").split(/[ ,]/),{text:r.title,getItems:function(){return Z(r.items,(function(t){var n=t.toLowerCase();return 0===n.trim().length||N(u,(function(t){return t===n}))?[]:"separator"===n||"|"===n?[{type:"separator"}]:i.menuItems[n]?[i.menuItems[n]]:[]}))}}}));return Y(u,(function(t){return 0<t.getItems().length&&N(t.getItems(),(function(t){return"separator"!==t.type}))}))},BB=function(t){var n=function(){t._skinLoaded=!0,t.fire("SkinLoaded")};return function(){t.initialized?n():t.on("init",n)}},AB=function(t,n){return function(){return e={message:n},t.fire("SkinLoadError",e);var e}},MB=function(t,n,e){return new Ip((function(o,r){e.load(n,o,r),t.on("remove",(function(){return e.unload(n)}))}))},FB=function(t,n){var e;return e=pe.fromDom(t.getElement()),Rr(e).isSome()?MB(t,n+"/skin.shadowdom.min.css",tv.DOM.styleSheetLoader):Ip.resolve()},IB=function(t,n){var e,o,r,i,u,a=(r=(e=n).getParam("skin"),i=e.getParam("skin_url"),!1!==r&&(o=r||"oxide",i=i?e.documentBaseURI.toAbsolute(i):hv.baseURL+"/skins/ui/"+o),i);a&&n.contentCSS.push(a+(t?"/content.inline":"/content")+".min.css"),0==(!1===n.getParam("skin"))&&T(a)?Ip.all([MB(u=n,a+"/skin.min.css",u.ui.styleSheetLoader),FB(n,a)]).then(BB(n),AB(n,"Skin could not be loaded")):BB(n)()},RB=u(IB,!1),PB=u(IB,!0),VB=function(t,n,e,o){var r,i=n.outerContainer,u=e.toolbar,a=e.buttons;R(u,T)?(r=u.map((function(n){var r={toolbar:n,buttons:a,allowToolbarGroups:e.allowToolbarGroups};return pD(t,r,{backstage:o},C.none())})),_B.setToolbars(i,r)):_B.setToolbar(i,pD(t,e,{backstage:o},C.none()))},HB=We(),LB=HB.os.isiOS()&&HB.os.version.major<=12,zB=function(t,n){var e=t.dom,o=t.getWin(),r=t.getDoc().documentElement,i=me(Su(o.innerWidth,o.innerHeight)),u=me(Su(r.offsetWidth,r.offsetHeight)),a=function(){var n=i.get();n.left===o.innerWidth&&n.top===o.innerHeight||(i.set(Su(o.innerWidth,o.innerHeight)),Pb(t))},c=function(){var n=t.getDoc().documentElement,e=u.get();e.left===n.offsetWidth&&e.top===n.offsetHeight||(u.set(Su(n.offsetWidth,n.offsetHeight)),Pb(t))},s=function(n){return e=n,t.fire("ScrollContent",e);var e};e.bind(o,"resize",a),e.bind(o,"scroll",s);var l=Oy(pe.fromDom(t.getBody()),"load",c),f=n.uiMothership.element;t.on("hide",(function(){Ki(f,"display","none")})),t.on("show",(function(){eu(f,"display")})),t.on("NodeChange",c),t.on("remove",(function(){l.unbind(),e.unbind(o,"resize",a),e.unbind(o,"scroll",s),o=null}))},NB=Object.freeze({__proto__:null,render:function(t,n,e,o,r){var i=me(0),u=n.outerContainer;RB(t);var a,c,s=pe.fromDom(r.targetNode),l=Ir(Fr(s));a=s,c=n.mothership,dl(a,c,Lr),fl(l,n.uiMothership),t.on("PostRender",(function(){VB(t,n,e,o),i.set(t.getWin().innerWidth),_B.setMenubar(u,DB(t,e)),_B.setSidebar(u,e.sidebar),zB(t,n)}));var f,d,m,g,p,h=_B.getSocket(u).getOrDie("Could not find expected socket element");LB&&(Ji(h.element,{overflow:"scroll","-webkit-overflow-scrolling":"touch"}),m=function(){t.fire("ScrollContent")},g=20,p=null,f={cancel:function(){null!==p&&(clearTimeout(p),p=null)},throttle:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];null===p&&(p=setTimeout((function(){m.apply(null,t),p=null}),g))}},d=Cy(h.element,"scroll",f.throttle),t.on("remove",d.unbind)),Uv(t,n),t.addCommand("ToggleSidebar",(function(n,e){_B.toggleSidebar(u,e),t.fire("ToggleSidebar")})),t.addQueryValueHandler("ToggleSidebar",(function(){return _B.whichSidebar(u)}));var v=Dv(t);v!==ih.sliding&&v!==ih.floating||t.on("ResizeWindow ResizeEditor ResizeContent",(function(){var e=t.getWin().innerWidth;e!==i.get()&&(_B.refreshToolbar(n.outerContainer),i.set(e))}));var b={enable:function(){jv(n,!1)},disable:function(){jv(n,!0)},isDisabled:function(){return pv.isDisabled(u)}};return{iframeContainer:h.element.dom,editorContainer:u.element.dom,api:b}}}),jB=function(t){return/^[0-9\.]+(|px)$/i.test(""+t)?C.some(parseInt(""+t,10)):C.none()},UB=function(t){return I(t)?t+"px":t},WB=function(t,n,e){var o=n.filter((function(n){return t<n})),r=e.filter((function(n){return n<t}));return o.or(r).getOr(t)},GB=function(t){var n,e,o,r;return(e=vv(n=t),o=xv(n),r=Sv(n),jB(e).map((function(t){return WB(t,o,r)}))).getOr(vv(t))},XB=function(t){var n=bv(t),e=yv(t),o=wv(t);return jB(n).map((function(t){return WB(t,e,o)}))},YB=function(t,n,e,o,r){var i=e.uiMothership,u=e.outerContainer,a=tv.DOM,c=Pv(t),s=Lv(t),l=wv(t).or(XB(t)),f=o.shared.header,d=f.isPositionedAtTop,m=Dv(t),g=m===ih.sliding||m===ih.floating,p=me(!1),h=function(){return p.get()&&!t.removed},v=function(t){return g?t.fold((function(){return 0}),(function(t){return 1<t.components().length?yu(t.components()[1].element):0})):0},b=function(){i.broadcastOn([Ol()],{})},y=function(t){var e,o,i,a,f,m;void 0===t&&(t=!1),h()&&(c||(e=l.getOrThunk((function(){var t=jB(Qi(Gi(),"margin-left")).getOr(0);return Tu(Gi())-Cu(n).left+t})),Ki(r.get().element,"max-width",e+"px")),g&&_B.refreshToolbar(u),c||(o=_B.getToolbar(u),i=v(o),a=zu(n),f=d()?Math.max(a.y-yu(r.get().element)+i,0):a.bottom,Ji(u.element,{position:"absolute",top:Math.round(f)+"px",left:Math.round(a.x)+"px"})),s&&(m=r.get(),t?qD.reset(m):qD.refresh(m)),b())},x=function(e){var o,i;void 0===e&&(e=!0),!c&&s&&h()&&(o=f.getDockingMode(),(i=function(e){switch(Fv(t)){case Tv.auto:var o=_B.getToolbar(u),r=v(o),i=yu(e.element)-r,a=zu(n);if(a.y>i)return"top";var c=kr(n),s=Math.max(c.dom.scrollHeight,yu(c));return a.bottom<s-i||ju().bottom<a.bottom-i?"bottom":"top";case Tv.bottom:return"bottom";case Tv.top:default:return"top"}}(r.get()))!==o&&(function(t){var n=r.get();qD.setModes(n,[t]),f.setDockingMode(t);var e=d()?ea.TopToBottom:ea.BottomToTop;Kr(n.element,qc,e)}(i),e&&y(!0)))};return{isVisible:h,isPositionedAtTop:d,show:function(){p.set(!0),Ki(u.element,"display","flex"),a.addClass(t.getBody(),"mce-edit-focus"),eu(i.element,"display"),x(!1),y()},hide:function(){p.set(!1),e.outerContainer&&(Ki(u.element,"display","none"),a.removeClass(t.getBody(),"mce-edit-focus")),Ki(i.element,"display","none")},update:y,updateMode:x,repositionPopups:b}},qB=function(t,n){var e=zu(t);return{pos:n?e.y:e.bottom,bounds:e}},KB=Object.freeze({__proto__:null,render:function(t,n,e,o,r){var i=n.mothership,u=n.uiMothership,a=n.outerContainer,c=me(null),s=pe.fromDom(r.targetNode),l=YB(t,s,n,o,c),f=t.getParam("toolbar_persist",!1,"boolean");PB(t);var d=function(){var r;c.get()?l.show():(c.set(_B.getHeader(a).getOrDie()),r=Vv(t),fl(r,i),fl(r,u),VB(t,n,e,o),_B.setMenubar(a,DB(t,e)),l.show(),function(t,n,e,o){var r=me(qB(n,e.isPositionedAtTop())),i=function(o){var i=qB(n,e.isPositionedAtTop()),u=i.pos,a=i.bounds,c=r.get(),s=c.pos,l=c.bounds,f=a.height!==l.height||a.width!==l.width;r.set({pos:u,bounds:a}),f&&Pb(t,o),e.isVisible()&&(s!==u?e.update(!0):f&&(e.updateMode(),e.repositionPopups()))};o||(t.on("activate",e.show),t.on("deactivate",e.hide)),t.on("SkinLoaded ResizeWindow",(function(){return e.update(!0)})),t.on("NodeChange keydown",(function(t){mp.requestAnimationFrame((function(){return i(t)}))})),t.on("ScrollWindow",(function(){return e.updateMode()}));var u=rD();u.set(Oy(pe.fromDom(t.getBody()),"load",i)),t.on("remove",(function(){u.clear()}))}(t,s,l,f),t.nodeChanged())};t.on("show",d),t.on("hide",l.hide),f||(t.on("focus",d),t.on("blur",l.hide)),t.on("init",(function(){(t.hasFocus()||f)&&d()})),Uv(t,n);var m={show:function(){l.show()},hide:function(){l.hide()},enable:function(){jv(n,!1)},disable:function(){jv(n,!0)},isDisabled:function(){return pv.isDisabled(a)}};return{editorContainer:a.element.dom,api:m}}}),JB=function(t,n){var e,o,r,i,u,a,c,s,l,f,m,g,p,h;r=PE(0,o=n,XE(e=t)),e.ui.registry.addNestedMenuItem("align",{text:o.shared.providers.translate("Align"),getSubmenuItems:function(){return r.items.validateItems(r.getStyleItems())}}),a=PE(0,u=n,JE(i=t)),i.ui.registry.addNestedMenuItem("fontformats",{text:u.shared.providers.translate("Fonts"),getSubmenuItems:function(){return a.items.validateItems(a.getStyleItems())}}),c=t,l=d({type:"advanced"},(s=n).styleselect),f=PE(0,s,cD(c,l)),c.ui.registry.addNestedMenuItem("formats",{text:"Formats",getSubmenuItems:function(){return f.items.validateItems(f.getStyleItems())}}),g=PE(0,n,aD(m=t)),m.ui.registry.addNestedMenuItem("blockformats",{text:"Blocks",getSubmenuItems:function(){return g.items.validateItems(g.getStyleItems())}}),h=PE(0,n,tD(p=t)),p.ui.registry.addNestedMenuItem("fontsizes",{text:"Font sizes",getSubmenuItems:function(){return h.items.validateItems(h.getStyleItems())}})},$B={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},QB=(LE="[eE][+-]?[0-9]+",NE=["Infinity",(HE="[0-9]+")+"\\."+(zE=function(t){return"(?:"+t+")?"})(HE)+zE(LE),"\\."+HE+zE(LE),HE+zE(LE)].join("|"),new RegExp("^([+-]?(?:"+NE+"))(.*)$")),ZB=function(t,n){return C.from(QB.exec(t)).bind((function(t){var e,o=Number(t[1]),r=t[2];return e=r,N(n,(function(t){return N($B[t],(function(t){return e===t}))}))?C.some({value:o,unit:r}):C.none()}))},tA=function(t){return ZB(t,["fixed","relative","empty"]).map((function(t){return t.value+t.unit})).getOr(t)},nA=function(t){var n=t.getParam("lineheight_formats","1 1.1 1.2 1.3 1.4 1.5 2","string").split(" "),e=new Map,o=oD(),r=function(){var n=tA(t.queryCommandValue("LineHeight"));C.from(e.get(n)).fold((function(){return o.clear()}),(function(t){o.set({destroy:function(){t.setActive(!1)}}),t.setActive(!0)}))};return t.on("nodeChange",r),W(n,(function(i,u){return{type:"togglemenuitem",text:i,onSetup:function(a){return e.set(tA(i),a),u+1===n.length&&r(),function(){0===u&&(t.off("nodeChange",r),o.clear())}},onAction:function(){return t.execCommand("LineHeight",!1,i)}}}))},eA=function(t){var n,e;(n=t).ui.registry.addNestedMenuItem("lineheight",{type:"nestedmenuitem",text:"Line height",getSubmenuItems:function(){return nA(n)}}),(e=t).ui.registry.addMenuButton("lineheight",{tooltip:"Line height",icon:"line-height",fetch:function(t){return t(nA(e))}})},oA=function(t,n){return function(){t.execCommand("mceToggleFormat",!1,n)}},rA=function(t){var n,e;!function(t){mk.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],(function(n,e){t.ui.registry.addToggleButton(n.name,{tooltip:n.text,icon:n.icon,onSetup:iD(t,n.name),onAction:oA(t,n.name)})}));for(var n=1;n<=6;n++){var e="h"+n;t.ui.registry.addToggleButton(e,{text:e.toUpperCase(),tooltip:"Heading "+n,onSetup:iD(t,e),onAction:oA(t,e)})}}(t),n=t,mk.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"}],(function(t){n.ui.registry.addButton(t.name,{tooltip:t.text,icon:t.icon,onAction:function(){return n.execCommand(t.action)}})})),e=t,mk.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],(function(t){e.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onAction:function(){return e.execCommand(t.action)},onSetup:iD(e,t.name)})}))},iA=function(t){var n;rA(t),n=t,mk.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through",shortcut:""},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript",shortcut:""},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript",shortcut:""},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting",shortcut:""},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document",shortcut:""},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"}],(function(t){n.ui.registry.addMenuItem(t.name,{text:t.text,icon:t.icon,shortcut:t.shortcut,onAction:function(){return n.execCommand(t.action)}})})),n.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:oA(n,"code")})},uA=function(t,n,e){var o=function(){return!!n.undoManager&&n.undoManager[e]()},r=function(){t.setDisabled(n.mode.isReadOnly()||!o())};return t.setDisabled(!o()),n.on("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",r),function(){return n.off("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",r)}},aA=function(t){var n,e;(n=t).ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:function(t){return uA(t,n,"hasUndo")},onAction:function(){return n.execCommand("undo")}}),n.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:function(t){return uA(t,n,"hasRedo")},onAction:function(){return n.execCommand("redo")}}),(e=t).ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",onSetup:function(t){return uA(t,e,"hasUndo")},onAction:function(){return e.execCommand("undo")}}),e.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",onSetup:function(t){return uA(t,e,"hasRedo")},onAction:function(){return e.execCommand("redo")}})},cA=function(t,n){var e,o,r,i;!function(t){mk.each([{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}],(function(n){t.ui.registry.addToggleButton(n.name,{tooltip:n.text,onAction:function(){return t.execCommand(n.cmd)},icon:n.icon,onSetup:iD(t,n.name)})}));var n="alignnone",e="No alignment",o="JustifyNone",r="align-none";t.ui.registry.addButton(n,{tooltip:e,onAction:function(){return t.execCommand(o)},icon:r})}(t),iA(t),JB(t,n),aA(t),function(t){Gb(t);var n=me(null),e=me(null);$b(t,"forecolor","forecolor","Text color",n),$b(t,"backcolor","hilitecolor","Background color",e),Qb(t,"forecolor","forecolor","Text color"),Qb(t,"backcolor","hilitecolor","Background color")}(t),(o=e=t).ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:function(){return o.execCommand("mceToggleVisualAid")}}),(r=e).ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:function(t){return function(t,n){t.setActive(n.hasVisual);var e=function(n){t.setActive(n.hasVisual)};return n.on("VisualAid",e),function(){return n.off("VisualAid",e)}}(t,r)},onAction:function(){r.execCommand("mceToggleVisualAid")}}),(i=t).ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:function(t){return function(t,n){t.setDisabled(!n.queryCommandState("outdent"));var e=function(){t.setDisabled(!n.queryCommandState("outdent"))};return n.on("NodeChange",e),function(){return n.off("NodeChange",e)}}(t,i)},onAction:function(){return i.execCommand("outdent")}}),i.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:function(){return i.execCommand("indent")}}),eA(t)},sA=function(t,n){return{anchor:"makeshift",x:t,y:n}},lA=function(t){return"longpress"===t.type||0===t.type.indexOf("touch")},fA=function(t,n){var e,o,r,i=tv.DOM.getPos(t);return e=n,o=i.x,r=i.y,sA(e.x+o,e.y+r)},dA=function(t,n){return"contextmenu"===n.type||"longpress"===n.type?t.inline?function(t){if(lA(t)){var n=t.touches[0];return sA(n.pageX,n.pageY)}return sA(t.pageX,t.pageY)}(n):fA(t.getContentAreaContainer(),function(t){if(lA(t)){var n=t.touches[0];return sA(n.clientX,n.clientY)}return sA(t.clientX,t.clientY)}(n)):mA(t)},mA=function(t){return{anchor:"selection",root:pe.fromDom(t.selection.getNode())}},gA=function(t){return{anchor:"node",node:C.some(pe.fromDom(t.selection.getNode())),root:pe.fromDom(t.getBody())}},pA=function(t,n,e,o,r,i){var u=e(),a=i?gA(t):dA(t,n);jC(u,ah.CLOSE_ON_EXECUTE,o,!1).map((function(t){n.preventDefault(),np.showMenuAt(r,a,{menu:{markers:xh("normal")},data:t})}))},hA={onLtr:function(){return[Wa,La,za,Na,ja,Ua,fp,dp,sp,ap,lp,cp]},onRtl:function(){return[Wa,za,La,ja,Na,Ua,fp,dp,lp,cp,sp,ap]}},vA={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},bA=function(t,n,e,o,r,i,u){var a,c,s=i?gA(t):(a=t,c=n,d({bubble:Lc(0,12,vA),layouts:hA,overrides:{maxWidthFunction:$_(),maxHeightFunction:Ic()}},dA(a,c)));jC(e,ah.CLOSE_ON_EXECUTE,o,!0).map((function(e){n.preventDefault(),np.showMenuWithinBounds(r,s,{menu:{markers:xh("normal"),highlightImmediately:u},data:e,type:"horizontal"},(function(){return C.some(TE(t,o.shared))})),t.fire(Q_)}))},yA=function(t,n,e,o,r,i){var u,a=We(),c=a.os.isiOS(),s=a.os.isOSX(),l=a.os.isAndroid(),f=a.deviceType.isTouch(),d=function(){var u=e();bA(t,n,u,o,r,i,!(l||c||s&&f))};!s&&!c||i?(l&&!i&&t.selection.setCursorLocation(n.target,0),d()):(u=function(){!function(t){var n=t.selection.getRng(),e=function(){mp.setEditorTimeout(t,(function(){t.selection.setRng(n)}),10),i()};t.once("touchend",e);var o=function(t){t.preventDefault(),t.stopImmediatePropagation()};t.on("mousedown",o,!0);var r=function(){return i()};t.once("longpresscancel",r);var i=function(){t.off("touchend",e),t.off("longpresscancel",r),t.off("mousedown",o)}}(t),d()},function(t,n){var e=t.selection;if(e.isCollapsed()||n.touches.length<1)return!1;var o=n.touches[0],r=e.getRng();return Ms(t.getWin(),ps.domRange(r)).exists((function(t){return t.left<=o.clientX&&t.right>=o.clientX&&t.top<=o.clientY&&t.bottom>=o.clientY}))}(t,n)?u():(t.once("selectionchange",u),t.once("touchend",(function(){return t.off("selectionchange",u)}))))},xA=function(t){return"string"==typeof t?t.split(/[ ,]/):t},wA=function(t){return t.getParam("contextmenu_never_use_native",!1,"boolean")},SA=function(t){return e="contextmenu",o="link linkchecker image imagetools table spellchecker configurepermanentpen",r=(n=t).ui.registry.getAll().contextMenus,C.from(n.getParam(e)).map(xA).getOrThunk((function(){return Y(xA(o),(function(t){return Pt(r,t)}))}));var n,e,o,r},kA=function(t){return T(t)?"|"===t:"separator"===t.type},CA={type:"separator"},OA=function t(n){if(T(n))return n;switch(n.type){case"separator":return CA;case"submenu":return{type:"nestedmenuitem",text:n.text,icon:n.icon,getSubmenuItems:function(){var e=n.getSubmenuItems();return T(e)?e:W(e,t)}};default:return{type:"menuitem",text:n.text,icon:n.icon,onAction:(e=n.onAction,function(){return e()})}}var e},_A=function(t,n){if(0===n.length)return t;var e=ut(t).filter((function(t){return!kA(t)})).fold((function(){return[]}),(function(t){return[CA]}));return t.concat(e).concat(n).concat([CA])},TA=function(t,n){return"longpress"!==n.type&&(2!==n.button||n.target===t.getBody()&&""===n.pointerType)},EA=function(t,n){return TA(t,n)?t.selection.getStart(!0):n.target},DA=function(t,n,e){var o=We().deviceType.isTouch,r=pu(np.sketch({dom:{tag:"div"},lazySink:n,onEscape:function(){return t.focus()},onShow:function(){return e.setContextMenuState(!0)},onHide:function(){return e.setContextMenuState(!1)},fireDismissalEventInstead:{},inlineBehaviours:uc([mg("dismissContextMenu",[rr(No(),(function(n,e){kl.close(n),t.focus()}))])])})),i=function(t){return np.hide(r)},u=function(n){var i,u;wA(t)&&n.preventDefault(),i=t,n.ctrlKey&&!wA(i)||!1===t.getParam("contextmenu")||(u=function(t,n){var e=t.getParam("contextmenu_avoid_overlap","","string");if(TA(t,n))return!0;if(e){var o=EA(t,n);return Ty(pe.fromDom(o),e)}return!1}(t,n),(o()?yA:pA)(t,n,(function(){var e,o,r,i=EA(t,n),u=t.ui.registry.getAll(),a=SA(t);return e=u.contextMenus,o=i,0<(r=K(a,(function(t,n){if(Pt(e,n)){var r=e[n].update(o);if(T(r))return _A(t,r.split(" "));if(0<r.length){var i=W(r,OA);return _A(t,i)}return t}return t.concat([n])}),[])).length&&kA(r[r.length-1])&&r.pop(),r}),e,r,u))};t.on("init",(function(){var n="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(o()?"":" ResizeWindow");t.on(n,i),t.on("longpress contextmenu",u)}))},BA=Ht([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),AA=function(t){return function(n){return n.translate(-t.left,-t.top)}},MA=function(t){return function(n){return n.translate(t.left,t.top)}},FA=function(t){return function(n,e){return K(t,(function(t,n){return n(t)}),Su(n,e))}},IA=function(t,n,e){return t.fold(FA([MA(e),AA(n)]),FA([AA(n)]),FA([]))},RA=function(t,n,e){return t.fold(FA([MA(e)]),FA([]),FA([MA(n)]))},PA=function(t,n,e){return t.fold(FA([]),FA([AA(e)]),FA([MA(n),AA(e)]))},VA=function(t,n,e){var o=t.fold((function(t,n){return{position:C.some("absolute"),left:C.some(t+"px"),top:C.some(n+"px")}}),(function(t,n){return{position:C.some("absolute"),left:C.some(t-e.left+"px"),top:C.some(n-e.top+"px")}}),(function(t,n){return{position:C.some("fixed"),left:C.some(t+"px"),top:C.some(n+"px")}}));return d({right:C.none(),bottom:C.none()},o)},HA=function(t,n,e,o){var r=function(t,r){return function(i,u){var a=t(n,e,o);return r(i.getOr(a.left),u.getOr(a.top))}};return t.fold(r(PA,LA),r(RA,zA),r(IA,NA))},LA=BA.offset,zA=BA.absolute,NA=BA.fixed,jA=function(t,n){var e=Jr(t,n);return A(e)?NaN:parseInt(e,10)},UA=function(t,n,e,o){return r=n,i=t.element,u=jA(i,r.leftAttr),a=jA(i,r.topAttr),(isNaN(u)||isNaN(a)?C.none():C.some(Su(u,a))).fold((function(){return e}),(function(t){return NA(t.left+o.left,t.top+o.top)}));var r,i,u,a},WA=function(t,n,e,o,r,i){var u,a,c,s=UA(t,n,e,o),l=(n.mustSnap?YA:qA)(t,n,s,r,i),f=IA(s,r,i);return u=n,a=f,c=t.element,Kr(c,u.leftAttr,a.left+"px"),Kr(c,u.topAttr,a.top+"px"),l.fold((function(){return{coord:NA(f.left,f.top),extra:C.none()}}),(function(t){return{coord:t.output,extra:t.extra}}))},GA=function(t,n){var e,o;e=n,o=t.element,Zr(o,e.leftAttr),Zr(o,e.topAttr)},XA=function(t,n,e,o){return ct(t,(function(t){var r,i,u,a,c,s,l,f,d=t.sensor;return r=n,i=d,u=t.range.left,a=t.range.top,l=RA(r,c=e,s=o),f=RA(i,c,s),Math.abs(l.left-f.left)<=u&&Math.abs(l.top-f.top)<=a?C.some({output:HA(t.output,n,e,o),extra:t.extra}):C.none()}))},YA=function(t,n,e,o,r){var i=n.getSnapPoints(t);return XA(i,e,o,r).orThunk((function(){return K(i,(function(t,n){var i,u,a,c,s,l,f,d,m=n.sensor,g=(i=e,u=m,n.range.left,n.range.top,s=RA(i,a=o,c=r),l=RA(u,a,c),f=Math.abs(s.left-l.left),d=Math.abs(s.top-l.top),Su(f,d));return t.deltas.fold((function(){return{deltas:C.some(g),snap:C.some(n)}}),(function(e){return(g.left+g.top)/2<=(e.left+e.top)/2?{deltas:C.some(g),snap:C.some(n)}:t}))}),{deltas:C.none(),snap:C.none()}).snap.map((function(t){return{output:HA(t.output,e,o,r),extra:t.extra}}))}))},qA=function(t,n,e,o,r){var i=n.getSnapPoints(t);return XA(i,e,o,r)},KA=Object.freeze({__proto__:null,snapTo:function(t,n,e,o){var r,i,u,a,c,s,l,f,d=n.getTarget(t.element);n.repositionTarget&&(r=wr(t.element),i=Mu(r),u=BD(d),l=i,f=u,a={coord:HA((s=o).output,s.output,l,f),extra:s.extra},c=VA(a.coord,0,u),$i(d,c))}}),JA="data-initial-z-index",$A=function(t,n){var e;t.getSystem().addToGui(n),Or((e=n).element).filter(vr).each((function(t){tu(t,"z-index").each((function(n){Kr(t,JA,n)})),Ki(t,"z-index",Qi(e.element,"z-index"))}))},QA=function(t){Or(t.element).filter(vr).each((function(t){$r(t,JA).fold((function(){return eu(t,"z-index")}),(function(n){return Ki(t,"z-index",n)})),Zr(t,JA)})),t.getSystem().removeFromGui(t)},ZA=function(t,n,e){return t.getSystem().build(jy.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[n]},events:e}))},tM=ee("snaps",[Un("getSnapPoints"),pa("onSensor"),Un("leftAttr"),Un("topAttr"),oe("lazyViewport",ju),oe("mustSnap",!1)]),nM=[oe("useFixed",s),Un("blockerClass"),oe("getTarget",i),oe("onDrag",e),oe("repositionTarget",!0),oe("onDrop",e),se("getBounds",ju),tM],eM=function(t){return n=tu(t,"left"),e=tu(t,"top"),o=tu(t,"position"),r=function(t,n,e){return("fixed"===e?NA:LA)(parseInt(t,10),parseInt(n,10))},(n.isSome()&&e.isSome()&&o.isSome()?C.some(r(n.getOrDie(),e.getOrDie(),o.getOrDie())):C.none()).getOrThunk((function(){var n=Cu(t);return zA(n.left,n.top)}));var n,e,o,r},oM=function(t,n,e,o,r,i,u){var a,c,s,l,f,d,m,g,p,h=n.fold((function(){var t,n,u,a=(t=e,n=i.left,u=i.top,t.fold((function(t,e){return LA(t+n,e+u)}),(function(t,e){return zA(t+n,e+u)}),(function(t,e){return NA(t+n,e+u)}))),c=IA(a,o,r);return NA(c.left,c.top)}),(function(n){var u=WA(t,n,e,i,o,r);return u.extra.each((function(e){n.onSensor(t,e)})),u.coord}));return a=h,c=o,s=r,f=(l=u).bounds,d=RA(a,c,s),m=Tc(d.left,f.x,f.x+f.width-l.width),g=Tc(d.top,f.y,f.y+f.height-l.height),p=zA(m,g),a.fold((function(){var t=PA(p,c,s);return LA(t.left,t.top)}),(function(){return p}),(function(){var t=IA(p,c,s);return NA(t.left,t.top)}))},rM=function(t,n){return{bounds:t.getBounds(),height:xu(n.element),width:Eu(n.element)}},iM=function(t,n,e,o,r){var i=e.update(o,r),u=e.getStartData().getOrThunk((function(){return rM(n,t)}));i.each((function(e){var o,r,i,a,c,s,l,f,d,m,g;o=t,i=u,a=e,g=(r=n).getTarget(o.element),r.repositionTarget&&(c=wr(o.element),s=Mu(c),l=BD(g),f=eM(g),d=oM(o,r.snaps,f,s,l,a,i),m=VA(d,0,l),$i(g,m)),r.onDrag(o,g,a)}))},uM=function(t,n,e,o){n.each(QA),e.snaps.each((function(n){GA(t,n)}));var r=e.getTarget(t.element);o.reset(),e.onDrop(t,r)},aM=function(t){return function(n,e){var o=function(t){e.setStartData(rM(n,t))};return nr(g([rr(Vo(),(function(t){e.getStartData().each((function(){return o(t)}))}))],t(n,e,o)))}},cM=Object.freeze({__proto__:null,getData:function(t){return C.from(Su(t.x,t.y))},getDelta:function(t,n){return Su(n.left-t.left,n.top-t.top)}}),sM=function(t,n,e){return[rr(ao(),(function(o,r){var i,u,a,c,s;0===r.event.raw.button&&(r.stop(),a={drop:i=function(){return uM(o,C.some(c),t,n)},delayDrop:(u=Ey(i,200)).schedule,forceDrop:i,move:function(e){u.cancel(),iM(o,t,n,cM,e)}},c=ZA(o,t.blockerClass,(s=a,nr([rr(ao(),s.forceDrop),rr(lo(),s.drop),rr(co(),(function(t,n){s.move(n.event)})),rr(so(),s.delayDrop)]))),e(o),$A(o,c))}))]},lM=g(nM,[ya("dragger",{handlers:aM(sM)})]),fM=Object.freeze({__proto__:null,getData:function(t){var n,e=t.raw.touches;return 1===e.length?(n=e[0],C.some(Su(n.clientX,n.clientY))):C.none()},getDelta:function(t,n){return Su(n.left-t.left,n.top-t.top)}}),dM=function(t,n,o){var r=me(C.none());return[rr(oo(),(function(i,u){u.stop();var a,c=function(){uM(i,r.get(),t,n),r.set(C.none())},s={drop:c,delayDrop:e,forceDrop:c,move:function(e){iM(i,t,n,fM,e)}},l=ZA(i,t.blockerClass,(a=s,nr([rr(oo(),a.forceDrop),rr(io(),a.drop),rr(uo(),a.drop),rr(ro(),(function(t,n){a.move(n.event)}))])));r.set(C.some(l)),o(i),$A(i,l)})),rr(ro(),(function(e,o){o.stop(),iM(e,t,n,fM,o.event)})),rr(io(),(function(e,o){o.stop(),uM(e,r.get(),t,n),r.set(C.none())})),rr(uo(),(function(e){uM(e,r.get(),t,n),r.set(C.none())}))]},mM=g(nM,[ya("dragger",{handlers:aM(dM)})]),gM=g(nM,[ya("dragger",{handlers:aM((function(t,n,e){return g(sM(t,n,e),dM(t,n,e))}))})]),pM=lc({branchKey:"mode",branches:Object.freeze({__proto__:null,mouse:lM,touch:mM,mouseOrTouch:gM}),name:"dragging",active:{events:function(t,n){return t.dragger.handlers(t,n)}},extra:{snap:function(t){return{sensor:t.sensor,range:t.range,output:t.output,extra:C.from(t.extra)}}},state:Object.freeze({__proto__:null,init:function(){var t=C.none(),n=C.none(),e=r({});return Si({readState:e,reset:function(){t=C.none(),n=C.none()},update:function(n,e){return n.getData(e).bind((function(e){return o=n,r=e,i=t.map((function(t){return o.getDelta(t,r)})),t=C.some(r),i;var o,r,i}))},getStartData:function(){return n},setStartData:function(t){n=C.some(t)}})}}),apis:KA}),hM=function(t,n,e,o,r,i){return t.fold((function(){return pM.snap({sensor:zA(e-20,o-20),range:Su(r,i),output:zA(C.some(e),C.some(o)),extra:{td:n}})}),(function(t){var r=e-20,i=o-20,u=t.element.dom.getBoundingClientRect();return pM.snap({sensor:zA(r,i),range:Su(40,40),output:zA(C.some(e-u.width/2),C.some(o-u.height/2)),extra:{td:n}})}))},vM=function(t,n,e){return{getSnapPoints:t,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:function(t,o){var r,i,u=o.td;r=n.get(),i=u,r.exists((function(t){return Ye(t,i)}))||(n.set(C.some(u)),e(u))},mustSnap:!0}},bM=function(t){return pp(gp.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:uc([pM.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:t}),uw.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}}))},yM=function(t,n){var e=me([]),o=me([]),r=me(!1),i=me(C.none()),u=me(C.none()),a=function(t){var e=Nu(t);return hM(f.getOpt(n),t,e.x,e.y,e.width,e.height)},c=function(t){var e=Nu(t);return hM(d.getOpt(n),t,e.right,e.bottom,e.width,e.height)},s=vM((function(){return W(e.get(),a)}),i,(function(n){u.get().each((function(e){t.fire("TableSelectorChange",{start:n,finish:e})}))})),l=vM((function(){return W(o.get(),c)}),u,(function(n){i.get().each((function(e){t.fire("TableSelectorChange",{start:e,finish:n})}))})),f=bM(s),d=bM(l),m=pu(f.asSpec()),g=pu(d.asSpec()),p=function(n,e,o,r){var i=o(e);pM.snapTo(n,i),function(n,e,o,r){var i=e.dom.getBoundingClientRect();eu(n.element,"display");var u=Cr(pe.fromDom(t.getBody())).dom.innerHeight,a=o(i),c=r(i,u);(a||c)&&Ki(n.element,"display","none")}(n,e,(function(t){return t[r]<0}),(function(t,n){return t[r]>n}))},h=function(t){return p(m,t,a,"top")},v=function(t){return p(g,t,c,"bottom")};We().deviceType.isTouch()&&(t.on("TableSelectionChange",(function(t){r.get()||(ul(n,m),ul(n,g),r.set(!0)),i.set(C.some(t.start)),u.set(C.some(t.finish)),t.otherCells.each((function(n){e.set(n.upOrLeftCells),o.set(n.downOrRightCells),h(t.start),v(t.finish)}))})),t.on("ResizeEditor ResizeWindow ScrollContent",(function(){i.get().each(h),u.get().each(v)})),t.on("TableSelectionClear",(function(){r.get()&&(sl(m),sl(g),r.set(!1)),i.set(C.none()),u.set(C.none())})))};(UE=jE=jE||{})[UE.None=0]="None",UE[UE.Both=1]="Both",UE[UE.Vertical=2]="Vertical";var xM,wM,SM,kM=function(t,n,e){var o,r,i,u,a,c,s=pe.fromDom(t.getContainer()),l=(o=t,r=n,i=e,u=yu(s),a=Tu(s),(c={}).height=WB(u+r.top,xv(o),Sv(o)),i===jE.Both&&(c.width=WB(a+r.left,yv(o),wv(o))),c);Et(l,(function(t,n){return Ki(s,n,UB(t)),0})),t.fire("ResizeEditor")},CM=function(t,n,e){return n.delimiter||(n.delimiter="»"),{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:uc([ag.config({mode:"flow",selector:"div[role=button]"}),pv.config({disabled:e.isDisabled}),Wv(),Ky.config({}),dg.config({}),mg("elementPathEvents",[fr((function(o,r){t.shortcuts.add("alt+F11","focus statusbar elementpath",(function(){return ag.focusIn(o)})),t.on("NodeChange",(function(r){var i,u,a=function(n){for(var e=[],o=n.length;0<o--;){var r=n[o];if(1===r.nodeType&&!function(t){if(1===t.nodeType){if("BR"===t.nodeName||t.getAttribute("data-mce-bogus"))return!0;if("bookmark"===t.getAttribute("data-mce-type"))return!0}return!1}(r)){var i=t.fire("ResolveName",{name:r.nodeName.toLowerCase(),target:r});if(i.isDefaultPrevented()||e.push({name:i.name,element:r}),i.isPropagationStopped())break}}return e}(r.parents);0<a.length?dg.set(o,(i=W(a||[],(function(n,o){return gp.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{role:"button","data-index":o,"tab-index":-1,"aria-level":o+1},innerHtml:n.name},action:function(e){t.focus(),t.selection.select(n.element),t.nodeChanged()},buttonBehaviours:uc([Xv(e.isDisabled),Wv()])})})),u={dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0},innerHtml:" "+n.delimiter+" "}},K(i.slice(1),(function(t,n){var e=t;return e.push(u),e.push(n),e}),[i[0]]))):dg.set(o,[])}))}))])]),components:[]}},OM=function(t,n){var e,o,r,i,u,a;return{dom:{tag:"div",classes:["tox-statusbar"]},components:(u=function(){var e,o,r,i,u,a=[];return t.getParam("elementpath",!0,"boolean")&&a.push(CM(t,{},n)),t.hasPlugin("wordcount")&&a.push((e=t,o=n,i=function(t,n,e){return dg.set(t,[du(o.translate(["{0} "+e,n[e]]))])},gp.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:uc([Xv(o.isDisabled),Wv(),Ky.config({}),dg.config({}),Ul.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),mg("wordcount-events",[gr((function(t){var n=Ul.getValue(t),e="words"===n.mode?"characters":"words";Ul.setValue(t,{mode:e,count:n.count}),i(t,n.count,e)})),fr((function(t){e.on("wordCountUpdate",(function(n){var e=Ul.getValue(t).mode;Ul.setValue(t,{mode:e,count:n.wordCount}),i(t,n.wordCount,e)}))}))])]),eventOrder:((r={})[Eo()]=["disabling","alloy.base.behaviour","wordcount-events"],r)}))),t.getParam("branding",!0,"boolean")&&a.push({dom:{tag:"span",classes:["tox-statusbar__branding"],innerHtml:'<a href="https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5" rel="noopener" target="_blank" tabindex="-1" aria-label="'+(u=nv.translate(["Powered by {0}","Tiny"]))+'">'+u+"</a>"}}),0<a.length?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:a}]:[]}(),o=!(e=t).hasPlugin("autoresize"),(a=!1===(r=e.getParam("resize",o))?jE.None:"both"===r?jE.Both:jE.Vertical)!==jE.None&&u.push((i=a,{dom:{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:n.translate("Resize"),"aria-hidden":"true"},innerHtml:vp("resize-handle",n.icons)},behaviours:uc([pM.config({mode:"mouse",repositionTarget:!1,onDrag:function(n,e,o){kM(t,o,i)},blockerClass:"tox-blocker"})])})),u)}},_M=function(t){var n,o,r,i,u=t.inline,a=u?KB:NB,c=Lv(t)?eB:ED,s=C.none(),l=We(),f=l.browser.isIE()?["tox-platform-ie"]:[],m=l.deviceType.isTouch()?["tox-platform-touch"]:[],g=Iv(t),p=Vv(t),h=nv.isRtl()?{attributes:{dir:"rtl"}}:{},v={attributes:((n={})[qc]=g?ea.BottomToTop:ea.TopToBottom,n)},b=function(){return s.bind(_B.getHeader)},y=function(){Ki(dt.element,"width",document.body.clientWidth+"px")},x=pu((o=Ye(Gi(),p)&&"grid"===Qi(p,"display"),r={dom:d({tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(f).concat(m)},h),behaviours:uc([nl.config({useFixed:function(){return c.isDocked(b)}})])},i={dom:{styles:{width:document.body.clientWidth+"px"}},events:nr([rr(Ho(),y)])},Nt(r,o?i:{}))),w=function(){return ft.value(x)},S=pp({dom:{tag:"div",classes:["tox-anchorbar"]}}),k=function(){return s.bind((function(t){return _B.getThrobber(t)})).getOrDie("Could not find throbber element")},O=J_(x,t,(function(){return s.bind((function(t){return S.getOpt(t)})).getOrDie("Could not find a anchor bar element")})),_=_B.parts.menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:O,onEscape:function(){t.focus()}}),T=Dv(t),E=_B.parts.toolbar(d({dom:{tag:"div",classes:["tox-toolbar"]},getSink:w,providers:O.shared.providers,onEscape:function(){t.focus()},type:T,lazyToolbar:function(){return s.bind((function(t){return _B.getToolbar(t)})).getOrDie("Could not find more toolbar element")},lazyHeader:function(){return b().getOrDie("Could not find header element")}},v)),D=_B.parts["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},providers:O.shared.providers,onEscape:function(){t.focus()},type:T}),B=_B.parts.socket({dom:{tag:"div",classes:["tox-edit-area"]}}),A=_B.parts.sidebar({dom:{tag:"div",classes:["tox-sidebar"]}}),M=_B.parts.throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:O}),F=t.getParam("statusbar",!0,"boolean")&&!u?C.some(OM(t,O.shared.providers)):C.none(),R={dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[B,A]},P=_v(t),V=Cv(t),H=kv(t),L=_B.parts.header({dom:d({tag:"div",classes:["tox-editor-header"]},v),components:Q([H?[_]:[],P?[D]:V?[E]:[],Pv(t)?[]:[S.asSpec()]]),sticky:Lv(t),editor:t,sharedBackstage:O.shared}),z=Q([g?[]:[L],u?[]:[R],g?[L]:[]]),N=Q([[{dom:{tag:"div",classes:["tox-editor-container"]},components:z}],u?[]:F.toArray(),[M]]),j=Hv(t),U=d(d({role:"application"},nv.isRtl()?{dir:"rtl"}:{}),j?{"aria-hidden":"true"}:{}),W=pu(_B.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(u?["tox-tinymce-inline"]:[]).concat(g?["tox-tinymce--toolbar-bottom"]:[]).concat(m).concat(f),styles:d({visibility:"hidden"},j?{opacity:"0",border:"0"}:{}),attributes:U},components:N,behaviours:uc([Wv(),pv.config({disableClass:"tox-tinymce--disabled"}),ag.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a"})])}));s=C.some(W);t.shortcuts.add("alt+F9","focus menubar",(function(){_B.focusMenubar(W)})),t.shortcuts.add("alt+F10","focus toolbar",(function(){_B.focusToolbar(W)})),t.addCommand("ToggleToolbarDrawer",(function(){_B.toggleToolbarDrawer(W)})),t.addQueryStateHandler("ToggleToolbarDrawer",(function(){return _B.isToolbarDrawerToggled(W)}));var X,Y,q,K,J,$,Z,tt,nt,et,ot,rt,it,ut,at,ct,st,lt=Uy(W),dt=Uy(x);X=t,Y=lt,q=dt,K=function(t,n){G([Y,q],(function(e){e.broadcastEvent(t,n)}))},J=function(t,n){G([Y,q],(function(e){e.broadcastOn([t],n)}))},$=function(t){return J(Cl(),{target:t.target})},Z=Cy(pe.fromDom(document),"touchstart",$),tt=Cy(pe.fromDom(document),"touchmove",(function(t){return K(Ro(),t)})),nt=Cy(pe.fromDom(document),"touchend",(function(t){return K(Po(),t)})),et=Cy(pe.fromDom(document),"mousedown",$),ot=Cy(pe.fromDom(document),"mouseup",(function(t){0===t.raw.button&&J(_l(),{target:t.target})})),rt=function(t){return J(Cl(),{target:pe.fromDom(t.target)})},it=function(t){0===t.button&&J(_l(),{target:pe.fromDom(t.target)})},ut=function(t){return K(Vo(),_y(t))},at=function(t){J(Ol(),{}),K(Ho(),_y(t))},ct=function(){return J(Ol(),{})},st=function(t){t.state&&J(Cl(),{target:pe.fromDom(X.getContainer())})},X.on("PostRender",(function(){X.on("click",rt),X.on("tap",rt),X.on("mouseup",it),X.on("ScrollWindow",ut),X.on("ResizeWindow",at),X.on("ResizeEditor",ct),X.on("AfterProgressState",st)})),X.on("remove",(function(){X.off("click",rt),X.off("tap",rt),X.off("mouseup",it),X.off("ScrollWindow",ut),X.off("ResizeWindow",at),X.off("ResizeEditor",ct),X.off("AfterProgressState",st),et.unbind(),Z.unbind(),tt.unbind(),nt.unbind(),ot.unbind()})),X.on("detach",(function(){ml(Y),ml(q),Y.destroy(),q.destroy()}));var mt=function(){var n,e=UB(GB(t)),o=UB(XB(n=t).getOr(bv(n)));return t.inline||(nu("div","width",o)&&Ki(W.element,"width",o),nu("div","height",e)?Ki(W.element,"height",e):Ki(W.element,"height","200px")),e};return{mothership:lt,uiMothership:dt,backstage:O,renderUI:function(){var n,e,o,r,i,u,s,l;c.setup(t,O.shared,b),cA(t,O),DA(t,w,O),e=(n=t).ui.registry.getAll().sidebars,G(_t(e),(function(t){var o=e[t],r=function(){return C.from(n.queryCommandValue("ToggleSidebar")).is(t)};n.ui.registry.addToggleButton(t,{icon:o.icon,tooltip:o.tooltip,onAction:function(e){n.execCommand("ToggleSidebar",!1,t),e.setActive(r())},onSetup:function(t){var e=function(){return t.setActive(r())};return n.on("ToggleSidebar",e),function(){n.off("ToggleSidebar",e)}}})})),o=t,r=k,i=O.shared,u=me(!1),s=me(C.none()),l=function(t){t!==u.get()&&(bB(r(),t,i.providers),u.set(t),o.fire("AfterProgressState",{state:t}))},o.on("ProgressState",(function(t){var n;s.get().each(mp.clearTimeout),I(t.time)?(n=mp.setEditorTimeout(o,(function(){return l(t.state)}),t.time),s.set(C.some(n))):(l(t.state),s.set(C.none()))})),Dt(t.getParam("toolbar_groups",{},"object"),(function(n,e){t.ui.registry.addGroupToolbarButton(e,n)}));var f,m=t.ui.registry.getAll(),g=m.buttons,p=m.menuItems,h=m.contextToolbars,v=m.sidebars,y=Ov(t),S={menuItems:p,menus:(f=t.getParam("menu"))?Dt(f,(function(t){return d(d({},t),{items:t.items})})):{},menubar:t.getParam("menubar"),toolbar:y.getOrThunk((function(){return t.getParam("toolbar",!0)})),allowToolbarGroups:T===ih.floating,buttons:g,sidebar:v};xD(t,h,x,{backstage:O}),yM(t,x);var _=t.getElement(),E=mt(),D={mothership:lt,uiMothership:dt,outerContainer:W},B={targetNode:_,height:E};return a.render(t,D,S,O,B)},getUi:function(){return{channels:{broadcastAll:dt.broadcast,broadcastOn:dt.broadcastOn,register:e}}}}},TM=r([Un("lazySink"),$n("dragBlockClass"),se("getBounds",ju),oe("useTabstopAt",l),oe("eventOrder",{}),Wl("modalBehaviours",[ag]),ha("onExecute"),ba("onEscape")]),EM={sketch:i},DM=r([Sf({name:"draghandle",overrides:function(t,n){return{behaviours:uc([pM.config({mode:"mouse",getTarget:function(t){return Ku(t,'[role="dialog"]').getOr(t)},blockerClass:t.dragBlockClass.getOrDie(new Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(n,null,2)).message),getBounds:t.getDragBounds})])}}}),xf({schema:[Un("dom")],name:"title"}),xf({factory:EM,schema:[Un("dom")],name:"close"}),xf({factory:EM,schema:[Un("dom")],name:"body"}),Sf({factory:EM,schema:[Un("dom")],name:"footer"}),wf({factory:{sketch:function(t,n){return d(d({},t),{dom:n.dom,components:n.components})}},schema:[oe("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),oe("components",[])],name:"blocker"})]),BM=Object.freeze({__proto__:null,block:function(t,n,e,o){Kr(t.element,"aria-busy",!0);var r=n.getRoot(t).getOr(t),i=uc([ag.config({mode:"special",onTab:function(){return C.some(!0)},onShiftTab:function(){return C.some(!0)}}),bg.config({})]),u=o(r,i),a=r.getSystem().build(u);dg.append(r,hu(a)),a.hasConfigured(ag)&&ag.focusIn(a),e.isBlocked()||n.onBlock(t),e.blockWith((function(){return dg.remove(r,a)}))},unblock:function(t,n,e){Zr(t.element,"aria-busy"),e.isBlocked()&&n.onUnblock(t),e.clear()}}),AM=[se("getRoot",C.none),pa("onBlock"),pa("onUnblock")],MM=cc({fields:AM,name:"blocking",apis:BM,state:Object.freeze({__proto__:null,init:function(){var t=oD();return Si({readState:t.isSet,blockWith:function(n){t.set({destroy:n})},clear:t.clear,isBlocked:t.isSet})}})}),FM=Kf({name:"ModalDialog",configFields:TM(),partFields:DM(),factory:function(t,n,e,o){var r,u=me(C.none()),a=ii("modal-events"),c=d(d({},t.eventOrder),((r={})[Lo()]=[a].concat(t.eventOrder["alloy.system.attached"]||[]),r));return{uid:t.uid,dom:t.dom,components:n,apis:{show:function(n){u.set(C.some(n));var e=t.lazySink(n).getOrDie(),r=o.blocker(),i=e.getSystem().build(d(d({},r),{components:r.components.concat([hu(n)]),behaviours:uc([bg.config({}),mg("dialog-blocker-events",[lr(mo(),(function(){ag.focusIn(n)}))])])}));ul(e,i),ag.focusIn(n)},hide:function(t){u.set(C.none()),Or(t.element).each((function(n){t.getSystem().getByDom(n).each((function(t){sl(t)}))}))},getBody:function(n){return Rf(n,t,"body")},getFooter:function(n){return Rf(n,t,"footer")},setIdle:function(t){MM.unblock(t)},setBusy:function(t,n){MM.block(t,n)}},eventOrder:c,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:Xl(t.modalBehaviours,[dg.config({}),ag.config({mode:"cyclic",onEnter:t.onExecute,onEscape:t.onEscape,useTabstopAt:t.useTabstopAt}),MM.config({getRoot:u.get}),mg(a,[fr((function(n){var e,o,r,u,a,c;e=n.element,o=Rf(n,t,"title").element,r=$r(e,"id").fold((function(){var t=ii("dialog-label");return Kr(o,"id",t),t}),i),Kr(e,"aria-labelledby",r),u=n.element,a=Rf(n,t,"body").element,c=C.from(Jr(u,"id")).fold((function(){var t=ii("dialog-describe");return Kr(a,"id",t),t}),i),Kr(u,"aria-describedby",c)}))])])}},apis:{show:function(t,n){t.show(n)},hide:function(t,n){t.hide(n)},getBody:function(t,n){return t.getBody(n)},getFooter:function(t,n){return t.getFooter(n)},setBusy:function(t,n,e){t.setBusy(n,e)},setIdle:function(t,n){t.setIdle(n)}}}),IM=mn([Gn("type"),Gn("name")].concat(Ph)),RM=Hn,PM=[xn("name","name",qt((function(){return ii("button-name")})),Vn),te("icon"),ae("align","end",["start","end"]),ce("primary",!1),ce("disabled",!1)],VM=g(PM,[Gn("text")]),HM=g([Xn("type",["submit","cancel","custom"])],VM),LM=g([Xn("type",["menu"]),te("text"),te("tooltip"),te("icon"),Jn("items",IM)],PM),zM=Fn("type",{submit:HM,cancel:HM,custom:HM,menu:LM}),NM=[Gn("type"),Gn("text"),Xn("level",["info","warn","error","success"]),Gn("icon"),oe("url","")],jM=mn(NM),UM=[Gn("type"),Gn("text"),ce("disabled",!1),ce("primary",!1),xn("name","name",qt((function(){return ii("button-name")})),Vn),te("icon"),ce("borderless",!1)],WM=mn(UM),GM=[Gn("type"),Gn("name"),Gn("label"),ce("disabled",!1)],XM=mn(GM),YM=Hn,qM=[Gn("type"),Gn("name")],KM=qM.concat([te("label")]),JM=KM.concat([oe("columns","auto")]),$M=mn(JM),QM=Cn([Gn("value"),Gn("text"),Gn("icon")]),ZM=mn(KM),tF=Vn,nF=mn(KM),eF=Vn,oF=qM.concat([ue("tag","textarea"),Gn("scriptId"),Gn("scriptUrl"),(xM=void 0,re("settings",xM,Nn))]),rF=qM.concat([ue("tag","textarea"),Yn("init")]),iF=_n((function(t){return En("customeditor.old",dn(rF),t).orThunk((function(){return En("customeditor.new",dn(oF),t)}))})),uF=Vn,aF=mn(KM),cF=gn(kn),sF=function(t){return[Gn("type"),Wn("columns",Pn),t]},lF=[Gn("type"),Gn("html"),ae("presets","presentation",["presentation","document"])],fF=mn(lF),dF=KM.concat([ce("sandboxed",!0)]),mF=mn(dF),gF=Vn,pF=KM.concat([Wn("currentState",mn([Un("blob"),Gn("url")]))]),hF=mn(pF),vF=KM.concat([te("inputMode"),te("placeholder"),ce("maximized",!1),ce("disabled",!1)]),bF=mn(vF),yF=Vn,xF=[Gn("text"),Gn("value")],wF=[Gn("text"),Jn("items",(wM=function(){return SF},SM=Ut((function(){return wM()})),{extract:function(t,n,e){return SM().extract(t,n,e)},toString:function(){return SM().toString()}}))],SF=pn([mn(xF),mn(wF)]),kF=KM.concat([Jn("items",SF),ce("disabled",!1)]),CF=mn(kF),OF=Vn,_F=KM.concat([Kn("items",[Gn("text"),Gn("value")]),ie("size",1),ce("disabled",!1)]),TF=mn(_F),EF=Vn,DF=KM.concat([ce("constrain",!0),ce("disabled",!1)]),BF=mn(DF),AF=mn([Gn("width"),Gn("height")]),MF=[Gn("type"),Jn("header",Vn),Jn("cells",gn(Vn))],FF=mn(MF),IF=KM.concat([te("placeholder"),ce("maximized",!1),ce("disabled",!1)]),RF=mn(IF),PF=Vn,VF=KM.concat([ae("filetype","file",["image","media","file"]),oe("disabled",!1)]),HF=mn(VF),LF=mn([Gn("value"),oe("meta",{})]),zF=function(t){return xn("items","items",Xt(),gn(_n((function(n){return En("Checking item of "+t,NF,n).fold((function(t){return ft.error(An(t))}),(function(t){return ft.value(t)}))}))))},NF=On((function(){return Mn("type",{alertbanner:jM,bar:mn((n=zF("bar"),[Gn("type"),n])),button:WM,checkbox:XM,colorinput:ZM,colorpicker:nF,dropzone:aF,grid:mn(sF(zF("grid"))),iframe:mF,input:bF,listbox:CF,selectbox:TF,sizeinput:BF,textarea:RF,urlinput:HF,customeditor:iF,htmlpanel:fF,imagetools:hF,collection:$M,label:mn((t=zF("label"),[Gn("type"),Gn("label"),t])),table:FF,panel:UF});var t,n})),jF=[Gn("type"),oe("classes",[]),Jn("items",NF)],UF=mn(jF),WF=[xn("name","name",qt((function(){return ii("tab-name")})),Vn),Gn("title"),Jn("items",NF)],GF=[Gn("type"),Kn("tabs",WF)],XF=mn(GF),YF=VM,qF=zM,KF=mn([Gn("title"),Wn("body",Mn("type",{panel:UF,tabpanel:XF})),ue("size","normal"),Jn("buttons",qF),oe("initialData",{}),se("onAction",e),se("onChange",e),se("onSubmit",e),se("onClose",e),se("onCancel",e),oe("onTabChange",e)]),JF=mn(g([Xn("type",["cancel","custom"])],YF)),$F=mn([Gn("title"),Gn("url"),Zn("height"),Zn("width"),Qn("buttons",gn(JF)),se("onAction",e),se("onCancel",e),se("onClose",e),se("onMessage",e)]),QF=function t(n){return E(n)?[n].concat(Z(It(n),t)):D(n)?Z(n,t):[]},ZF=function(t){return T(t.type)&&T(t.name)},tI={checkbox:YM,colorinput:tF,colorpicker:eF,dropzone:cF,input:yF,iframe:gF,sizeinput:AF,selectbox:EF,listbox:OF,size:AF,textarea:PF,urlinput:LF,customeditor:uF,collection:QM,togglemenuitem:RM},nI=function(t){var n=Y(QF(t),ZF),e=Z(n,(function(t){return n=t,C.from(tI[n.type]).fold((function(){return[]}),(function(n){return[Wn(t.name,n)]}));var n}));return mn(e)},eI=function(t){return{internalDialog:Dn(En("dialog",KF,t)),dataValidator:nI(t),initialData:t.initialData}},oI={open:function(t,n){var e=eI(n);return t(e.internalDialog,e.initialData,e.dataValidator)},openUrl:function(t,n){return t(Dn(En("dialog",$F,n)))},redial:eI},rI=function(t){var n=[],e={};return Et(t,(function(t,o){t.fold((function(){n.push(o)}),(function(t){e[o]=t}))})),0<n.length?ft.error(n):ft.value(e)},iI=qf({name:"TabButton",configFields:[oe("uid",void 0),Un("value"),xn("dom","dom",Kt((function(){return{attributes:{role:"tab",id:ii("aria"),"aria-selected":"false"}}})),In()),$n("action"),oe("domModification",{}),Wl("tabButtonBehaviours",[bg,ag,Ul]),Un("view")],factory:function(t,n){return{uid:t.uid,dom:t.dom,components:t.components,events:Mg(t.action),behaviours:Xl(t.tabButtonBehaviours,[bg.config({}),ag.config({mode:"execution",useSpace:!0,useEnter:!0}),Ul.config({store:{mode:"memory",initialValue:t.value}})]),domModification:t.domModification}}}),uI=r([Un("tabs"),Un("dom"),oe("clickToDismiss",!1),Wl("tabbarBehaviours",[dd,ag]),ma(["tabClass","selectedClass"])]),aI=kf({factory:iI,name:"tabs",unit:"tab",overrides:function(t){var n=function(t,n){dd.dehighlight(t,n),Jo(t,Xo(),{tabbar:t,button:n})},o=function(t,n){dd.highlight(t,n),Jo(t,Go(),{tabbar:t,button:n})};return{action:function(r){var i=r.getSystem().getByUid(t.uid).getOrDie(),u=dd.isHighlighted(i,r);(u&&t.clickToDismiss?n:u?e:o)(i,r)},domModification:{classes:[t.markers.tabClass]}}}}),cI=r([aI]),sI=Kf({name:"Tabbar",configFields:uI(),partFields:cI(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:Xl(t.tabbarBehaviours,[dd.config({highlightClass:t.markers.selectedClass,itemClass:t.markers.tabClass,onHighlight:function(t,n){Kr(n.element,"aria-selected","true")},onDehighlight:function(t,n){Kr(n.element,"aria-selected","false")}}),ag.config({mode:"flow",getInitial:function(t){return dd.getHighlighted(t).map((function(t){return t.element}))},selector:"."+t.markers.tabClass,executeOnMove:!0})])}}}),lI=qf({name:"Tabview",configFields:[Wl("tabviewBehaviours",[dg])],factory:function(t,n){return{uid:t.uid,dom:t.dom,behaviours:Xl(t.tabviewBehaviours,[dg.config({})]),domModification:{attributes:{role:"tabpanel"}}}}}),fI=r([oe("selectFirst",!0),pa("onChangeTab"),pa("onDismissTab"),oe("tabs",[]),Wl("tabSectionBehaviours",[])]),dI=xf({factory:sI,schema:[Un("dom"),qn("markers",[Un("tabClass"),Un("selectedClass")])],name:"tabbar",defaults:function(t){return{tabs:t.tabs}}}),mI=xf({factory:lI,name:"tabview"}),gI=r([dI,mI]),pI=Kf({name:"TabSection",configFields:fI(),partFields:gI(),factory:function(t,n,e,o){var r=function(n,e){If(n,t,"tabbar").each((function(t){e(t).each($o)}))};return{uid:t.uid,dom:t.dom,components:n,behaviours:Gl(t.tabSectionBehaviours),events:nr(Q([t.selectFirst?[fr((function(t,n){r(t,dd.getFirst)}))]:[],[rr(Go(),(function(n,e){var o,r,i=e.event.button;o=i,r=Ul.getValue(o),If(o,t,"tabview").each((function(n){J(t.tabs,(function(t){return t.value===r})).each((function(e){var r=e.view();$r(o.element,"id").each((function(t){Kr(n.element,"aria-labelledby",t)})),dg.set(n,r),t.onChangeTab(n,o,r)}))}))})),rr(Xo(),(function(n,e){var o=e.event.button;t.onDismissTab(n,o)}))]])),apis:{getViewItems:function(n){return If(n,t,"tabview").map((function(t){return dg.contents(t)})).getOr([])},showTab:function(t,n){r(t,(function(t){var e=dd.getCandidates(t);return J(e,(function(t){return Ul.getValue(t)===n})).filter((function(n){return!dd.isHighlighted(t,n)}))}))}}}},apis:{getViewItems:function(t,n){return t.getViewItems(n)},showTab:function(t,n,e){t.showTab(n,e)}}}),hI=function(t,n){Ki(t,"height",n+"px"),We().browser.isIE()?eu(t,"flex-basis"):Ki(t,"flex-basis",n+"px")},vI=function(t,n,e){Ku(t,'[role="dialog"]').each((function(t){Ju(t,'[role="tablist"]').each((function(o){e.get().map((function(e){return Ki(n,"height","0"),Ki(n,"flex-basis","0"),Math.min(e,(i=n,u=o,a=kr(r=t).dom,c=Ku(r,".tox-dialog-wrap").getOr(r),s="fixed"===Qi(c,"position")?Math.max(a.clientHeight,window.innerHeight):Math.max(a.offsetHeight,a.scrollHeight),l=yu(i),f=i.dom.offsetLeft>=u.dom.offsetLeft+Tu(u)?Math.max(yu(u),l):l,d=parseInt(Qi(r,"margin-top"),10)||0,m=parseInt(Qi(r,"margin-bottom"),10)||0,s-(yu(r)+d+m-f)));var r,i,u,a,c,s,l,f,d,m})).each((function(t){hI(n,t)}))}))}))},bI=function(t){return Ju(t,'[role="tabpanel"]')},yI=function(t){var n;return{smartTabHeight:(n=me(C.none()),{extraEvents:[fr((function(e){var o=e.element;bI(o).each((function(r){var i;Ki(r,"visibility","hidden"),e.getSystem().getByDom(r).toOptional().each((function(e){var o,i,u,a=(i=r,u=e,W(o=t,(function(t,n){dg.set(u,o[n].view());var e=i.dom.getBoundingClientRect();return dg.set(u,[]),e.height}))),c=it(ot(a,(function(t,n){return n<t?-1:t<n?1:0})));n.set(c)})),vI(o,r,n),eu(r,"visibility"),i=e,it(t).each((function(t){return pI.showTab(i,t.value)})),mp.requestAnimationFrame((function(){vI(o,r,n)}))}))})),rr(Ho(),(function(t){var e=t.element;bI(e).each((function(t){vI(e,t,n)}))})),rr(sx,(function(t,e){var o=t.element;bI(o).each((function(t){var e=pc(Fr(t));Ki(t,"visibility","hidden");var r=tu(t,"height").map((function(t){return parseInt(t,10)}));eu(t,"height"),eu(t,"flex-basis");var i=t.dom.getBoundingClientRect().height;r.forall((function(t){return t<i}))?(n.set(C.from(i)),vI(o,t,n)):r.each((function(n){hI(t,n)})),eu(t,"visibility"),e.each(gc)}))}))],selectFirst:!1}),naiveTabHeight:{extraEvents:[],selectFirst:!0}}},xI="send-data-to-section",wI="send-data-to-view",SI=ii("update-dialog"),kI=ii("update-title"),CI=ii("update-body"),OI=ii("update-footer"),_I=ii("body-send-message"),TI=function(t,n,e,o){return{dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:d(d({},n.map((function(t){return{id:t}})).getOr({})),o?{"aria-live":"polite"}:{})},components:[],behaviours:uc([sk(0),uE.config({channel:CI,updateState:function(t,n){return C.some({isTabPanel:function(){return"tabpanel"===n.body.type}})},renderComponents:function(t){switch(t.body.type){case"tabpanel":return[(i=t.body,u=e,c=me({}),s=function(t){var n=Ul.getValue(t),e=rI(n).getOr({}),o=c.get(),r=Nt(o,e);c.set(r)},l=function(t){var n=c.get();Ul.setValue(t,n)},f=me(null),d=W(i.tabs,(function(t){return{value:t.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"],innerHtml:u.shared.providers.translate(t.title)},view:function(){return[ZS.sketch((function(n){return{dom:{tag:"div",classes:["tox-form"]},components:W(t.items,(function(t){return l_(n,t,u)})),formBehaviours:uc([ag.config({mode:"acyclic",useTabstopAt:a(Ek)}),mg("TabView.form.events",[fr(l),dr(s)]),dc.config({channels:Zt([{key:xI,value:{onReceive:s}},{key:wI,value:{onReceive:l}}])})])}}))]}}})),m=yI(d).smartTabHeight,pI.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:function(t,n,e){var o=Ul.getValue(n);Jo(t,cx,{name:o,oldName:f.get()}),f.set(o)},tabs:d,components:[pI.parts.tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[sI.parts.tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:uc([Ky.config({})])}),pI.parts.tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:m.selectFirst,tabSectionBehaviours:uc([mg("tabpanel",m.extraEvents),ag.config({mode:"acyclic"}),nd.config({find:function(t){return it(pI.getViewItems(t))}}),Ul.config({store:{mode:"manual",getValue:function(t){return t.getSystem().broadcastOn([xI],{}),c.get()},setValue:function(t,n){c.set(n),t.getSystem().broadcastOn([wI],{})}}})])}))];default:return[(n=t.body,o=e,{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[(r=pp(ZS.sketch((function(t){return{dom:{tag:"div",classes:["tox-form"].concat(n.classes)},components:W(n.items,(function(n){return l_(t,n,o)}))}})))).asSpec()]}],behaviours:uc([ag.config({mode:"acyclic",useTabstopAt:a(Ek)}),ck(r),vk(r,{postprocess:function(t){return rI(t).fold((function(t){return console.error(t),{}}),(function(t){return t}))}})])})]}var n,o,r,i,u,c,s,l,f,d,m},initialData:t})])}},EI=eb.deviceType.isTouch(),DI=function(t,n){return{dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[t,n]}},BI=function(t,n){return FM.parts.close(gp.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":n.translate("Close")}},action:t,buttonBehaviours:uc([Ky.config({})])}))},AI=function(){return FM.parts.title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}})},MI=function(t,n){return FM.parts.body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:vB("<p>"+n.translate(t)+"</p>")}]}]})},FI=function(t){return FM.parts.footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:t})},II=function(t,n){return[jy.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:t}),jy.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:n})]},RI=function(t){var n,e="tox-dialog",o=e+"-wrap",r=o+"__backdrop",i=e+"__disable-scroll";return FM.sketch({lazySink:t.lazySink,onEscape:function(n){return t.onEscape(n),C.some(!0)},useTabstopAt:function(t){return!Ek(t)},dom:{tag:"div",classes:[e].concat(t.extraClasses),styles:d({position:"relative"},t.extraStyles)},components:g([t.header,t.body],t.footer.toArray()),parts:{blocker:{dom:vB('<div class="'+o+'"></div>'),components:[{dom:{tag:"div",classes:EI?[r,r+"--opaque"]:[r]}}]}},dragBlockClass:o,modalBehaviours:uc(g([bg.config({}),mg("dialog-events",t.dialogEvents.concat([lr(mo(),(function(t,n){ag.focusIn(t)}))])),mg("scroll-lock",[fr((function(){Vi(Gi(),i)})),dr((function(){Li(Gi(),i)}))])],t.extraBehaviours)),eventOrder:d(((n={})[Eo()]=["dialog-events"],n[Lo()]=["scroll-lock","dialog-events","alloy.base.behaviour"],n[zo()]=["alloy.base.behaviour","dialog-events","scroll-lock"],n),t.eventOrder)})},PI=function(t){return gp.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close"),title:t.translate("Close")}},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:vp("close",t.icons)}}],action:function(t){Ko(t,ox)}})},VI=function(t,n,e){var o=function(t){return[du(e.translate(t.title))]};return{dom:{tag:"div",classes:["tox-dialog__title"],attributes:d({},n.map((function(t){return{id:t}})).getOr({}))},components:o(t),behaviours:uc([uE.config({channel:kI,renderComponents:o})])}},HI=function(){return{dom:vB('<div class="tox-dialog__draghandle"></div>')}},LI=function(t,n){return e={title:n.shared.providers.translate(t),draggable:n.dialog.isDraggableModal()},o=n.shared.providers,r=FM.parts.title(VI(e,C.none(),o)),i=FM.parts.draghandle(HI()),u=FM.parts.close(PI(o)),a=[r].concat(e.draggable?[i]:[]).concat([u]),jy.sketch({dom:vB('<div class="tox-dialog__header"></div>'),components:a});var e,o,r,i,u,a},zI=function(t,n,e){return{dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":e.translate(t)},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:n,components:[{dom:vB('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}},NI=function(t,n,e){return{onClose:function(){return e.closeWindow()},onBlock:function(e){FM.setBusy(t(),(function(t,o){return zI(e.message,o,n)}))},onUnblock:function(){FM.setIdle(t())}}},jI=function(t,n,e,o){var r;return pu(RI(d(d({},t),{lazySink:o.shared.getSink,extraBehaviours:g([uE.config({channel:SI,updateState:function(t,n){return C.some(n)},initialData:n}),xk({})],t.extraBehaviours),onEscape:function(t){Ko(t,ox)},dialogEvents:e,eventOrder:((r={})[To()]=[uE.name(),dc.name()],r[Lo()]=["scroll-lock",uE.name(),"messages","dialog-events","alloy.base.behaviour"],r[zo()]=["alloy.base.behaviour","dialog-events","messages",uE.name(),"scroll-lock"],r)})))},UI=function(t){return W(t,(function(t){return"menu"===t.type?(e=W((n=t).items,(function(t){var n=me(!1);return d(d({},t),{storage:n})})),d(d({},n),{items:e})):t;var n,e}))},WI=function(t){return K(t,(function(t,n){return"menu"!==n.type?t:K(n.items,(function(t,n){return t[n.name]=n.storage,t}),t)}),{})},GI=function(t,n){return[cr(mo(),Tk),t(ex,(function(t,e){n.onClose(),e.onClose()})),t(ox,(function(t,n,e,o){n.onCancel(t),Ko(o,ex)})),rr(ax,(function(t,e){return n.onUnblock()})),rr(ux,(function(t,e){return n.onBlock(e.event)}))]},XI=function(t,n){var e=function(n,e){return rr(n,(function(n,r){o(n,(function(o,i){e(t(),o,r.event,n)}))}))},o=function(t,n){uE.getState(t).get().each((function(e){n(e,t)}))};return g(GI(e,n),[e(rx,(function(t,n,e){n.onAction(t,{name:e.name})}))])},YI=function(t,n,e){var o=function(n,e){return rr(n,(function(n,o){r(n,(function(r,i){e(t(),r,o.event,n)}))}))},r=function(t,n){uE.getState(t).get().each((function(e){n(e.internalDialog,t)}))};return g(GI(o,n),[o(ix,(function(t,n){return n.onSubmit(t)})),o(nx,(function(t,n,e){n.onChange(t,{name:e.name})})),o(rx,(function(t,n,o,r){var i=function(){return ag.focusIn(r)},u=function(t){return Qr(t,"disabled")||$r(t,"aria-disabled").exists((function(t){return"true"===t}))},a=Fr(r.element),c=pc(a);n.onAction(t,{name:o.name,value:o.value}),pc(a).fold(i,(function(t){u(t)||c.exists((function(n){return Ke(t,n)&&u(n)}))?i():e().toOptional().filter((function(n){return!Ke(n.element,t)})).each(i)}))})),o(cx,(function(t,n,e){n.onTabChange(t,{newTabName:e.name,oldTabName:e.oldName})})),dr((function(n){var e=t();Ul.setValue(n,e.getData())}))])},qI=function(t,n){var e=n.map((function(t){return t.footerButtons})).getOr([]),o=X(e,(function(t){return"start"===t.align})),r=function(t,n){return jy.sketch({dom:{tag:"div",classes:["tox-dialog__footer-"+t]},components:W(n,(function(t){return t.memento.asSpec()}))})};return[r("start",o.pass),r("end",o.fail)]},KI=function(t,n){return{dom:vB('<div class="tox-dialog__footer"></div>'),components:[],behaviours:uc([uE.config({channel:OI,initialData:t,updateState:function(t,e){var o=W(e.buttons,(function(t){var e,o,r=pp((o=n,QC(e=t,e.type,o)));return{name:t.name,align:t.align,memento:r}}));return C.some({lookupByName:function(t,n){return e=t,r=n,J(o,(function(t){return t.name===r})).bind((function(t){return t.memento.getOpt(e)}));var e,r},footerButtons:o})},renderComponents:qI})])}},JI=KI,$I=function(t,n){return FM.parts.footer(KI(t,n))},QI=function(t,n){if(t.getRoot().getSystem().isConnected()){var e=nd.getCurrent(t.getFormWrapper()).getOr(t.getFormWrapper());return ZS.getField(e,n).fold((function(){var o=t.getFooter();return uE.getState(o).get().bind((function(t){return t.lookupByName(e,n)}))}),(function(t){return C.some(t)}))}return C.none()},ZI=function(t,n,e){var o=function(n){var e=t.getRoot();e.getSystem().isConnected()&&n(e)},r={getData:function(){var n=t.getRoot(),o=n.getSystem().isConnected()?t.getFormWrapper():n,r=Ul.getValue(o),i=Dt(e,(function(t){return t.get()}));return d(d({},r),i)},setData:function(n){o((function(o){var i,u,a=r.getData(),c=d(d({},a),n),s=(i=c,u=t.getRoot(),uE.getState(u).get().map((function(t){return Dn(En("data",t.dataValidator,i))})).getOr(i)),l=t.getFormWrapper();Ul.setValue(l,s),Et(e,(function(t,n){Pt(c,n)&&t.set(c[n])}))}))},disable:function(n){QI(t,n).each(pv.disable)},enable:function(n){QI(t,n).each(pv.enable)},focus:function(n){QI(t,n).each(bg.focus)},block:function(t){if(!T(t))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");o((function(n){Jo(n,ux,{message:t})}))},unblock:function(){o((function(t){Ko(t,ax)}))},showTab:function(n){o((function(e){var o=t.getBody();uE.getState(o).get().exists((function(t){return t.isTabPanel()}))&&nd.getCurrent(o).each((function(t){pI.showTab(t,n)}))}))},redial:function(t){o((function(e){var o=n(t);e.getSystem().broadcastOn([SI],o),e.getSystem().broadcastOn([kI],o.internalDialog),e.getSystem().broadcastOn([CI],o.internalDialog),e.getSystem().broadcastOn([OI],o.internalDialog),r.setData(o.initialData)}))},close:function(){o((function(t){Ko(t,ex)}))}};return r},tR=function(t,n,e){var o,r,i,u=LI(t.internalDialog.title,e),a=(o={body:t.internalDialog.body},r=e,i=TI(o,C.none(),r,!1),FM.parts.body(i)),c=UI(t.internalDialog.buttons),s=WI(c),l=$I({buttons:c},e),f=YI((function(){return p}),NI((function(){return g}),e.shared.providers,n),e.shared.getSink),d=function(t){switch(t){case"large":return["tox-dialog--width-lg"];case"medium":return["tox-dialog--width-md"];default:return[]}}(t.internalDialog.size),m={header:u,body:a,footer:C.some(l),extraClasses:d,extraBehaviours:[],extraStyles:{}},g=jI(m,t,f,e),p=ZI({getRoot:function(){return g},getBody:function(){return FM.getBody(g)},getFooter:function(){return FM.getFooter(g)},getFormWrapper:function(){var t=FM.getBody(g);return nd.getCurrent(t).getOr(t)}},n.redial,s);return{dialog:g,instanceApi:p}},nR=function(t,n,e,o){var r,i,u,a,c,s,l,f,d,m=ii("dialog-label"),g=ii("dialog-content"),p=pp((u={title:t.internalDialog.title,draggable:!0},a=m,c=e.shared.providers,jy.sketch({dom:vB('<div class="tox-dialog__header"></div>'),components:[VI(u,C.some(a),c),HI(),PI(c)],containerBehaviours:uc([pM.config({mode:"mouse",blockerClass:"blocker",getTarget:function(t){return $u(t,'[role="dialog"]').getOrDie()},snaps:{getSnapPoints:function(){return[]},leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])}))),h=pp((s={body:t.internalDialog.body},l=g,f=e,d=o,TI(s,C.some(l),f,d))),v=UI(t.internalDialog.buttons),b=WI(v),y=pp(JI({buttons:v},e)),x=YI((function(){return S}),{onBlock:function(t){MM.block(w,(function(n,o){return zI(t.message,o,e.shared.providers)}))},onUnblock:function(){MM.unblock(w)},onClose:function(){return n.closeWindow()}},e.shared.getSink),w=pu({dom:{tag:"div",classes:["tox-dialog","tox-dialog-inline"],attributes:((r={role:"dialog"})["aria-labelledby"]=m,r["aria-describedby"]=""+g,r)},eventOrder:((i={})[To()]=[uE.name(),dc.name()],i[Eo()]=["execute-on-form"],i[Lo()]=["reflecting","execute-on-form"],i),behaviours:uc([ag.config({mode:"cyclic",onEscape:function(t){return Ko(t,ex),C.some(!0)},useTabstopAt:function(t){return!Ek(t)&&("button"!==pr(t)||"disabled"!==Jr(t,"disabled"))}}),uE.config({channel:SI,updateState:function(t,n){return C.some(n)},initialData:t}),bg.config({}),mg("execute-on-form",x.concat([lr(mo(),(function(t,n){ag.focusIn(t)}))])),MM.config({getRoot:function(){return C.some(w)}}),dg.config({}),xk({})]),components:[p.asSpec(),h.asSpec(),y.asSpec()]}),S=ZI({getRoot:function(){return w},getFooter:function(){return y.get(w)},getBody:function(){return h.get(w)},getFormWrapper:function(){var t=h.get(w);return nd.getCurrent(t).getOr(t)}},n.redial,b);return{dialog:w,instanceApi:S}},eR=tinymce.util.Tools.resolve("tinymce.util.URI"),oR=["insertContent","setContent","execCommand","close","block","unblock"],rR=function(t){return E(t)&&-1!==oR.indexOf(t.mceAction)},iR=function(t,n,e,o){var r,i,u,c,s=LI(t.title,o),l=(i={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[Ok({dom:{tag:"iframe",attributes:{src:t.url}},behaviours:uc([Ky.config({}),bg.config({})])})]}],behaviours:uc([ag.config({mode:"acyclic",useTabstopAt:a(Ek)})])},FM.parts.body(i)),f=t.buttons.bind((function(t){return 0===t.length?C.none():C.some($I({buttons:t},o))})),m=XI((function(){return w}),NI((function(){return x}),o.shared.providers,n)),g=d(d({},t.height.fold((function(){return{}}),(function(t){return{height:t+"px","max-height":t+"px"}}))),t.width.fold((function(){return{}}),(function(t){return{width:t+"px","max-width":t+"px"}}))),p=t.width.isNone()&&t.height.isNone()?["tox-dialog--width-lg"]:[],h=new eR(t.url,{base_uri:new eR(window.location.href)}),v=h.protocol+"://"+h.host+(h.port?":"+h.port:""),b=me(C.none()),y=[mg("messages",[fr((function(){var n=Cy(pe.fromDom(window),"message",(function(n){var o,r;h.isSameOrigin(new eR(n.raw.origin))&&(o=n.raw.data,rR(o)?function(t,n,e){switch(e.mceAction){case"insertContent":t.insertContent(e.content);break;case"setContent":t.setContent(e.content);break;case"execCommand":var o=!!B(e.ui)&&e.ui;t.execCommand(e.cmd,o,e.value);break;case"close":n.close();break;case"block":n.block(e.message);break;case"unblock":n.unblock()}}(e,w,o):!rR(r=o)&&E(r)&&Pt(r,"mceAction")&&t.onMessage(w,o))}));b.set(C.some(n))})),dr((function(){b.get().each((function(t){return t.unbind()}))}))]),dc.config({channels:((r={})[_I]={onReceive:function(t,n){Ju(t.element,"iframe").each((function(t){t.dom.contentWindow.postMessage(n,v)}))}},r)})],x=jI({header:s,body:l,footer:f,extraClasses:p,extraBehaviours:y,extraStyles:g},t,m,o),w=(c=function(t){u.getSystem().isConnected()&&t(u)},{block:function(t){if(!T(t))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");c((function(n){Jo(n,ux,{message:t})}))},unblock:function(){c((function(t){Ko(t,ax)}))},close:function(){c((function(t){Ko(t,ex)}))},sendMessage:function(t){c((function(n){n.getSystem().broadcastOn([_I],t)}))}});return{dialog:u=x,instanceApi:w}},uR=function(t){var n,e,o,r,i=t.backstage,u=t.editor,a=Lv(u),c=(e=(n=t).backstage.shared,{open:function(t,o){var r=function(){FM.hide(c),o()},i=pp(QC({name:"close-alert",text:"OK",primary:!0,align:"end",disabled:!1,icon:C.none()},"cancel",n.backstage)),u=AI(),a=BI(r,e.providers),c=pu(RI({lazySink:function(){return e.getSink()},header:DI(u,a),body:MI(t,e.providers),footer:C.some(FI(II([],[i.asSpec()]))),onEscape:r,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[rr(ox,r)],eventOrder:{}}));FM.show(c);var s=i.get(c);bg.focus(s)}}),s=(r=(o=t).backstage.shared,{open:function(t,n){var e=function(t){FM.hide(s),n(t)},i=pp(QC({name:"yes",text:"Yes",primary:!0,align:"end",disabled:!1,icon:C.none()},"submit",o.backstage)),u=QC({name:"no",text:"No",primary:!1,align:"end",disabled:!1,icon:C.none()},"cancel",o.backstage),a=AI(),c=BI((function(){return e(!1)}),r.providers),s=pu(RI({lazySink:function(){return r.getSink()},header:DI(a,c),body:MI(t,r.providers),footer:C.some(FI(II([],[u,i.asSpec()]))),onEscape:function(){return e(!1)},extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[rr(ox,(function(){return e(!1)})),rr(ix,(function(){return e(!0)}))],eventOrder:{}}));FM.show(s);var l=i.get(s);bg.focus(l)}}),l=function(t,n){return oI.openUrl((function(t){var e=iR(t,{closeWindow:function(){FM.hide(e.dialog),n(e.instanceApi)}},u,i);return FM.show(e.dialog),e.instanceApi}),t)},f=function(t,n){return oI.open((function(t,e,o){var r=e,u=tR({dataValidator:o,initialData:r,internalDialog:t},{redial:oI.redial,closeWindow:function(){FM.hide(u.dialog),n(u.instanceApi)}},i);return FM.show(u.dialog),u.instanceApi.setData(r),u.instanceApi}),t)},m=function(t,n,e,o){return oI.open((function(t,r,c){var s,l,f,m=Dn(En("data",c,r)),p=(s=me(C.none()),{clear:function(){return s.set(C.none())},set:function(t){return s.set(C.some(t))},isSet:function(){return s.get().isSome()},on:function(t){return s.get().each(t)}}),h=i.shared.header.isPositionedAtTop(),v=function(){return p.on((function(t){np.reposition(t),qD.refresh(t)}))},b=nR({dataValidator:c,initialData:m,internalDialog:t},{redial:oI.redial,closeWindow:function(){p.on(np.hide),u.off("ResizeEditor",v),p.clear(),e(b.instanceApi)}},i,o),y=pu(np.sketch(d(d({lazySink:i.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{}},h?{}:{fireRepositionEventInstead:{}}),{inlineBehaviours:uc(g([mg("window-manager-inline-events",[rr(No(),(function(t,n){Ko(b.dialog,ox)}))])],(l=u,f=h,a&&f?[]:[qD.config({contextual:{lazyContext:function(){return C.some(zu(pe.fromDom(l.getContentAreaContainer())))},fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"]})]))),isExtraPart:function(t,n){return Ty(e=n,".tox-alert-dialog")||Ty(e,".tox-confirm-dialog");var e}})));return p.set(y),np.showWithin(y,n,hu(b.dialog),C.some(Gi())),a&&h||(qD.refresh(y),u.on("ResizeEditor",v)),b.instanceApi.setData(m),ag.focusIn(b.dialog),b.instanceApi}),t)};return{open:function(t,n,e){return void 0!==n&&"toolbar"===n.inline?m(t,i.shared.anchors.inlineDialog(),e,n.ariaAttrs):void 0!==n&&"cursor"===n.inline?m(t,i.shared.anchors.cursor(),e,n.ariaAttrs):f(t,e)},openUrl:function(t,n){return l(t,n)},alert:function(t,n){c.open(t,(function(){n()}))},close:function(t){t.close()},confirm:function(t,n){s.open(t,(function(t){n(t)}))}}};f.add("silver",(function(t){var n=_M(t),e=n.uiMothership,o=n.backstage,i=n.renderUI,u=n.getUi;Sy(t,o.shared);var a=uR({editor:t,backstage:o});return{renderUI:i,getWindowManagerImpl:r(a),getNotificationManagerImpl:function(){return xp(0,{backstage:o},e)},ui:u()}}))}()}).call(this,e("c8ba"))},9367:function(t,n,e){"use strict";e.d(n,"a",(function(){return r}));var o=e("b775");function r(t){return Object(o["a"])({url:"/declaration-form/teaching-organization/"+t,method:"get"})}},9695:function(t,n,e){"use strict";e.d(n,"a",(function(){return r})),e.d(n,"b",(function(){return i}));var o=e("b775");function r(t){return Object(o["a"])({url:"/declaration-form/total/"+t,method:"get"})}function i(t,n){return Object(o["a"])({url:"declaration-form/status-reviewer/"+t,method:"post",data:n})}},9944:function(t,n,e){"use strict";e.d(n,"a",(function(){return r}));var o=e("b775");function r(t){return Object(o["a"])({url:"/declaration-form/condition-guarantee/"+t,method:"get"})}},a7f8:function(t,n,e){"use strict";e("afc2")},afc2:function(t,n,e){},d5a5:function(t,n,e){"use strict";var o=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",[e("section",{attrs:{id:t.tinymceId}})])},r=[],i=(e("b680"),e("7c27"),e("22da"),{props:{id:{type:String,default:function(){return"vue-tinymce-"+ +new Date+(1e3*Math.random()).toFixed(0)}},value:{type:String,required:!0}},data:function(){return{tinymceId:this.id,tinymceFlag:1,hasChange:!1,hasInit:!1}},mounted:function(){var t=this;tinymce.init({selector:"#".concat(this.tinymceId),language:"zh_CN",menubar:"bar1 bar2",menu:{bar1:{title:"菜单栏",items:"copy paste"}},toolbar:"undo redo | styleselect | bold italic | forecolor backcolor | alignleft aligncenter alignright | fontsizeselect | fontselect ",font_formats:"宋体=宋体;仿宋=仿宋;黑体=黑体'",init_instance_callback:function(n){n.on("input",(function(n){t.$emit("input",n.target.innerHTML)})),n.on("change",(function(n){t.$emit("input",n.level.content)}))},setup:function(n){n.on("init",(function(e){n.setContent(t.value)}))},height:600})},created:function(){},watch:{value:function(t,n){var e=this;this.hasInit&&this.$nextTick((function(){return window.tinymce.get(e.tinymceId).setContent(t)}))}},methods:{setContent:function(t){window.tinymce.get(this.tinymceId).setContent(t)},getContent:function(){window.tinymce.get(this.tinymceId).getContent()},destroyTinymce:function(){var t=window.tinymce.get(this.tinymceId);this.status&&t.destroy(),t&&t.destroy(),console.log("aa")}}}),u=i,a=(e("a7f8"),e("2877")),c=Object(a["a"])(u,o,r,!1,null,null,null);n["a"]=c.exports},e5ac:function(t,n,e){"use strict";e.d(n,"a",(function(){return r}));var o=e("b775");function r(t){return Object(o["a"])({url:"/declaration-form/rules-and-regulations/"+t,method:"get"})}},fdc2:function(t,n,e){"use strict";e.d(n,"b",(function(){return r})),e.d(n,"a",(function(){return i}));var o=e("b775");function r(t,n){return Object(o["a"])({url:"/declaration-form/opinion-feedback/"+t,method:"post",data:n})}function i(t){return Object(o["a"])({url:"/declaration-form/opinion-feedback/"+t,method:"get"})}},fe41:function(t,n,e){"use strict";e.d(n,"a",(function(){return r}));var o=e("b775");function r(t){return Object(o["a"])({url:"declaration-form/course-material/"+t,method:"get"})}}}]);