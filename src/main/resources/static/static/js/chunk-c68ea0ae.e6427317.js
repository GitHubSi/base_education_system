(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c68ea0ae"],{"026b":function(e,t,r){"use strict";r("e03a")},"1c18":function(e,t,r){},6235:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("el-card",[r("div",{staticClass:"card-header",attrs:{slot:"header"},slot:"header"},[r("span",[e._v("用户管理")])]),r("el-row",{staticClass:"buttonAndSelect"},[r("el-input",{staticStyle:{width:"100px","font-size":"20px"},attrs:{placeholder:"姓名"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleFilter(t)}},model:{value:e.listQuery.queryUsername,callback:function(t){e.$set(e.listQuery,"queryUsername",t)},expression:"listQuery.queryUsername"}}),r("el-select",{staticStyle:{"font-size":"20px"},attrs:{placeholder:"所属学院",clearable:""},model:{value:e.listQuery.queryCollege,callback:function(t){e.$set(e.listQuery,"queryCollege",t)},expression:"listQuery.queryCollege"}},e._l(e.collegeList,(function(e,t){return r("el-option",{key:t,staticStyle:{"font-size":"20px"},attrs:{label:e,value:e}})})),1),r("el-select",{staticStyle:{"font-size":"20px"},attrs:{placeholder:"用户类别",clearable:""},model:{value:e.listQuery.queryRole,callback:function(t){e.$set(e.listQuery,"queryRole",t)},expression:"listQuery.queryRole"}},e._l(e.roleList,(function(e,t){return r("el-option",{key:t,staticStyle:{"font-size":"20px"},attrs:{label:e,value:e}})})),1),r("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleFilter}},[e._v("搜索")]),r("el-button",{attrs:{type:"primary",icon:"el-icon-edit"},on:{click:function(t){return e.handleCreate()}}},[e._v("添加")])],1),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.currentPageData,"empty-text":"暂无数据"}},[r("el-table-column",{attrs:{prop:"userNumber",label:"学工号"}}),r("el-table-column",{attrs:{prop:"username",label:"用户名称"}}),r("el-table-column",{attrs:{prop:"password",label:"用户密码"}}),r("el-table-column",{attrs:{prop:"college",label:"所属学院"}}),r("el-table-column",{attrs:{prop:"role",label:"用户类别"}}),r("el-table-column",{attrs:{fixed:"right",label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-row",{attrs:{type:"flex",justify:"space-around"}},[r("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"small"},on:{click:function(r){return e.handleEdit(t.row)}}},[e._v("编辑")]),r("el-button",{attrs:{icon:"el-icon-delete",type:"danger",size:"small"},on:{click:function(r){return e.handleDelete(t.row,t.$index)}}},[e._v("删除")])],1)]}}])})],1),r("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],staticStyle:{"margin-top":"10px"},attrs:{total:e.total,page:e.listQuery.page,limit:e.listQuery.limit},on:{"update:page":function(t){return e.$set(e.listQuery,"page",t)},"update:limit":function(t){return e.$set(e.listQuery,"limit",t)},pagination:e.getUserList}}),r("section",{staticClass:"section"},[r("el-button",{on:{click:function(t){return e.prevPage()}}},[e._v(" 上一页 ")]),r("span",[e._v("第"+e._s(e.currentPage)+"页/共"+e._s(e.totalPage)+"页")]),r("el-button",{on:{click:function(t){return e.nextPage()}}},[e._v(" 下一页 ")])],1),r("el-dialog",{attrs:{title:"用户信息",visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("el-form",{attrs:{model:e.tempUser}},[r("el-form-item",{attrs:{label:"学工号"}},[r("el-input",{attrs:{disabled:"edit"==e.dialogType},model:{value:e.tempUser.userNumber,callback:function(t){e.$set(e.tempUser,"userNumber",t)},expression:"tempUser.userNumber"}})],1),r("el-form-item",{attrs:{label:"用户密码"}},[r("el-input",{model:{value:e.tempUser.password,callback:function(t){e.$set(e.tempUser,"password",t)},expression:"tempUser.password"}})],1),r("el-form-item",{attrs:{label:"用户名称"}},[r("el-input",{model:{value:e.tempUser.username,callback:function(t){e.$set(e.tempUser,"username",t)},expression:"tempUser.username"}})],1),r("el-form-item",{attrs:{label:"所属学院"}},[r("el-select",{model:{value:e.tempUser.college,callback:function(t){e.$set(e.tempUser,"college",t)},expression:"tempUser.college"}},e._l(e.collegeList,(function(e,t){return r("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1),r("el-form-item",{attrs:{label:"用户类别"}},[r("el-select",{model:{value:e.tempUser.role,callback:function(t){e.$set(e.tempUser,"role",t)},expression:"tempUser.role"}},e._l(e.roleList,(function(e,t){return r("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1),r("el-row",{attrs:{type:"flex",justify:"center"}},[r("el-button",{on:{click:function(t){return e.cancelEdit()}}},[e._v("取消")]),"create"==e.dialogType?r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.createData()}}},[e._v("添加")]):r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.updateData(e.tempUser.userNumber)}}},[e._v("保存")])],1)],1)],1)],1)],1)},a=[],i=(r("a434"),r("c740"),r("fb6a"),r("b775"));function l(e){return Object(i["a"])({url:"/users/list",method:"post",data:e})}function s(e){return Object(i["a"])({url:"/users/create",method:"post",data:e})}function o(e){return Object(i["a"])({url:"/users/delete/"+e,method:"delete"})}function u(e,t){return Object(i["a"])({url:"/users/update/"+t,method:"post",data:e})}function c(){return Object(i["a"])({url:"/college/list",method:"get"})}function p(e){return Object(i["a"])({url:"/role/list/"+e,method:"get"})}var g=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"pagination-container",class:{hidden:e.hidden}},[r("el-pagination",e._b({attrs:{background:e.background,"current-page":e.currentPage,"page-size":e.pageSize,layout:e.layout,"page-sizes":e.pageSizes,total:e.total},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}},"el-pagination",e.$attrs,!1))],1)},d=[];r("a9e3");Math.easeInOutQuad=function(e,t,r,n){return e/=n/2,e<1?r/2*e*e+t:(e--,-r/2*(e*(e-2)-1)+t)};var m=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function f(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e}function h(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function y(e,t,r){var n=h(),a=e-n,i=20,l=0;t="undefined"===typeof t?500:t;var s=function e(){l+=i;var s=Math.easeInOutQuad(l,n,a,t);f(s),l<t?m(e):r&&"function"===typeof r&&r()};s()}var b={name:"Pagination",props:{total:{required:!0,type:Number},page:{type:Number,default:1},limit:{type:Number,default:20},pageSizes:{type:Array,default:function(){return[10,20,30,50]}},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},computed:{currentPage:{get:function(){return this.page},set:function(e){this.$emit("update:page",e)}},pageSize:{get:function(){return this.limit},set:function(e){this.$emit("update:limit",e)}}},methods:{handleSizeChange:function(e){this.$emit("pagination",{page:this.currentPage,limit:e}),this.autoScroll&&y(0,800)},handleCurrentChange:function(e){this.$emit("pagination",{page:e,limit:this.pageSize}),this.autoScroll&&y(0,800)}}},v=b,P=(r("e498"),r("2877")),x=Object(P["a"])(v,g,d,!1,null,"6af373ef",null),C=x.exports,U=r("4360"),k={components:{Pagination:C},data:function(){return{userList:[],collegeList:[],roleList:[],total:0,listQuery:{page:1,limit:20,role:void 0,college:void 0,queryUsername:null,queryRole:null,queryCollege:null},currentRole:U["a"].getters.role,currentCollege:U["a"].getters.college,getRoleParams:"",tempUser:{userNumber:"",username:"",college:"",role:""},dialogVisible:!1,listLoading:!0,dialogType:"create",currentPage:1,totalPage:1,pageSize:10,currentPageData:[]}},created:function(){this.totalPage=Math.ceil(this.userList.length/this.pageSize),this.setCurrentPageData(),console.log(this.currentRole),console.log(this.currentCollege),this.getUserList(this.currentRole,this.currentCollege),this.getInnerList(this.currentRole,this.currentCollege)},methods:{getUserList:function(e,t){var r=this;this.listLoading=!0,this.listQuery.role=e,this.listQuery.college=t,console.log(this.listQuery),l(this.listQuery).then((function(e){r.userList=e.data,r.totalPage=Math.ceil(r.userList.length/r.pageSize),r.setCurrentPageData(),r.listLoading=!1,r.listQuery.queryUsername=null,r.listQuery.queryCollege=null,r.listQuery.queryRole=null})).catch((function(e){r.listLoading=!1,r.$message({message:"请求失败："+e,type:"error"}),console.log(e)}))},resetTemp:function(){this.tempUser={userNumber:"",username:"",college:"",role:""}},getInnerList:function(){var e=this;c().then((function(t){"院级管理员"===e.currentRole?e.collegeList.push(e.currentCollege):e.collegeList=t.data.items})).catch((function(t){e.$message({message:"学院列表获取失败："+t,type:"error"}),console.log(t)})),"系统管理员"===this.currentRole&&(this.getRoleParams="admin"),"校级管理员"===this.currentRole&&(this.getRoleParams="school"),"院级管理员"===this.currentRole&&(this.getRoleParams="college"),"基层教学组织负责人"===this.currentRole&&(this.getRoleParams="principal"),p(this.getRoleParams).then((function(t){e.roleList=t.data.items})).catch((function(t){e.$message({message:"角色列表获取失败："+t,type:"error"}),console.log(t)}))},handleFilter:function(){this.listQuery.page=1,this.getUserList(this.currentRole,this.currentCollege)},handleCreate:function(){this.resetTemp(),this.dialogType="create",this.dialogVisible=!0},handleEdit:function(e){this.tempUser=Object.assign({},e),this.dialogType="edit",this.dialogVisible=!0},handleDelete:function(e,t){var r=this;this.$confirm("此操作将永久删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){o(e.userNumber).then((function(){r.userList.splice(t,1),r.$message({message:"用户删除成功",type:"success"}),r.getUserList(r.currentRole,r.currentCollege)})).catch((function(e){r.$message({message:"用户删除失败："+e,type:"error"}),console.log(e)}))}))},cancelEdit:function(){this.resetTemp(),this.dialogVisible=!1},createData:function(){var e=this;s(this.tempUser).then((function(){e.userList.push(e.tempUser),e.dialogVisible=!1,e.$message({message:"添加用户成功",type:"success"}),e.getUserList(e.currentRole,e.currentCollege)})).catch((function(t){e.dialogVisible=!1,e.$message({message:"添加用户失败："+t,type:"error"}),console.log(t)}))},updateData:function(e){var t=this;u(this.tempUser,e).then((function(){var e=t.userList.findIndex((function(e){return e.userNumber===t.tempUser.userNumber}));t.userList.splice(e,1,t.tempUser),t.dialogVisible=!1,t.$message({message:"修改成功",type:"success"}),t.getUserList(t.currentRole,t.currentCollege)})).catch((function(e){t.dialogVisible=!1,t.$message({message:"修改失败："+e,type:"error"}),console.log(e)}))},setCurrentPageData:function(){var e=(this.currentPage-1)*this.pageSize,t=this.currentPage*this.pageSize;this.currentPageData=this.userList.slice(e,t)},prevPage:function(){1!=this.currentPage&&(this.currentPage--,this.setCurrentPageData())},nextPage:function(){this.currentPage!=this.totalPage&&(this.currentPage++,this.setCurrentPageData())}}},L=k,N=(r("026b"),Object(P["a"])(L,n,a,!1,null,null,null));t["default"]=N.exports},a434:function(e,t,r){"use strict";var n=r("23e7"),a=r("23cb"),i=r("a691"),l=r("50c4"),s=r("7b0b"),o=r("65f0"),u=r("8418"),c=r("1dde"),p=r("ae40"),g=c("splice"),d=p("splice",{ACCESSORS:!0,0:0,1:2}),m=Math.max,f=Math.min,h=9007199254740991,y="Maximum allowed length exceeded";n({target:"Array",proto:!0,forced:!g||!d},{splice:function(e,t){var r,n,c,p,g,d,b=s(this),v=l(b.length),P=a(e,v),x=arguments.length;if(0===x?r=n=0:1===x?(r=0,n=v-P):(r=x-2,n=f(m(i(t),0),v-P)),v+r-n>h)throw TypeError(y);for(c=o(b,n),p=0;p<n;p++)g=P+p,g in b&&u(c,p,b[g]);if(c.length=n,r<n){for(p=P;p<v-n;p++)g=p+n,d=p+r,g in b?b[d]=b[g]:delete b[d];for(p=v;p>v-n+r;p--)delete b[p-1]}else if(r>n)for(p=v-n;p>P;p--)g=p+n-1,d=p+r-1,g in b?b[d]=b[g]:delete b[d];for(p=0;p<r;p++)b[p+P]=arguments[p+2];return b.length=v-n+r,c}})},a9e3:function(e,t,r){"use strict";var n=r("83ab"),a=r("da84"),i=r("94ca"),l=r("6eeb"),s=r("5135"),o=r("c6b6"),u=r("7156"),c=r("c04e"),p=r("d039"),g=r("7c73"),d=r("241c").f,m=r("06cf").f,f=r("9bf2").f,h=r("58a8").trim,y="Number",b=a[y],v=b.prototype,P=o(g(v))==y,x=function(e){var t,r,n,a,i,l,s,o,u=c(e,!1);if("string"==typeof u&&u.length>2)if(u=h(u),t=u.charCodeAt(0),43===t||45===t){if(r=u.charCodeAt(2),88===r||120===r)return NaN}else if(48===t){switch(u.charCodeAt(1)){case 66:case 98:n=2,a=49;break;case 79:case 111:n=8,a=55;break;default:return+u}for(i=u.slice(2),l=i.length,s=0;s<l;s++)if(o=i.charCodeAt(s),o<48||o>a)return NaN;return parseInt(i,n)}return+u};if(i(y,!b(" 0o1")||!b("0b1")||b("+0x1"))){for(var C,U=function(e){var t=arguments.length<1?0:e,r=this;return r instanceof U&&(P?p((function(){v.valueOf.call(r)})):o(r)!=y)?u(new b(x(t)),r,U):x(t)},k=n?d(b):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),L=0;k.length>L;L++)s(b,C=k[L])&&!s(U,C)&&f(U,C,m(b,C));U.prototype=v,v.constructor=U,l(a,y,U)}},c740:function(e,t,r){"use strict";var n=r("23e7"),a=r("b727").findIndex,i=r("44d2"),l=r("ae40"),s="findIndex",o=!0,u=l(s);s in[]&&Array(1)[s]((function(){o=!1})),n({target:"Array",proto:!0,forced:o||!u},{findIndex:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),i(s)},e03a:function(e,t,r){},e498:function(e,t,r){"use strict";r("1c18")}}]);